/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

//>>built
require({cache:{"dojox/mobile/ToolBarButton":function(){define("dojox/mobile/ToolBarButton",["dojo/_base/declare","dojo/_base/window","dojo/dom-class","dojo/dom-construct","dojo/dom-style","./common","./_ItemBase"],function(_1,_2,_3,_4,_5,_6,_7){return _1("dojox.mobile.ToolBarButton",_7,{selected:false,btnClass:"",_defaultColor:"mblColorDefault",_selColor:"mblColorDefaultSel",buildRendering:function(){this.domNode=this.containerNode=this.srcNodeRef||_2.doc.createElement("div");this.inheritParams();_3.add(this.domNode,"mblToolBarButton mblArrowButtonText");var _8;if(this.selected){_8=this._selColor;}else{if(this.domNode.className.indexOf("mblColor")==-1){_8=this._defaultColor;}}_3.add(this.domNode,_8);if(!this.label){this.label=this.domNode.innerHTML;}if(this.icon&&this.icon!="none"){this.iconNode=_4.create("div",{className:"mblToolBarButtonIcon"},this.domNode);_6.createIcon(this.icon,this.iconPos,null,this.alt,this.iconNode);if(this.iconPos){_3.add(this.iconNode.firstChild,"mblToolBarButtonSpriteIcon");}}else{if(_6.createDomButton(this.domNode)){_3.add(this.domNode,"mblToolBarButtonDomButton");}else{_3.add(this.domNode,"mblToolBarButtonText");}}this.connect(this.domNode,"onclick","onClick");},select:function(){_3.toggle(this.domNode,this._selColor,!arguments[0]);this.selected=!arguments[0];},deselect:function(){this.select(true);},onClick:function(e){this.setTransitionPos(e);this.defaultClickAction();},_setBtnClassAttr:function(_9){var _a=this.domNode;if(_a.className.match(/(mblDomButton\w+)/)){_3.remove(_a,RegExp.$1);}_3.add(_a,_9);if(_6.createDomButton(this.domNode)){_3.add(this.domNode,"mblToolBarButtonDomButton");}},_setLabelAttr:function(_b){this.label=_b;this.domNode.innerHTML=this._cv?this._cv(_b):_b;}});});},"versa/api/References":function(){define("versa/api/References",["dojo/_base/declare","versa/api/_Collection","versa/api/Reference"],function(_c){var o=_c("versa.api.References",[versa.api._Collection],{library:null,zone:null,_isUpdateable:function(_d){return false;},_softDelete:function(_e){var _f=dojo.replace(versa.api.References.SDEL_TRGT,[this.zone.subdomain,this.library.getId(),_e.getId()]);var _10={};var _11=versa.api.XhrHelper.doPutAction({target:_f,putData:_10});return _11;},constructor:function(_12){this.zone=_12.zone;this.library=_12.library;this.target=dojo.replace(versa.api.References.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.Reference.schema;this.cache=false;this._initialize();this.store.isUpdateable=dojo.hitch(this,this._isUpdateable);},destroy:function(_13){var _14=_13.item;if((_14.isInstanceOf(versa.api.Reference))&&(_13.soft)){_14=this._softDelete(_14);this.store.onDelete(_14);}else{this.inherited("destroy",arguments);}},export_query:function(_15){var _16=dojo.objectToQuery(_15.query);var _17=dojo.replace("sort({0}{1})",[(_15.sort.descending?"-":"+"),encodeURIComponent(_15.sort.attribute)]);var _18="json";switch(_15.type){case versa.api.References.ExportTypes.CSV:_18="csv";break;case versa.api.References.ExportTypes.PDF:_18="pdf";break;case versa.api.References.ExportTypes.XML:_18="xml";break;}var url=dojo.replace(versa.api.References.EXPORT_TRGT,[_15.zone.subdomain,_15.library.id,_16,_17,_18]);if(_15.type==versa.api.Documents.ExportTypes.PDF){versa.api.Utilities.viewUrl({windowBox:_15.windowBox,url:url,window_name:"versa_save"});}else{versa.api.Utilities.saveUrl({url:url,window_name:"versa_save"});}},print_query:function(_19){var _1a=dojo.objectToQuery(_19.query);var _1b=dojo.replace("sort({0}{1})",[(_19.sort.descending?"-":"+"),encodeURIComponent(_19.sort.attribute)]);var url=dojo.replace(versa.api.References.PRINT_TRGT,[_19.zone.subdomain,_19.library.id,_1a,_1b,"html"]);versa.api.Utilities.viewUrl({windowBox:_19.windowBox,url:url,window_name:"versa_printer"});}});o.ExportTypes={"NONE":0,"CSV":1,"PDF":2,"XML":3};o.TRGT="/zones/{0}/libraries/{1}/references";o.SDEL_TRGT="/zones/{0}/libraries/{1}/references/{2}/soft_delete.json";o.PRINT_TRGT="/zones/{0}/libraries/{1}/references?{2}&{3}";o.EXPORT_TRGT="/zones/{0}/libraries/{1}/references.{4}?{2}&{3}";return o;});},"dojox/mobile/transition":function(){define("dojox/mobile/transition",["dojo/_base/Deferred","dojo/_base/config"],function(_1c,_1d){if(_1d["mblCSS3Transition"]){var _1e=new _1c();require([_1d["mblCSS3Transition"]],function(_1f){_1e.resolve(_1f);});return _1e;}return null;});},"dijit/_TemplatedMixin":function(){define("dijit/_TemplatedMixin",["dojo/_base/lang","dojo/touch","./_WidgetBase","dojo/string","dojo/cache","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/sniff","dojo/_base/unload","dojo/_base/window"],function(_20,_21,_22,_23,_24,_25,_26,_27,has,_28,win){var _29=_26("dijit._TemplatedMixin",null,{templateString:null,templatePath:null,_skipNodeCache:false,_earlyTemplatedStartup:false,constructor:function(){this._attachPoints=[];this._attachEvents=[];},_stringRepl:function(_2a){var _2b=this.declaredClass,_2c=this;return _23.substitute(_2a,this,function(_2d,key){if(key.charAt(0)=="!"){_2d=_20.getObject(key.substr(1),false,_2c);}if(typeof _2d=="undefined"){throw new Error(_2b+" template:"+key);}if(_2d==null){return "";}return key.charAt(0)=="!"?_2d:_2d.toString().replace(/"/g,"&quot;");},this);},buildRendering:function(){if(!this.templateString){this.templateString=_24(this.templatePath,{sanitize:true});}var _2e=_29.getCachedTemplate(this.templateString,this._skipNodeCache);var _2f;if(_20.isString(_2e)){_2f=_27.toDom(this._stringRepl(_2e));if(_2f.nodeType!=1){throw new Error("Invalid template: "+_2e);}}else{_2f=_2e.cloneNode(true);}this.domNode=_2f;this.inherited(arguments);this._attachTemplateNodes(_2f,function(n,p){return n.getAttribute(p);});this._beforeFillContent();this._fillContent(this.srcNodeRef);},_beforeFillContent:function(){},_fillContent:function(_30){var _31=this.containerNode;if(_30&&_31){while(_30.hasChildNodes()){_31.appendChild(_30.firstChild);}}},_attachTemplateNodes:function(_32,_33){var _34=_20.isArray(_32)?_32:(_32.all||_32.getElementsByTagName("*"));var x=_20.isArray(_32)?0:-1;for(;x<_34.length;x++){var _35=(x==-1)?_32:_34[x];if(this.widgetsInTemplate&&(_33(_35,"dojoType")||_33(_35,"data-dojo-type"))){continue;}var _36=_33(_35,"dojoAttachPoint")||_33(_35,"data-dojo-attach-point");if(_36){var _37,_38=_36.split(/\s*,\s*/);while((_37=_38.shift())){if(_20.isArray(this[_37])){this[_37].push(_35);}else{this[_37]=_35;}this._attachPoints.push(_37);}}var _39=_33(_35,"dojoAttachEvent")||_33(_35,"data-dojo-attach-event");if(_39){var _3a,_3b=_39.split(/\s*,\s*/);var _3c=_20.trim;while((_3a=_3b.shift())){if(_3a){var _3d=null;if(_3a.indexOf(":")!=-1){var _3e=_3a.split(":");_3a=_3c(_3e[0]);_3d=_3c(_3e[1]);}else{_3a=_3c(_3a);}if(!_3d){_3d=_3a;}this._attachEvents.push(this.connect(_35,_21[_3a]||_3a,_3d));}}}}},destroyRendering:function(){_25.forEach(this._attachPoints,function(_3f){delete this[_3f];},this);this._attachPoints=[];_25.forEach(this._attachEvents,this.disconnect,this);this._attachEvents=[];this.inherited(arguments);}});_29._templateCache={};_29.getCachedTemplate=function(_40,_41){var _42=_29._templateCache;var key=_40;var _43=_42[key];if(_43){try{if(!_43.ownerDocument||_43.ownerDocument==win.doc){return _43;}}catch(e){}_27.destroy(_43);}_40=_23.trim(_40);if(_41||_40.match(/\$\{([^\}]+)\}/g)){return (_42[key]=_40);}else{var _44=_27.toDom(_40);if(_44.nodeType!=1){throw new Error("Invalid template: "+_40);}return (_42[key]=_44);}};if(has("ie")){_28.addOnWindowUnload(function(){var _45=_29._templateCache;for(var key in _45){var _46=_45[key];if(typeof _46=="object"){_27.destroy(_46);}delete _45[key];}});}_20.extend(_22,{dojoAttachEvent:"",dojoAttachPoint:""});return _29;});},"versa/api/Preferences":function(){define("versa/api/Preferences",["dojo/_base/declare","versa/api/_Collection","versa/api/Preference","dojo/data/ItemFileReadStore"],function(_47){var o=_47("versa.api.Preferences",[versa.api._Collection],{constructor:function(_48){this.zone=_48.zone;this.library=_48.library;this.target=dojo.replace(versa.api.Preferences.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.Preference.schema;this.cache=true;this._dateEntryFormats=new dojo.data.ItemFileReadStore({data:{"identifier":"id","label":"name","items":[{id:versa.api.Preference.dateEntryFormats._date,name:"Date only"},{id:versa.api.Preference.dateEntryFormats._time,name:"Time only"},{id:versa.api.Preference.dateEntryFormats._datetime,name:"Date and Time"}]},clearOnClose:true});this._initialize();},getDateEntryFormat:function(){var _49=this.store.fetch({query:{name:"Date entry format"}}).results[0];return (_49)?parseInt(this.getValue(_49,"value")):1;}});o.TRGT="/zones{0}/libraries/${1}/preferences";return o;});},"versa/api/Libraries":function(){define("versa/api/Libraries",["dojo/_base/declare","versa/api/_Collection","versa/api/Library"],function(_4a){var o=_4a("versa.api.Libraries",[versa.api._Collection],{zone:null,constructor:function(_4b){this.zone=_4b.zone;this.target=dojo.replace(versa.api.Libraries.TRGT,this.zone);this.schema=versa.api.Library.schema;this.cache=true;this._initialize();}});o.TRGT="/zones/{subdomain}/libraries";return o;});},"versa/widget/mobile/TextBox":function(){define("versa/widget/mobile/TextBox",["dojo/_base/declare","dojox/mobile/TextBox"],function(_4c){return _4c("versa.widget.mobile.TextBox",[dojox.mobile.TextBox],{buildRendering:function(){this.inherited("buildRendering",arguments);if(this.type){this.domNode.type=this.type;}}});});},"versa/api/Formatter":function(){define("versa/api/Formatter",["dojo/_base/declare"],function(_4d){var o=_4d("versa.api.Formatter",[],{});o.formatDateTime=function(_4e){var _4f=_4e;if(String.isEmpty(_4e)){return "";}if(typeof _4e=="string"){_4f=dojo.date.stamp.fromISOString(_4e);}return dojo.date.locale.format(_4f,{selector:"date",formatLength:"medium"});};return o;});},"versa/api/Documents":function(){define("versa/api/Documents",["dojo/_base/declare","versa/api/_Collection","versa/api/Document","versa/api/Utilities"],function(_50){var o=_50("versa.api.Documents",[versa.api._Collection],{library:null,_isUpdateable:function(_51){return false;},_softDelete:function(_52){var url=dojo.replace(versa.api.Documents.SDEL_TRGT,[this.zone.subdomain,this.library.getId(),_52.getId()]);var _53={};var _54=versa.api.XhrHelper.doPutAction({target:url,putData:_53});return _54;},constructor:function(_55){this.zone=_55.zone;this.library=_55.library;this.target=dojo.replace(versa.api.Documents.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.Document.schema;this.cache=false;this.syncMode=false;this._initialize();this.store.isUpdateable=dojo.hitch(this,this._isUpdateable);},destroy:function(_56){var _57=_56.item;if((_57.isInstanceOf(versa.api.Document))&&(_56.soft)){_57=this._softDelete(_57);this.store.onDelete(_57);}else{this.inherited("destroy",arguments);}},empty_recycling:function(_58){var _59=_58.zone;var _5a=_58.library;var url=dojo.replace(versa.api.Documents.EMPTY,[_59.subdomain,_5a.id]);var _5b=versa.api.XhrHelper.doPostAction({target:url,postData:{}});return true;},export_query:function(_5c){var _5d=dojo.objectToQuery(_5c.query);var _5e=dojo.replace("sort({0}{1})",[(_5c.sort.descending?"-":"+"),encodeURIComponent(_5c.sort.attribute)]);var _5f="json";switch(_5c.type){case versa.api.Documents.ExportTypes.CSV:_5f="csv";break;case versa.api.Documents.ExportTypes.PDF:_5f="pdf";break;case versa.api.Documents.ExportTypes.XML:_5f="xml";break;}var url=dojo.replace(versa.api.Documents.EXPORT_TRGT,[_5c.zone.subdomain,_5c.library.id,_5d,_5e,_5f]);if(_5c.type==versa.api.Documents.ExportTypes.PDF){versa.api.Utilities.viewUrl({windowBox:_5c.windowBox,url:url,window_name:"versa_save"});}else{versa.api.Utilities.saveUrl({url:url,window_name:"versa_save"});}},isValid:function(_60){this.validate(_60);return this.getState(versa.api.Document.states.INVALID);},print_query:function(_61){var _62=dojo.objectToQuery(_61.query);var _63=dojo.replace("sort({0}{1})",[(_61.sort.descending?"-":"+"),encodeURIComponent(_61.sort.attribute)]);var url=dojo.replace(versa.api.Documents.EXPORT_TRGT,[_61.zone.subdomain,_61.library.id,_62,_63,"html"]);versa.api.Utilities.viewUrl({windowBox:_61.windowBox,url:url,window_name:"versa_printer"});}});o.States={pending:0,checked_in:1,checked_out:2,busy:16384,deleted:32768};o.ExportTypes={"NONE":0,"CSV":1,"PDF":2,"XML":3};o.TRGT="/zones/{0}/libraries/{1}/documents";o.PRINT_TRGT="/zones/{0}/libraries/{1}/documents?{2}&{3}";o.EXPORT_TRGT="/zones/{0}/libraries/{1}/documents.{4}?{2}&{3}";o.EMPTY="/zones/{0}/libraries/{1}/documents/empty";o.SDEL_TRGT="/zones/{0}/libraries/{1}/documents/{2}/soft_delete.json";o.isCheckedOut=function(_64){var _65;if(_64.document){_65=_64.document.state;}else{if(_64.state){_65=_64.state;}}return ((_65&versa.api.Documents.States.checked_out)>0);};o.isBusy=function(_66){return ((_66.state&versa.api.Documents.States.busy)>0);};return o;});},"versa/api/Share":function(){define("versa/api/Share",["dojo/_base/declare","versa/api/_Object","versa/api/SharedItems"],function(_67){var o=_67("versa.api.Share",[versa.api._Object],{constructor:function(_68){dojo.safeMixin(this,((!_68)?{}:_68));},authorize:function(_69){var url=dojo.replace(versa.api.Share.AUTH_URL,[_69.id,this.fingerprint]);var _6a={password:this.password};var _6b=versa.api.XhrHelper.doPostAction({target:url,postData:_6a});return true;},getSharedItems:function(_6c){return new versa.api.SharedItems({zone:_6c.zone,share:this});}});o.AUTH_URL="/zones/{0}/shares/{1}/authorize.json";o.schema={type:"object",properties:{"id":{type:"integer"}},prototype:new o()};return o;});},"dojox/mobile/TabBarButton":function(){define("dojox/mobile/TabBarButton",["dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/dom-class","dojo/dom-construct","dijit/registry","./common","./_ItemBase"],function(_6d,_6e,win,_6f,_70,_71,_72,_73){return _6d("dojox.mobile.TabBarButton",_73,{icon1:"",icon2:"",iconPos1:"",iconPos2:"",selected:false,transition:"none",tag:"LI",selectOne:true,inheritParams:function(){if(this.icon&&!this.icon1){this.icon1=this.icon;}var _74=this.getParent();if(_74){if(!this.transition){this.transition=_74.transition;}if(this.icon1&&_74.iconBase&&_74.iconBase.charAt(_74.iconBase.length-1)==="/"){this.icon1=_74.iconBase+this.icon1;}if(!this.icon1){this.icon1=_74.iconBase;}if(!this.iconPos1){this.iconPos1=_74.iconPos;}if(this.icon2&&_74.iconBase&&_74.iconBase.charAt(_74.iconBase.length-1)==="/"){this.icon2=_74.iconBase+this.icon2;}if(!this.icon2){this.icon2=_74.iconBase||this.icon1;}if(!this.iconPos2){this.iconPos2=_74.iconPos||this.iconPos1;}}},buildRendering:function(){var a=this.anchorNode=_70.create("A",{className:"mblTabBarButtonAnchor"});this.connect(a,"onclick","onClick");this.box=_70.create("DIV",{className:"mblTabBarButtonTextBox"},a);var box=this.box;var _75="";var r=this.srcNodeRef;if(r){for(var i=0,len=r.childNodes.length;i<len;i++){var n=r.firstChild;if(n.nodeType===3){_75+=_6e.trim(n.nodeValue);}box.appendChild(n);}}if(!this.label){this.label=_75;}this.domNode=this.srcNodeRef||_70.create(this.tag);this.containerNode=this.domNode;this.domNode.appendChild(a);if(this.domNode.className.indexOf("mblDomButton")!=-1){var _76=_70.create("DIV",null,a);_72.createDomButton(this.domNode,null,_76);_6f.add(this.domNode,"mblTabButtonDomButton");_6f.add(_76,"mblTabButtonDomButtonClass");}if((this.icon1||this.icon).indexOf("mblDomButton")!=-1){_6f.add(this.domNode,"mblTabButtonDomButton");}},startup:function(){if(this._started){return;}this.inheritParams();var _77=this.getParent();var _78=_77?_77._clsName:"mblTabBarButton";_6f.add(this.domNode,_78+(this.selected?" mblTabButtonSelected":""));if(_77&&_77.barType=="segmentedControl"){_6f.remove(this.domNode,"mblTabBarButton");_6f.add(this.domNode,_77._clsName);this.box.className="";}this.set({icon1:this.icon1,icon2:this.icon2});this.inherited(arguments);},select:function(){if(arguments[0]){this.selected=false;_6f.remove(this.domNode,"mblTabButtonSelected");}else{this.selected=true;_6f.add(this.domNode,"mblTabButtonSelected");for(var i=0,c=this.domNode.parentNode.childNodes;i<c.length;i++){if(c[i].nodeType!=1){continue;}var w=_71.byNode(c[i]);if(w&&w!=this){w.deselect();}}}if(this.iconNode1){this.iconNode1.style.visibility=this.selected?"hidden":"";}if(this.iconNode2){this.iconNode2.style.visibility=this.selected?"":"hidden";}},deselect:function(){this.select(true);},onClick:function(e){this.defaultClickAction();},_setIcon:function(_79,pos,num,sel){var i="icon"+num,n="iconNode"+num,p="iconPos"+num;if(_79){this[i]=_79;}if(pos){if(this[p]===pos){return;}this[p]=pos;}if(_79&&_79!=="none"){if(!this.iconDivNode){this.iconDivNode=_70.create("DIV",{className:"mblTabBarButtonDiv"},this.anchorNode,"first");}if(!this[n]){this[n]=_70.create("div",{className:"mblTabBarButtonIcon"},this.iconDivNode);}else{_70.empty(this[n]);}_72.createIcon(_79,this[p],null,this.alt,this[n]);if(this[p]){_6f.add(this[n].firstChild,"mblTabBarButtonSpriteIcon");}_6f.remove(this.iconDivNode,"mblTabBarButtonNoIcon");this[n].style.visibility=sel?"hidden":"";}else{if(this.iconDivNode){_6f.add(this.iconDivNode,"mblTabBarButtonNoIcon");}}},_setIcon1Attr:function(_7a){this._setIcon(_7a,null,1,this.selected);},_setIcon2Attr:function(_7b){this._setIcon(_7b,null,2,!this.selected);},_setIconPos1Attr:function(pos){this._setIcon(null,pos,1,this.selected);},_setIconPos2Attr:function(pos){this._setIcon(null,pos,2,!this.selected);},_setLabelAttr:function(_7c){this.label=_7c;this.box.innerHTML=this._cv?this._cv(_7c):_7c;}});});},"dojox/mobile/_ScrollableMixin":function(){define("dojox/mobile/_ScrollableMixin",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/dom","dojo/dom-class","dijit/registry","./scrollable"],function(_7d,_7e,_7f,win,dom,_80,_81,_82){var cls=_7e("dojox.mobile._ScrollableMixin",null,{fixedHeader:"",fixedFooter:"",scrollableParams:null,allowNestedScrolls:true,constructor:function(){this.scrollableParams={};},destroy:function(){this.cleanup();this.inherited(arguments);},startup:function(){if(this._started){return;}var _83;var _84=this.scrollableParams;if(this.fixedHeader){_83=dom.byId(this.fixedHeader);if(_83.parentNode==this.domNode){this.isLocalHeader=true;}_84.fixedHeaderHeight=_83.offsetHeight;}if(this.fixedFooter){_83=dom.byId(this.fixedFooter);if(_83.parentNode==this.domNode){this.isLocalFooter=true;_83.style.bottom="0px";}_84.fixedFooterHeight=_83.offsetHeight;}this.init(_84);if(this.allowNestedScrolls){for(var p=this.getParent();p;p=p.getParent()){if(p&&p.scrollableParams){this.isNested=true;this.dirLock=true;p.dirLock=true;break;}}}this.inherited(arguments);},findAppBars:function(){var i,len,c;for(i=0,len=win.body().childNodes.length;i<len;i++){c=win.body().childNodes[i];this.checkFixedBar(c,false);}if(this.domNode.parentNode){for(i=0,len=this.domNode.parentNode.childNodes.length;i<len;i++){c=this.domNode.parentNode.childNodes[i];this.checkFixedBar(c,false);}}this.fixedFooterHeight=this.fixedFooter?this.fixedFooter.offsetHeight:0;},checkFixedBar:function(_85,_86){if(_85.nodeType===1){var _87=_85.getAttribute("fixed")||(_81.byNode(_85)&&_81.byNode(_85).fixed);if(_87==="top"){_80.add(_85,"mblFixedHeaderBar");if(_86){_85.style.top="0px";this.fixedHeader=_85;}return _87;}else{if(_87==="bottom"){_80.add(_85,"mblFixedBottomBar");this.fixedFooter=_85;return _87;}}}return null;}});_7f.extend(cls,new _82(_7d,dojox));return cls;});},"dijit/focus":function(){define("dijit/focus",["dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/Evented","dojo/_base/lang","dojo/on","dojo/ready","dojo/_base/sniff","dojo/Stateful","dojo/_base/unload","dojo/_base/window","dojo/window","./a11y","./registry","."],function(_88,_89,dom,_8a,_8b,_8c,_8d,on,_8e,has,_8f,_90,win,_91,_92,_93,_94){var _95=_89([_8f,_8c],{curNode:null,activeStack:[],constructor:function(){var _96=_8d.hitch(this,function(_97){if(dom.isDescendant(this.curNode,_97)){this.set("curNode",null);}if(dom.isDescendant(this.prevNode,_97)){this.set("prevNode",null);}});_88.before(_8b,"empty",_96);_88.before(_8b,"destroy",_96);},registerIframe:function(_98){return this.registerWin(_98.contentWindow,_98);},registerWin:function(_99,_9a){var _9b=this;var _9c=function(evt){_9b._justMouseDowned=true;setTimeout(function(){_9b._justMouseDowned=false;},0);if(has("ie")&&evt&&evt.srcElement&&evt.srcElement.parentNode==null){return;}_9b._onTouchNode(_9a||evt.target||evt.srcElement,"mouse");};var doc=has("ie")?_99.document.documentElement:_99.document;if(doc){if(has("ie")){_99.document.body.attachEvent("onmousedown",_9c);var _9d=function(evt){var tag=evt.srcElement.tagName.toLowerCase();if(tag=="#document"||tag=="body"){return;}if(_92.isTabNavigable(evt.srcElement)){_9b._onFocusNode(_9a||evt.srcElement);}else{_9b._onTouchNode(_9a||evt.srcElement);}};doc.attachEvent("onactivate",_9d);var _9e=function(evt){_9b._onBlurNode(_9a||evt.srcElement);};doc.attachEvent("ondeactivate",_9e);return {remove:function(){_99.document.detachEvent("onmousedown",_9c);doc.detachEvent("onactivate",_9d);doc.detachEvent("ondeactivate",_9e);doc=null;}};}else{doc.body.addEventListener("mousedown",_9c,true);doc.body.addEventListener("touchstart",_9c,true);var _9f=function(evt){_9b._onFocusNode(_9a||evt.target);};doc.addEventListener("focus",_9f,true);var _a0=function(evt){_9b._onBlurNode(_9a||evt.target);};doc.addEventListener("blur",_a0,true);return {remove:function(){doc.body.removeEventListener("mousedown",_9c,true);doc.body.removeEventListener("touchstart",_9c,true);doc.removeEventListener("focus",_9f,true);doc.removeEventListener("blur",_a0,true);doc=null;}};}}},_onBlurNode:function(){this.set("prevNode",this.curNode);this.set("curNode",null);if(this._justMouseDowned){return;}if(this._clearActiveWidgetsTimer){clearTimeout(this._clearActiveWidgetsTimer);}this._clearActiveWidgetsTimer=setTimeout(_8d.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([]);this.prevNode=null;}),100);},_onTouchNode:function(_a1,by){if(this._clearActiveWidgetsTimer){clearTimeout(this._clearActiveWidgetsTimer);delete this._clearActiveWidgetsTimer;}var _a2=[];try{while(_a1){var _a3=_8a.get(_a1,"dijitPopupParent");if(_a3){_a1=_93.byId(_a3).domNode;}else{if(_a1.tagName&&_a1.tagName.toLowerCase()=="body"){if(_a1===win.body()){break;}_a1=_91.get(_a1.ownerDocument).frameElement;}else{var id=_a1.getAttribute&&_a1.getAttribute("widgetId"),_a4=id&&_93.byId(id);if(_a4&&!(by=="mouse"&&_a4.get("disabled"))){_a2.unshift(id);}_a1=_a1.parentNode;}}}}catch(e){}this._setStack(_a2,by);},_onFocusNode:function(_a5){if(!_a5){return;}if(_a5.nodeType==9){return;}this._onTouchNode(_a5);if(_a5==this.curNode){return;}this.set("curNode",_a5);},_setStack:function(_a6,by){var _a7=this.activeStack;this.set("activeStack",_a6);for(var _a8=0;_a8<Math.min(_a7.length,_a6.length);_a8++){if(_a7[_a8]!=_a6[_a8]){break;}}var _a9;for(var i=_a7.length-1;i>=_a8;i--){_a9=_93.byId(_a7[i]);if(_a9){_a9._hasBeenBlurred=true;_a9.set("focused",false);if(_a9._focusManager==this){_a9._onBlur(by);}this.emit("widget-blur",_a9,by);}}for(i=_a8;i<_a6.length;i++){_a9=_93.byId(_a6[i]);if(_a9){_a9.set("focused",true);if(_a9._focusManager==this){_a9._onFocus(by);}this.emit("widget-focus",_a9,by);}}},focus:function(_aa){if(_aa){try{_aa.focus();}catch(e){}}}});var _ab=new _95();_8e(function(){var _ac=_ab.registerWin(win.doc.parentWindow||win.doc.defaultView);if(has("ie")){_90.addOnWindowUnload(function(){_ac.remove();_ac=null;});}});_94.focus=function(_ad){_ab.focus(_ad);};for(var _ae in _ab){if(!/^_/.test(_ae)){_94.focus[_ae]=typeof _ab[_ae]=="function"?_8d.hitch(_ab,_ae):_ab[_ae];}}_ab.watch(function(_af,_b0,_b1){_94.focus[_af]=_b1;});return _ab;});},"dojo/i18n":function(){define("dojo/i18n",["./_base/kernel","require","./has","./_base/array","./_base/config","./_base/lang","./_base/xhr"],function(_b2,_b3,has,_b4,_b5,_b6,xhr){var _b7=_b2.i18n={},_b8=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,_b9=function(_ba,_bb,_bc,_bd){for(var _be=[_bc+_bd],_bf=_bb.split("-"),_c0="",i=0;i<_bf.length;i++){_c0+=(_c0?"-":"")+_bf[i];if(!_ba||_ba[_c0]){_be.push(_bc+_c0+"/"+_bd);}}return _be;},_c1={},_c2=_b2.getL10nName=function(_c3,_c4,_c5){_c5=_c5?_c5.toLowerCase():_b2.locale;_c3="dojo/i18n!"+_c3.replace(/\./g,"/");_c4=_c4.replace(/\./g,"/");return (/root/i.test(_c5))?(_c3+"/nls/"+_c4):(_c3+"/nls/"+_c5+"/"+_c4);},_c6=function(_c7,_c8,_c9,_ca,_cb,_cc){_c7([_c8],function(_cd){var _ce=_c1[_c8+"/"]=_b6.clone(_cd.root),_cf=_b9(!_cd._v1x&&_cd,_cb,_c9,_ca);_c7(_cf,function(){for(var i=1;i<_cf.length;i++){_c1[_cf[i]]=_ce=_b6.mixin(_b6.clone(_ce),arguments[i]);}var _d0=_c8+"/"+_cb;_c1[_d0]=_ce;_cc&&_cc(_b6.delegate(_ce));});});},_d1=function(id,_d2){var _d3=_b8.exec(id),_d4=_d3[1];return /^\./.test(_d4)?_d2(_d4)+"/"+id.substring(_d4.length):id;},_d5=function(){},_d6=function(id,_d7,_d8){var _d9=_b8.exec(id),_da=_d9[1]+"/",_db=_d9[5]||_d9[4],_dc=_da+_db,_dd=(_d9[5]&&_d9[4]),_de=_dd||_b2.locale,_df=_dc+"/"+_de;if(_dd){_d5(_df);if(_c1[_df]){_d8(_c1[_df]);}else{_c6(_d7,_dc,_da,_db,_de,_d8);}return;}var _e0=_b5.extraLocale||[];_e0=_b6.isArray(_e0)?_e0:[_e0];_e0.push(_de);var _e1=_e0.length,_e2;_b4.forEach(_e0,function(_e3){_c6(_d7,_dc,_da,_db,_e3,function(_e4){if(_e3==_de){_e2=_e4;}if(!--_e1){_d8(_e2);}});});};if(has("dojo-unit-tests")){var _e5=_b7.unitTests=[];}true||has.add("dojo-v1x-i18n-Api",1);if(1){var _e6={},_e7=new Function("bundle, __evalError","var __amdResult, define = function(x){__amdResult= x;};"+"return [(function(){"+"try{eval(arguments[0]);}catch(e){}"+"if(__amdResult)return 0;"+"try{return eval('('+arguments[0]+')');}"+"catch(e){__evalError.e = e; return __evalError;}"+"})(arguments[0]) , __amdResult];"),_e8=function(url,_e9,_ea){if(_e9===_e6){return {};}return _e9?(/nls\/[^\/]+\/[^\/]+$/.test(url)?_e9:{root:_e9,_v1x:1}):_ea;},_eb=function(_ec,_ed){var _ee=[];_b4.forEach(_ec,function(mid){var url=_b3.toUrl(mid+".js");if(_c1[url]){_ee.push(_c1[url]);}else{try{var _ef=_b3(mid);if(_ef){_ee.push(_ef);return;}}catch(e){}xhr.get({url:url,sync:true,load:function(_f0){var _f1=_e7(_f0,_e6);_ee.push(_c1[url]=_e8(url,_f1[0],_f1[1]));},error:function(){_ee.push(_c1[url]={});}});}});_ed&&_ed.apply(null,_ee);},_f2=_b7.normalizeLocale=function(_f3){var _f4=_f3?_f3.toLowerCase():_b2.locale;if(_f4=="root"){_f4="ROOT";}return _f4;},_f5=function(_f6,_f7){var _f8=_f6.split("-");while(_f8.length){if(_f7(_f8.join("-"))){return true;}_f8.pop();}return _f7("ROOT");};_d5=function(_f9){for(var _fa=_f9.split("/"),_fb=_b2.global[_fa[0]],i=1;_fb&&i<_fa.length;_fb=_fb[_fa[i++]]){}if(_fb){_c1[_f9]=_fb;}};_b7.getLocalization=function(_fc,_fd,_fe){var _ff,_100=_c2(_fc,_fd,_fe).substring(10);_d6(_100,(1&&!_b3.isXdUrl(_b3.toUrl(_100+".js"))?_eb:_b3),function(_101){_ff=_101;});return _ff;};_b7._preloadLocalizations=function(_102,_103){function _104(_105){_105=_f2(_105);_f5(_105,function(loc){for(var i=0;i<_103.length;i++){if(_103[i]==loc){_eb([_102.replace(/\./g,"/")+"_"+loc]);return true;}}return false;});};_104();var _106=_b2.config.extraLocale||[];for(var i=0;i<_106.length;i++){_104(_106[i]);}};if(has("dojo-unit-tests")){_e5.push(function(doh){doh.register("tests.i18n.unit",function(t){var _107;_107=_e7("{prop:1}",_e6);t.is({prop:1},_107[0]);t.is(undefined,_107[1]);_107=_e7("({prop:1})",_e6);t.is({prop:1},_107[0]);t.is(undefined,_107[1]);_107=_e7("{'prop-x':1}",_e6);t.is({"prop-x":1},_107[0]);t.is(undefined,_107[1]);_107=_e7("({'prop-x':1})",_e6);t.is({"prop-x":1},_107[0]);t.is(undefined,_107[1]);_107=_e7("define({'prop-x':1})",_e6);t.is(0,_107[0]);t.is({"prop-x":1},_107[1]);_107=_e7("define({'prop-x':1});",_e6);t.is(0,_107[0]);t.is({"prop-x":1},_107[1]);_107=_e7("this is total nonsense and should throw an error",_e6);t.is(_e6,_107[0]);t.is(undefined,_107[1]);t.is({},_e8("some/url",_107[0],_107[1]));});});}}return _b6.mixin(_b7,{dynamic:true,normalize:_d1,load:_d6,cache:function(mid,_108){_c1[mid]=_108;}});});},"dijit/hccss":function(){define("dijit/hccss",["require","dojo/_base/config","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/ready","dojo/_base/sniff","dojo/_base/window"],function(_109,_10a,_10b,_10c,_10d,_10e,has,win){if(has("ie")||has("mozilla")){_10e(90,function(){var div=_10c.create("div",{id:"a11yTestNode",style:{cssText:"border: 1px solid;"+"border-color:red green;"+"position: absolute;"+"height: 5px;"+"top: -999px;"+"background-image: url(\""+(_10a.blankGif||_109.toUrl("dojo/resources/blank.gif"))+"\");"}},win.body());var cs=_10d.getComputedStyle(div);if(cs){var _10f=cs.backgroundImage;var _110=(cs.borderTopColor==cs.borderRightColor)||(_10f!=null&&(_10f=="none"||_10f=="url(invalid-url:)"));if(_110){_10b.add(win.body(),"dijit_a11y");}if(has("ie")){div.outerHTML="";}else{win.body().removeChild(div);}}});}});},"versa/widget/zone/mobile/Show":function(){define("versa/widget/zone/mobile/Show",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojox/mobile/Heading","dojox/mobile/ScrollableView","dojox/mobile/EdgeToEdgeDataList","dojox/mobile/TabBar","dojox/mobile/TabBarButton","versa/api/Folders","versa/api/Documents","versa/api/Zones","versa/widget/folder/mobile/FolderView","versa/widget/document/mobile/DocumentPropertyView","versa/widget/document/mobile/DocumentContentView","versa/widget/document/mobile/LargeTextView","versa/widget/search/mobile/SearchView","versa/widget/search/mobile/SearchResultsView","versa/widget/mobile/TextBox","versa/widget/mobile/Heading","versa/widget/mobile/Footing","dojox/mobile/Button","dojo/data/ItemFileWriteStore"],function(_111){var o=_111("versa.widget.zone.mobile.Show",[dijit._WidgetBase],{folderViews:[],documentViews:[],documentContentViews:[],textViews:[],constructor:function(args){this.zone=args.zone;},postCreate:function(){this.inherited("postCreate",arguments);this.folderStore=this.activeLibrary.getFolders().store;this.refStore=this.activeLibrary.getReferences().store;this.rootFolder=this.folderStore.fetch({query:{parent_id:null}}).results[0];this.loadingView=dijit.byId("loadingView");this.onLoad(this);},onCommand:function(cmd,args){switch(cmd){case versa.widget.zone.mobile.Show.COMMANDS.SHOW_FOLDER:this.showFolder(args.parent,args.folder);break;case versa.widget.zone.mobile.Show.COMMANDS.SHOW_DOCUMENT_PROPERTIES:this.showDocumentProperties(args.from,args.reference);break;case versa.widget.zone.mobile.Show.COMMANDS.SHOW_DOCUMENT_CONTENT:this.showDocumentContent(args.document,args.reference);break;case versa.widget.zone.mobile.Show.COMMANDS.SHOW_TEXT:this.showText(args.document,args.property,args.label);break;case versa.widget.zone.mobile.Show.COMMANDS.SHOW_ROOT:this.showRoot(args.from);break;case versa.widget.zone.mobile.Show.COMMANDS.SHOW_SEARCH:this.showSearch(args.from);break;case versa.widget.zone.mobile.Show.COMMANDS.PERFORM_SEARCH:this.performSearch(args.search);break;case versa.widget.zone.mobile.Show.COMMANDS.LOGOFF:this.logoff(args.from);break;}},logoff:function(from){var _112=true;if(_112){var msg="Continue to exit VersaFile?";if(!confirm(msg)){return;}}var prog=dojox.mobile.ProgressIndicator.getInstance();this.loadingView.domNode.appendChild(prog.domNode);prog.start();from.performTransition(this.loadingView.id,1,"fade");this.zone.logoff();window.location.reload(true);},showRoot:function(from){from.performTransition("folder-"+this.rootFolder.id,-1,"slidev");},showSearch:function(from){this.searchView.set("back",from.id);from.performTransition("searchView",1,"slidev");this.searchView.findAppBars();this.searchView.resize();},performSearch:function(_113){this.searchResultsView.set("search",_113);this.searchView.performTransition("searchResultsView",1,"slide");this.searchResultsView.findAppBars();this.searchResultsView.resize();},showFolder:function(_114,_115){if(!this.folderViews[_115.id]){this.folderViews[_115.id]=new versa.widget.folder.mobile.FolderView({id:"folder-"+_115.id,back:"folder-"+_114.id,library:this.activeLibrary,folder:_115,onCommand:dojo.hitch(this,this.onCommand),selected:true},dojo.create("div",{style:{height:"100%"}},dojo.body()));this.folderViews[_115.id].startup();}this.folderViews[_114.id].performTransition("folder-"+_115.id,1,"slide");this.folderViews[_115.id].findAppBars();this.folderViews[_115.id].resize();},showText:function(_116,_117,_118){if(!this.textViews[_116.id+"-"+_117]){this.textViews[_116.id+"-"+_117]=new versa.widget.document.mobile.LargeTextView({id:"document-"+_116.id+"-"+_117,back:"document-"+_116.id,label:_118,library:this.activeLibrary,document:_116,property:_117,onCommand:dojo.hitch(this,this.onCommand),selected:true},dojo.create("div",{style:{height:"100%"}},dojo.body()));this.textViews[_116.id+"-"+_117].startup();}this.documentViews[_116.id].performTransition("document-"+_116.id+"-"+_117,1,"slide");this.textViews[_116.id+"-"+_117].findAppBars();this.textViews[_116.id+"-"+_117].resize();},showDocumentProperties:function(from,_119){this.activeLibrary.getDocuments().refreshAsync({scope:this,identity:_119.document_id,onItem:dojo.hitch(this,function(_11a){if(!this.documentViews[_11a.id]){this.documentViews[_11a.id]=new versa.widget.document.mobile.DocumentPropertyView({id:"document-"+_11a.id,library:this.activeLibrary,reference:_119,document:_11a,onCommand:dojo.hitch(this,this.onCommand),selected:true},dojo.create("div",{style:{height:"100%"}},dojo.body()));this.documentViews[_11a.id].startup();}this.documentViews[_11a.id].set("back",from.id);from.performTransition("document-"+_11a.id,1,"slide");this.documentViews[_11a.id].findAppBars();this.documentViews[_11a.id].resize();}),onError:this.__onDocumentLoadError});},showDocumentContent:function(_11b,_11c){if(_11c.binary_content_type.indexOf("image")>=0||_11c.binary_content_type.indexOf("text")>=0){if(!this.documentContentViews[_11c.document_id]){this.documentContentViews[_11c.document_id]=new versa.widget.document.mobile.DocumentContentView({id:"document-content-"+_11c.document_id,back:"document-"+_11c.document_id,zone:this.zone,library:this.activeLibrary,document:_11b,reference:_11c,onCommand:dojo.hitch(this,this.onCommand),selected:true},dojo.create("div",{style:{height:"100%"}},dojo.body()));this.documentContentViews[_11c.document_id].startup();}this.documentViews[_11c.document_id].performTransition("document-content-"+_11c.document_id,1,"slide");this.documentContentViews[_11c.document_id].findAppBars();this.documentContentViews[_11c.document_id].resize();}else{var file=_11c.getCopyUrl(this.zone,this.activeLibrary);this.downloadUrl(file);}},downloadUrl:function(url){window.location.href=url;},startup:function(){this.inherited("startup",arguments);this.searchView=new versa.widget.search.mobile.SearchView({id:"searchView",back:"folder-"+this.rootFolder.id,onCommand:dojo.hitch(this,this.onCommand)},dojo.create("div",{style:{height:"100%",width:"100%"}},dojo.body()));this.searchView.startup();this.searchResultsView=new versa.widget.search.mobile.SearchResultsView({id:"searchResultsView",zone:this.zone,library:this.activeLibrary,back:"searchView",view_id:this.rootFolder.view_definition_id,onCommand:dojo.hitch(this,this.onCommand)},dojo.create("div",{style:{height:"100%",width:"100%"}},dojo.body()));this.searchResultsView.startup();this.folderViews[this.rootFolder.id]=new versa.widget.folder.mobile.FolderView({id:"folder-"+this.rootFolder.id,library:this.activeLibrary,folder:this.rootFolder,onCommand:dojo.hitch(this,this.onCommand),selected:true},dojo.create("div",{style:{height:"100%",width:"100%"}},dojo.body()));this.folderViews[this.rootFolder.id].startup();this.loadingView.performTransition(this.folderViews[this.rootFolder.id].id,1,"fade");this.folderViews[this.rootFolder.id].findAppBars();this.folderViews[this.rootFolder.id].resize();}});o.COMMANDS={SHOW_FOLDER:0,SHOW_ROOT:1,SHOW_DOCUMENT_PROPERTIES:2,SHOW_DOCUMENT_CONTENT:3,SHOW_TEXT:4,SHOW_SEARCH:5,PERFORM_SEARCH:6,LOGOFF:7};return o;});},"dojox/mobile/EdgeToEdgeDataList":function(){define("dojox/mobile/EdgeToEdgeDataList",["dojo/_base/declare","./EdgeToEdgeList","./_DataListMixin"],function(_11d,_11e,_11f){return _11d("dojox.mobile.EdgeToEdgeDataList",[_11e,_11f],{});});},"dojox/mobile/uacss":function(){define("dojox/mobile/uacss",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/window","dojox/mobile/sniff"],function(dojo,lang,win,has){win.doc.documentElement.className+=lang.trim([has("bb")?"dj_bb":"",has("android")?"dj_android":"",has("iphone")?"dj_iphone":"",has("ipod")?"dj_ipod":"",has("ipad")?"dj_ipad":""].join(" ").replace(/ +/g," "));return dojo;});},"versa/api/DataType":function(){define("versa/api/DataType",["dojo/_base/declare"],function(_120){var o=_120("versa.api.DataType",[],{constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},defaultMaxLength:function(){var _121=null;switch(this.prefix){case "str":_121=255;break;case "txt":_121=4096;break;}return _121;},isBoolean:function(){return (this.prefix=="bln");},isDateTime:function(){return (this.prefix=="dtt");},isFloat:function(){return (this.prefix=="flt");},isInteger:function(){return (this.prefix=="int");},isString:function(){return (this.prefix=="str");},isText:function(){return (this.prefix=="txt");}});o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":""},"prefix":{type:"string"}},prototype:new o()};return o;});},"versa/api/Zones":function(){define("versa/api/Zones",["dojo/_base/declare","versa/api/_Collection","versa/api/Zone"],function(_122){var o=_122("versa.api.Zones",[versa.api._Collection],{constructor:function(args){this.target=versa.api.Zones.TRGT;this.schema=versa.api.Zone.schema;this.cache=true;this._initialize();}});o.TRGT="/zones";return o;});},"versa/api/Search":function(){define("versa/api/Search",["dojo/_base/declare","versa/api/_Object"],function(_123){var o=_123("versa.api.Search",[versa.api._Object],{type:0,queryData:null,view_definition_id:null,_getAdvancedQuery:function(){return {type:this.type,query:dojo.toJson(this.queryData),view:this.view_definition_id};},_getFolderQuery:function(){return {type:this.type,query:this.queryData,view:this.view_definition_id};},_getSimpleQuery:function(){return {type:this.type,query:this.queryData,view:this.view_definition_id};},constructor:function(args){_123.safeMixin(this,((!args)?{}:args));},getQuery:function(){var _124={type:bfree.api.Search.types.NONE};switch(this.type){case bfree.api.Search.types.FOLDER:case bfree.api.Search.types.TRASH:_124=this._getFolderQuery();break;case bfree.api.Search.types.SIMPLE:_124=this._getSimpleQuery();break;case bfree.api.Search.types.ADVANCED:_124=this._getAdvancedQuery();break;case bfree.api.Search.types.TRASH:break;}return _124;}});o.types={"NONE":0,"FOLDER":1,"SIMPLE":2,"ADVANCED":3,"TRASH":4};return o;});},"versa/api/_Object":function(){define("versa/api/_Object",["dojo/_base/declare"],function(_125){return _125("versa.api._Object",[],{id:null,name:null,created_at:null,created_by:null,updated_at:null,updated_by:null,constructor:function(args){if((this.created_at!=null)&&(typeof this.created_at=="string")){this.created_at=dojo.date.stamp.fromISOString(this.created_at);}if((this.updated_at!=null)&&(typeof this.updated_at=="string")){this.updated_at=dojo.date.stamp.fromISOString(this.created_at);}},valueEquals:function(_126,_127){if(!this.hasOwnProperty(_126)){return false;}var _128=this[_126];if((_128==null)&&(_127==null)){return true;}if((typeof _128=="string")||(typeof _127=="string")){_128=(_128==null)?"":_128;_127=(_127==null)?"":_127;}return (_128==_127);},getId:function(){return (this.$ref?this.$ref:this.id);},isNew:function(){return ((this.id==undefined)||(this.id==null));},isValid:function(){return true;}});});},"versa/api/CellDefinition":function(){define("versa/api/CellDefinition",["dojo/_base/declare","versa/api/_Object","versa/api/Error"],function(_129){var o=_129("versa.api.CellDefinition",[versa.api._Object],{constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));}});o.clone=function(_12a){return new versa.api.CellDefinition({column_order:_12a.column_order,table_name:_12a.table_name,column_name:_12a.column_name,label:_12a.label,name:_12a.name,noresize:_12a.noresize,style:_12a.style,width:_12a.width,formatter:_12a.formatter,date_format:_12a.date_format});};o.compare=function(_12b,_12c){return _12b.column_order-_12c.column_order;};o.getDbName=function(_12d){return dojo.replace("{table_name}.{column_name}",_12d);};o.formats={"none":0,"icon":1,"size":2,"status":4,"datetime":8,"date":16,"time":32};o.formatStatus=function(data,_12e){var item=this.grid.getItem(_12e);var icon="none.16.png";try{if((item)&&(item.getState(versa.api.Document.states.CHECKED_OUT))){icon="cko.16.png";}}catch(e){}return dojo.replace("<img name=\"statusIcon\" src=\"/images/icons/states/{0}\" width=\"16\" height=\"16\" style=\"position:relative;top:1px;left:1px\"/>",[icon]);};o.formatIcon=function(data,_12f){if(!data){return "";}var item=this.grid.getItem(_12f);var _130=versa.api.Document.getIconUrl(data,16);var _131=dojo.create("div");var node=dojo.create("div",{style:{width:16,height:16,position:"relative"}},_131);dojo.create("img",{src:_130,width:16,height:16},node);if(item.isShare()){_130="/images/icons/states/shared.16.png";dojo.create("img",{src:_130,width:16,height:16,style:{position:"absolute",top:"2px",left:"2px"}},node);}return _131.innerHTML;};o.formatSize=function(data,_132){var _133=data;var _134=versa.api.Utilities.readablizeBytes({bytes:_133});return _134;};o.formatData=function(data,_135){return data||"";};o.formatBoolean=function(data,_136){var wdg=new dijit.form.CheckBox({scrollOnFocus:false,disabled:true,checked:data});return wdg;},o.schema={type:"object",properties:{"id":{type:"integer"},"view_definition_id":{type:"integer"},"table_name":{type:"string"},"column_name":{type:"string"},"name":{type:"string"},"label":{type:"string"},"formatter":{type:"integer","default":o.formats.none},"noresize":{type:"boolean","default":false},"width":{type:"string","default":"128px"},"style":{type:"string","default":""},"column_order":{type:"integer","default":1},"date_format":{type:"string","default":""}},prototype:new o()};return o;});},"versa/api/PropertyMapping":function(){define("versa/api/PropertyMapping",["dojo/_base/declare","versa/api/_Object","versa/api/Error","versa/api/Formatter"],function(_137){var o=_137("versa.api.PropertyMapping",[versa.api._Object],{constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));}});o.compare=function(_138,_139){return _138.sort_order-_139.sort_order;};o.formatValue=function(_13a,_13b){var _13c=null;if(_13a.isTypeDate()){_13c=versa.api.Formatter.formatDateTime(_13b);}else{_13c=_13b;}return _13c;};o.types={date:{fixed:0,floating:1}};o.schema={type:"object",properties:{"id":{type:"integer"},"document_type_id":{type:"integer"},"property_definition_id":{type:"integer"},"name":{type:"string","default":"Property"},"sort_order":{type:"integer","default":1},"is_required":{type:"boolean","default":false},"choice_list_id":{type:"integer","default":null},"default_value":{type:"string","default":null},"default_type":{type:"integer","default":0}}};return o;});},"versa/api/DocumentTypes":function(){define("versa/api/DocumentTypes",["dojo/_base/declare","versa/api/DocumentTypes","versa/api/_Collection","versa/api/DocumentType"],function(_13d){var o=_13d("versa.api.DocumentTypes",[versa.api._Collection],{library:null,_isUpdateable:function(_13e){return false;},_matchesQuery:function(item,_13f){if(dojo.isArray(item)||(item.hasOwnProperty("sort_order"))){return false;}var _140=_13f.query;var _141=_13f.queryOptions&&_13f.queryOptions.ignoreCase;for(var i in _140){var _142=_140[i];var _143=this.getValue(item,i);if((typeof _142=="string"&&(_142.match(/[\*\.]/)||_141))?!dojo.data.util.filter.patternToRegExp(_142,_141).test(_143):_143!=_142){return false;}}return true;},constructor:function(args){this.zone=args.zone;this.library=args.library;this.target=dojo.replace(versa.api.DocumentTypes.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.DocumentType.schema;this.cache=true;this._initialize();this.store.matchesQuery=dojo.hitch(this,this._matchesQuery);},getMetrics:function(args){var url=dojo.replace(versa.api.DocumentTypes.MT_TRGT,[args.zone.subdomain,args.library.id]);var _144=versa.api.XhrHelper.doGetAction({target:url});return _144;},getSystem:function(){var _145=[];this.forEach(function(item){if(item.is_system){_145.push(item);}},this);if(_145.length<1){throw new Error("No system-defined document types were found");}return _145;}});o.TRGT="/zones/{0}/libraries/{1}/document_types";o.MT_TRGT="/zones/{0}/libraries/{1}/document_types/dtmetrics.json";return o;});},"dojo/date/stamp":function(){define("dojo/date/stamp",["../_base/kernel","../_base/lang","../_base/array"],function(dojo,lang,_146){lang.getObject("date.stamp",true,dojo);dojo.date.stamp.fromISOString=function(_147,_148){if(!dojo.date.stamp._isoRegExp){dojo.date.stamp._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;}var _149=dojo.date.stamp._isoRegExp.exec(_147),_14a=null;if(_149){_149.shift();if(_149[1]){_149[1]--;}if(_149[6]){_149[6]*=1000;}if(_148){_148=new Date(_148);_146.forEach(_146.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(prop){return _148["get"+prop]();}),function(_14b,_14c){_149[_14c]=_149[_14c]||_14b;});}_14a=new Date(_149[0]||1970,_149[1]||0,_149[2]||1,_149[3]||0,_149[4]||0,_149[5]||0,_149[6]||0);if(_149[0]<100){_14a.setFullYear(_149[0]||1970);}var _14d=0,_14e=_149[7]&&_149[7].charAt(0);if(_14e!="Z"){_14d=((_149[8]||0)*60)+(Number(_149[9])||0);if(_14e!="-"){_14d*=-1;}}if(_14e){_14d-=_14a.getTimezoneOffset();}if(_14d){_14a.setTime(_14a.getTime()+_14d*60000);}}return _14a;};dojo.date.stamp.toISOString=function(_14f,_150){var _151=function(n){return (n<10)?"0"+n:n;};_150=_150||{};var _152=[],_153=_150.zulu?"getUTC":"get",date="";if(_150.selector!="time"){var year=_14f[_153+"FullYear"]();date=["0000".substr((year+"").length)+year,_151(_14f[_153+"Month"]()+1),_151(_14f[_153+"Date"]())].join("-");}_152.push(date);if(_150.selector!="date"){var time=[_151(_14f[_153+"Hours"]()),_151(_14f[_153+"Minutes"]()),_151(_14f[_153+"Seconds"]())].join(":");var _154=_14f[_153+"Milliseconds"]();if(_150.milliseconds){time+="."+(_154<100?"0":"")+_151(_154);}if(_150.zulu){time+="Z";}else{if(_150.selector!="time"){var _155=_14f.getTimezoneOffset();var _156=Math.abs(_155);time+=(_155>0?"-":"+")+_151(Math.floor(_156/60))+":"+_151(_156%60);}}_152.push(time);}return _152.join("T");};return dojo.date.stamp;});},"versa/api/Shares":function(){define("versa/api/Shares",["dojo/_base/declare","versa/api/_Collection","versa/api/Share"],function(_157){var o=_157("versa.api.Shares",[versa.api._Collection],{constructor:function(args){this.zone=args.zone;this.target=dojo.replace(versa.api.Shares.TRGT,[this.zone.subdomain]);this.schema=versa.api.Share.schema;this.cache=true;this._initialize();}});o.TRGT="/zones/{0}/shares";return o;});},"dojo/Stateful":function(){define("dojo/Stateful",["./_base/kernel","./_base/declare","./_base/lang","./_base/array"],function(dojo,_158,lang,_159){return dojo.declare("dojo.Stateful",null,{postscript:function(_15a){if(_15a){lang.mixin(this,_15a);}},get:function(name){return this[name];},set:function(name,_15b){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _15c=this[name];this[name]=_15b;if(this._watchCallbacks){this._watchCallbacks(name,_15c,_15b);}return this;},watch:function(name,_15d){var _15e=this._watchCallbacks;if(!_15e){var self=this;_15e=this._watchCallbacks=function(name,_15f,_160,_161){var _162=function(_163){if(_163){_163=_163.slice();for(var i=0,l=_163.length;i<l;i++){try{_163[i].call(self,name,_15f,_160);}catch(e){}}}};_162(_15e["_"+name]);if(!_161){_162(_15e["*"]);}};}if(!_15d&&typeof name==="function"){_15d=name;name="*";}else{name="_"+name;}var _164=_15e[name];if(typeof _164!=="object"){_164=_15e[name]=[];}_164.push(_15d);return {unwatch:function(){_164.splice(_159.indexOf(_164,_15d),1);}};}});});},"dojox/json/schema":function(){define("dojox/json/schema",["dojo/_base/kernel","dojox","dojo/_base/array"],function(dojo,_165){dojo.getObject("json.schema",true,_165);_165.json.schema.validate=function(_166,_167){return this._validate(_166,_167,false);};_165.json.schema.checkPropertyChange=function(_168,_169,_16a){return this._validate(_168,_169,_16a||"property");};_165.json.schema.mustBeValid=function(_16b){if(!_16b.valid){throw new TypeError(dojo.map(_16b.errors,function(_16c){return "for property "+_16c.property+": "+_16c.message;}).join(", "));}};_165.json.schema._validate=function(_16d,_16e,_16f){var _170=[];function _171(_172,_173,path,i){var l;path+=path?typeof i=="number"?"["+i+"]":typeof i=="undefined"?"":"."+i:i;function _174(_175){_170.push({property:path,message:_175});};if((typeof _173!="object"||_173 instanceof Array)&&(path||typeof _173!="function")){if(typeof _173=="function"){if(!(Object(_172) instanceof _173)){_174("is not an instance of the class/constructor "+_173.name);}}else{if(_173){_174("Invalid schema/property definition "+_173);}}return null;}if(_16f&&_173.readonly){_174("is a readonly field, it can not be changed");}if(_173["extends"]){_171(_172,_173["extends"],path,i);}function _176(type,_177){if(type){if(typeof type=="string"&&type!="any"&&(type=="null"?_177!==null:typeof _177!=type)&&!(_177 instanceof Array&&type=="array")&&!(type=="integer"&&_177%1===0)){return [{property:path,message:(typeof _177)+" value found, but a "+type+" is required"}];}if(type instanceof Array){var _178=[];for(var j=0;j<type.length;j++){if(!(_178=_176(type[j],_177)).length){break;}}if(_178.length){return _178;}}else{if(typeof type=="object"){var _179=_170;_170=[];_171(_177,type,path);var _17a=_170;_170=_179;return _17a;}}}return [];};if(_172===undefined){if(!_173.optional){_174("is missing and it is not optional");}}else{_170=_170.concat(_176(_173.type,_172));if(_173.disallow&&!_176(_173.disallow,_172).length){_174(" disallowed value was matched");}if(_172!==null){if(_172 instanceof Array){if(_173.items){if(_173.items instanceof Array){for(i=0,l=_172.length;i<l;i++){_170.concat(_171(_172[i],_173.items[i],path,i));}}else{for(i=0,l=_172.length;i<l;i++){_170.concat(_171(_172[i],_173.items,path,i));}}}if(_173.minItems&&_172.length<_173.minItems){_174("There must be a minimum of "+_173.minItems+" in the array");}if(_173.maxItems&&_172.length>_173.maxItems){_174("There must be a maximum of "+_173.maxItems+" in the array");}}else{if(_173.properties){_170.concat(_17b(_172,_173.properties,path,_173.additionalProperties));}}if(_173.pattern&&typeof _172=="string"&&!_172.match(_173.pattern)){_174("does not match the regex pattern "+_173.pattern);}if(_173.maxLength&&typeof _172=="string"&&_172.length>_173.maxLength){_174("may only be "+_173.maxLength+" characters long");}if(_173.minLength&&typeof _172=="string"&&_172.length<_173.minLength){_174("must be at least "+_173.minLength+" characters long");}if(typeof _173.minimum!==undefined&&typeof _172==typeof _173.minimum&&_173.minimum>_172){_174("must have a minimum value of "+_173.minimum);}if(typeof _173.maximum!==undefined&&typeof _172==typeof _173.maximum&&_173.maximum<_172){_174("must have a maximum value of "+_173.maximum);}if(_173["enum"]){var _17c=_173["enum"];l=_17c.length;var _17d;for(var j=0;j<l;j++){if(_17c[j]===_172){_17d=1;break;}}if(!_17d){_174("does not have a value in the enumeration "+_17c.join(", "));}}if(typeof _173.maxDecimal=="number"&&(_172.toString().match(new RegExp("\\.[0-9]{"+(_173.maxDecimal+1)+",}")))){_174("may only have "+_173.maxDecimal+" digits of decimal places");}}}return null;};function _17b(_17e,_17f,path,_180){if(typeof _17f=="object"){if(typeof _17e!="object"||_17e instanceof Array){_170.push({property:path,message:"an object is required"});}for(var i in _17f){if(_17f.hasOwnProperty(i)&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")){var _181=_17e[i];var _182=_17f[i];_171(_181,_182,path,i);}}}for(i in _17e){if(_17e.hasOwnProperty(i)&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")&&_17f&&!_17f[i]&&_180===false){_170.push({property:path,message:(typeof _181)+"The property "+i+" is not defined in the schema and the schema does not allow additional properties"});}var _183=_17f&&_17f[i]&&_17f[i].requires;if(_183&&!(_183 in _17e)){_170.push({property:path,message:"the presence of the property "+i+" requires that "+_183+" also be present"});}_181=_17e[i];if(_17f&&typeof _17f=="object"&&!(i in _17f)){_171(_181,_180,path,i);}if(!_16f&&_181&&_181.$schema){_170=_170.concat(_171(_181,_181.$schema,path,i));}}return _170;};if(_16e){_171(_16d,_16e,"",_16f||"");}if(!_16f&&_16d&&_16d.$schema){_171(_16d,_16d.$schema,"","");}return {valid:!_170.length,errors:_170};};return _165.json.schema;});},"versa/api/Zone":function(){define("versa/api/Zone",["dojo/_base/declare","versa/api/_Object","versa/api/_Configurable","versa/api/Groups","versa/api/Libraries","versa/api/Roles","versa/api/Users","versa/api/DocumentTypes","versa/api/PropertyDefinitions","versa/api/PropertyMappings","versa/api/ChoiceLists","versa/api/ViewDefinitions","versa/api/CellDefinitions","versa/api/XhrHelper","versa/api/Folders","versa/api/Shares","versa/api/Preferences"],function(_184){var o=_184("versa.api.Zone",[versa.api._Object,versa.api._Configurable],{subdomain:null,_groups:null,_libraries:null,_roles:null,_shares:null,_users:null,_documentTypes:new Array(),_propertyDefinitions:new Array(),_propertyMappings:new Array(),_choiceLists:new Array(),_choiceValues:new Array(),_cellDefinitions:new Array(),_viewDefinitions:new Array(),constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},getGroups:function(){if(!this._groups){this._groups=new versa.api.Groups({zone:this});}return this._groups;},getLibraries:function(){if(!this._libraries){this._libraries=new versa.api.Libraries({zone:this});}return this._libraries;},getMetrics:function(args){var url=dojo.replace(versa.api.Zone.MT_TRGT,[this.subdomain]);var _185=versa.api.XhrHelper.doGetAction({target:url});return _185;},getRoles:function(){if(!this._roles){this._roles=new versa.api.Roles({zone:this});}return this._roles;},getShares:function(){if(!this._shares){this._shares=new versa.api.Shares({zone:this});}return this._shares;},getUsers:function(){if(!this._users){this._users=new versa.api.Users({zone:this});}return this._users;},getPropertyDefinitions:function(_186){if(!this._propertyDefinitions[_186.id]){this._propertyDefinitions[_186.id]=new versa.api.PropertyDefinitions({zone:this,library:_186});}return this._propertyDefinitions[_186.id];},getDocumentTypes:function(_187){if(!this._documentTypes[_187.id]){this._documentTypes[_187.id]=new versa.api.DocumentTypes({zone:this,library:_187});}return this._documentTypes[_187.id];},getChoiceLists:function(_188){if(!this._choiceLists[_188.id]){this._choiceLists[_188.id]=new versa.api.ChoiceLists({zone:this,library:_188});}return this._choiceLists[_188.id];},getChoiceValues:function(_189){if(!this._choiceValues[_189.id]){this._choiceValues[_189.id]=new versa.api.ChoiceValues({zone:this,library:_189});}return this._choiceValues[_189.id];},getPropertyMappings:function(_18a){if(!this._propertyMappings[_18a.id]){this._propertyMappings[_18a.id]=new versa.api.PropertyMappings({zone:this,library:_18a});}return this._propertyMappings[_18a.id];},getCellDefinitions:function(_18b){if(!this._cellDefinitions[_18b.id]){this._cellDefinitions[_18b.id]=new versa.api.CellDefinitions({zone:this,library:_18b});}return this._cellDefinitions[_18b.id];},getViewDefinitions:function(_18c){if(!this._viewDefinitions[_18c.id]){this._viewDefinitions[_18c.id]=new versa.api.ViewDefinitions({zone:this,library:_18c,cellDefinitions:this.getCellDefinitions(_18c)});}return this._viewDefinitions[_18c.id];},isAlive:function(){var url=dojo.replace(versa.api.Zone.ISALIVE_URL,this);var _18d={};var _18e=versa.api.XhrHelper.doPostAction({target:url,postData:_18d});return true;},logon:function(_18f,_190){var url=dojo.replace(versa.api.Zone.LOGIN_URL,this);var _191={username:_18f,password:_190};var _192=versa.api.XhrHelper.doPostAction({target:url,postData:_191});return new versa.api.User(_192);},logoff:function(){var url=dojo.replace(versa.api.Zone.LOGOUT_URL,this);var _193={};var _194=versa.api.XhrHelper.doPostAction({target:url,postData:_193});return _194;},resetPassword:function(_195,_196){var url=dojo.replace(versa.api.Zone.RESET_URL,this);var _197={username:_195,email:_196};var _198=versa.api.XhrHelper.doPostAction({target:url,postData:_197});return _198;}});o.TrialStates={"EXPIRED":0,"NO_TRIAL":-1,"INFINITE":65535};o.LOGIN_URL="/zones/{subdomain}/logon.json";o.LOGOUT_URL="/zones/{subdomain}/logoff.json";o.ISALIVE_URL="/zones/{subdomain}/alive.json";o.MT_TRGT="/zones/{0}/metrics.json";o.RESET_URL="/zones/{subdomain}/reset.json";o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":""},"subdomain":{type:"string"},"active_permissions":{type:"integer","default":0},"created_at":{type:"date",format:"date-time"},"updated_at":{type:"date",format:"date-time"}},prototype:new o()};return o;});},"dojox/data/ServiceStore":function(){define("dojox/data/ServiceStore",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array"],function(_199,lang,_19a){return _199("dojox.data.ServiceStore",lang.getObject("dojox.data.ClientFilter",0)||null,{service:null,constructor:function(_19b){this.byId=this.fetchItemByIdentity;this._index={};if(_19b){lang.mixin(this,_19b);}this.idAttribute=(_19b&&_19b.idAttribute)||(this.schema&&this.schema._idAttr);},schema:null,idAttribute:"id",labelAttribute:"label",syncMode:false,estimateCountFactor:1,getSchema:function(){return this.schema;},loadLazyValues:true,getValue:function(item,_19c,_19d){var _19e=item[_19c];return _19e||(_19c in item?_19e:item._loadObject?(dojox.rpc._sync=true)&&arguments.callee.call(this,dojox.data.ServiceStore.prototype.loadItem({item:item})||{},_19c,_19d):_19d);},getValues:function(item,_19f){var val=this.getValue(item,_19f);return val instanceof Array?val:val===undefined?[]:[val];},getAttributes:function(item){var res=[];for(var i in item){if(item.hasOwnProperty(i)&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")){res.push(i);}}return res;},hasAttribute:function(item,_1a0){return _1a0 in item;},containsValue:function(item,_1a1,_1a2){return _19a.indexOf(this.getValues(item,_1a1),_1a2)>-1;},isItem:function(item){return (typeof item=="object")&&item&&!(item instanceof Date);},isItemLoaded:function(item){return item&&!item._loadObject;},loadItem:function(args){var item;if(args.item._loadObject){args.item._loadObject(function(_1a3){item=_1a3;delete item._loadObject;var func=_1a3 instanceof Error?args.onError:args.onItem;if(func){func.call(args.scope,_1a3);}});}else{if(args.onItem){args.onItem.call(args.scope,args.item);}}return item;},_currentId:0,_processResults:function(_1a4,_1a5){if(_1a4&&typeof _1a4=="object"){var id=_1a4.__id;if(!id){if(this.idAttribute){id=_1a4[this.idAttribute];}else{id=this._currentId++;}if(id!==undefined){var _1a6=this._index[id];if(_1a6){for(var j in _1a6){delete _1a6[j];}_1a4=lang.mixin(_1a6,_1a4);}_1a4.__id=id;this._index[id]=_1a4;}}for(var i in _1a4){_1a4[i]=this._processResults(_1a4[i],_1a5).items;}var _1a7=_1a4.length;}return {totalCount:_1a5.request.count==_1a7?(_1a5.request.start||0)+_1a7*this.estimateCountFactor:_1a7,items:_1a4};},close:function(_1a8){return _1a8&&_1a8.abort&&_1a8.abort();},fetch:function(args){args=args||{};if("syncMode" in args?args.syncMode:this.syncMode){dojox.rpc._sync=true;}var self=this;var _1a9=args.scope||self;var _1aa=this.cachingFetch?this.cachingFetch(args):this._doQuery(args);_1aa.request=args;_1aa.addCallback(function(_1ab){if(args.clientFetch){_1ab=self.clientSideFetch({query:args.clientFetch,sort:args.sort,start:args.start,count:args.count},_1ab);}var _1ac=self._processResults(_1ab,_1aa);_1ab=args.results=_1ac.items;if(args.onBegin){args.onBegin.call(_1a9,_1ac.totalCount,args);}if(args.onItem){for(var i=0;i<_1ab.length;i++){args.onItem.call(_1a9,_1ab[i],args);}}if(args.onComplete){args.onComplete.call(_1a9,args.onItem?null:_1ab,args);}return _1ab;});_1aa.addErrback(args.onError&&function(err){return args.onError.call(_1a9,err,args);});args.abort=function(){_1aa.cancel();};args.store=this;return args;},_doQuery:function(args){var _1ad=typeof args.queryStr=="string"?args.queryStr:args.query;return this.service(_1ad);},getFeatures:function(){return {"dojo.data.api.Read":true,"dojo.data.api.Identity":true,"dojo.data.api.Schema":this.schema};},getLabel:function(item){return this.getValue(item,this.labelAttribute);},getLabelAttributes:function(item){return [this.labelAttribute];},getIdentity:function(item){return item.__id;},getIdentityAttributes:function(item){return [this.idAttribute];},fetchItemByIdentity:function(args){var item=this._index[(args._prefix||"")+args.identity];if(item){if(item._loadObject){args.item=item;return this.loadItem(args);}else{if(args.onItem){args.onItem.call(args.scope,item);}}}else{return this.fetch({query:args.identity,onComplete:args.onItem,onError:args.onError,scope:args.scope}).results;}return item;}});});},"dijit/form/_TextBoxMixin":function(){define("dijit/form/_TextBoxMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/_base/event","dojo/keys","dojo/_base/lang",".."],function(_1ae,_1af,dom,_1b0,keys,lang,_1b1){var _1b2=_1af("dijit.form._TextBoxMixin",null,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",selectOnClick:false,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints);},_setValueAttr:function(_1b3,_1b4,_1b5){var _1b6;if(_1b3!==undefined){_1b6=this.filter(_1b3);if(typeof _1b5!="string"){if(_1b6!==null&&((typeof _1b6!="number")||!isNaN(_1b6))){_1b5=this.filter(this.format(_1b6,this.constraints));}else{_1b5="";}}}if(_1b5!=null&&_1b5!=undefined&&((typeof _1b5)!="number"||!isNaN(_1b5))&&this.textbox.value!=_1b5){this.textbox.value=_1b5;this._set("displayedValue",this.get("displayedValue"));}if(this.textDir=="auto"){this.applyTextDir(this.focusNode,_1b5);}this.inherited(arguments,[_1b6,_1b4]);},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value);},_setDisplayedValueAttr:function(_1b7){if(_1b7===null||_1b7===undefined){_1b7="";}else{if(typeof _1b7!="string"){_1b7=String(_1b7);}}this.textbox.value=_1b7;this._setValueAttr(this.get("value"),undefined);this._set("displayedValue",this.get("displayedValue"));if(this.textDir=="auto"){this.applyTextDir(this.focusNode,_1b7);}},format:function(_1b8){return ((_1b8==null||_1b8==undefined)?"":(_1b8.toString?_1b8.toString():_1b8));},parse:function(_1b9){return _1b9;},_refreshState:function(){},onInput:function(){},__skipInputEvent:false,_onInput:function(){if(this.textDir=="auto"){this.applyTextDir(this.focusNode,this.focusNode.value);}this._refreshState();this._set("displayedValue",this.get("displayedValue"));},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);var _1ba=function(e){var _1bb=e.charOrCode||e.keyCode||229;if(e.type=="keydown"){switch(_1bb){case keys.SHIFT:case keys.ALT:case keys.CTRL:case keys.META:case keys.CAPS_LOCK:return;default:if(_1bb>=65&&_1bb<=90){return;}}}if(e.type=="keypress"&&typeof _1bb!="string"){return;}if(e.type=="input"){if(this.__skipInputEvent){this.__skipInputEvent=false;return;}}else{this.__skipInputEvent=true;}var faux=lang.mixin({},e,{charOrCode:_1bb,wasConsumed:false,preventDefault:function(){faux.wasConsumed=true;e.preventDefault();},stopPropagation:function(){e.stopPropagation();}});if(this.onInput(faux)===false){_1b0.stop(faux);}if(faux.wasConsumed){return;}setTimeout(lang.hitch(this,"_onInput",faux),0);};_1ae.forEach(["onkeydown","onkeypress","onpaste","oncut","oninput"],function(_1bc){this.connect(this.textbox,_1bc,_1ba);},this);},_blankValue:"",filter:function(val){if(val===null){return this._blankValue;}if(typeof val!="string"){return val;}if(this.trim){val=lang.trim(val);}if(this.uppercase){val=val.toUpperCase();}if(this.lowercase){val=val.toLowerCase();}if(this.propercase){val=val.replace(/[^\s]+/g,function(word){return word.substring(0,1).toUpperCase()+word.substring(1);});}return val;},_setBlurValue:function(){this._setValueAttr(this.get("value"),true);},_onBlur:function(e){if(this.disabled){return;}this._setBlurValue();this.inherited(arguments);if(this._selectOnClickHandle){this.disconnect(this._selectOnClickHandle);}},_isTextSelected:function(){return this.textbox.selectionStart==this.textbox.selectionEnd;},_onFocus:function(by){if(this.disabled||this.readOnly){return;}if(this.selectOnClick&&by=="mouse"){this._selectOnClickHandle=this.connect(this.domNode,"onmouseup",function(){this.disconnect(this._selectOnClickHandle);if(this._isTextSelected()){_1b2.selectInputText(this.textbox);}});}this.inherited(arguments);this._refreshState();},reset:function(){this.textbox.value="";this.inherited(arguments);},_setTextDirAttr:function(_1bd){if(!this._created||this.textDir!=_1bd){this._set("textDir",_1bd);this.applyTextDir(this.focusNode,this.focusNode.value);}}});_1b2._setSelectionRange=_1b1._setSelectionRange=function(_1be,_1bf,stop){if(_1be.setSelectionRange){_1be.setSelectionRange(_1bf,stop);}};_1b2.selectInputText=_1b1.selectInputText=function(_1c0,_1c1,stop){_1c0=dom.byId(_1c0);if(isNaN(_1c1)){_1c1=0;}if(isNaN(stop)){stop=_1c0.value?_1c0.value.length:0;}try{_1c0.focus();_1b2._setSelectionRange(_1c0,_1c1,stop);}catch(e){}};return _1b2;});},"versa/api/Acl":function(){define("versa/api/Acl",["dojo/_base/declare"],function(_1c2){var o=_1c2("versa.api.Acl",[],{id:null,inherited:false,acl_entries:[],constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},getAdministrator:function(){for(var i=0;i<this.acl_entries.length;i++){var _1c3=this.acl_entries[i];if((_1c3.grantee_type.toLowerCase()=="group")&&(_1c3.grantee.name.toLowerCase()=="administrators")){return this.acl_entries[i];}}},getEveryone:function(zone){var _1c4=null;dojo.some(this.acl_entries,function(_1c5,idx){var _1c6=(_1c5.grantee_type.toLowerCase()=="group")?zone.getGroups().fetchById({id:_1c5.grantee_id}):zone.getUsers().fetchById({id:_1c5.grantee_id});if(_1c6.isInstanceOf(versa.api.Group)&&_1c6.is_everyone){_1c4=_1c5;}return (_1c4!=null);},this);return _1c4;},hasAccess:function(zone,_1c7,_1c8){var _1c9=Number.NaN;var _1ca=Number.NaN;var _1cb=Number.NaN;dojo.forEach(this.acl_entries,function(_1cc,idx){var role=zone.getRoles().fetchById({id:_1cc.role_id});var _1cd=(_1cc.grantee_type.toLowerCase()=="group")?zone.getGroups().fetchById({id:_1cc.grantee_id}):zone.getUsers().fetchById({id:_1cc.grantee_id});if((_1cd.isInstanceOf(versa.api.User))&&(_1cc.grantee_id==_1c7.id)){_1c9=role.permissions;}else{if((_1cd.isInstanceOf(versa.api.Group))&&(_1cc.grantee_id==_1c8.id)){_1ca=role.permissions;}else{if((_1cd.isInstanceOf(versa.api.Group))&&(_1cd.is_everyone)){_1cb=role.permissions;}}}},this);if(!isNaN(_1c9)){return (_1c9>0);}if(!isNaN(_1ca)){return (_1ca>0);}if(!isNaN(_1cb)){return (_1cb>0);}return false;}});o.schema={type:"object",properties:{"id":{type:"integer"},"inherit_state":{type:"integer"},"inherited":{type:"boolean","default":false}},prototype:new o()};return o;});},"dojox/mobile/Heading":function(){define("dojox/mobile/Heading",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dijit/registry","dijit/_Contained","dijit/_Container","dijit/_WidgetBase","./View"],function(_1ce,_1cf,_1d0,lang,win,_1d1,_1d2,_1d3,_1d4,_1d5,_1d6,_1d7,View){var dm=lang.getObject("dojox.mobile",true);return _1d0("dojox.mobile.Heading",[_1d7,_1d6,_1d5],{back:"",href:"",moveTo:"",transition:"slide",label:"",iconBase:"",backProp:{className:"mblArrowButton"},tag:"H1",buildRendering:function(){this.domNode=this.containerNode=this.srcNodeRef||win.doc.createElement(this.tag);this.domNode.className="mblHeading";if(!this.label){_1ce.forEach(this.domNode.childNodes,function(n){if(n.nodeType==3){var v=lang.trim(n.nodeValue);if(v){this.label=v;this.labelNode=_1d2.create("SPAN",{innerHTML:v},n,"replace");}}},this);}if(!this.labelNode){this.labelNode=_1d2.create("SPAN",null,this.domNode);}this.labelNode.className="mblHeadingSpanTitle";this.labelDivNode=_1d2.create("DIV",{className:"mblHeadingDivTitle",innerHTML:this.labelNode.innerHTML},this.domNode);},startup:function(){if(this._started){return;}var _1d8=this.getParent&&this.getParent();if(!_1d8||!_1d8.resize){var _1d9=this;setTimeout(function(){_1d9.resize();},0);}this.inherited(arguments);},resize:function(){if(this._btn){this._btn.style.width=this._body.offsetWidth+this._head.offsetWidth+"px";}if(this.labelNode){var _1da,_1db;var _1dc=this.containerNode.childNodes;for(var i=_1dc.length-1;i>=0;i--){var c=_1dc[i];if(c.nodeType===1){if(!_1db&&_1d1.contains(c,"mblToolBarButton")&&_1d3.get(c,"float")==="right"){_1db=c;}if(!_1da&&(_1d1.contains(c,"mblToolBarButton")&&_1d3.get(c,"float")==="left"||c===this._btn)){_1da=c;}}}if(!this.labelNodeLen&&this.label){this.labelNode.style.display="inline";this.labelNodeLen=this.labelNode.offsetWidth;this.labelNode.style.display="";}var bw=this.domNode.offsetWidth;var rw=_1db?bw-_1db.offsetLeft+5:0;var lw=_1da?_1da.offsetLeft+_1da.offsetWidth+5:0;var tw=this.labelNodeLen||0;_1d1[bw-Math.max(rw,lw)*2>tw?"add":"remove"](this.domNode,"mblHeadingCenterTitle");}_1ce.forEach(this.getChildren(),function(_1dd){if(_1dd.resize){_1dd.resize();}});},_setBackAttr:function(back){if(!back){_1d2.destroy(this._btn);this._btn=null;this.back="";}else{if(!this._btn){var btn=_1d2.create("DIV",this.backProp,this.domNode,"first");var head=_1d2.create("DIV",{className:"mblArrowButtonHead"},btn);var body=_1d2.create("DIV",{className:"mblArrowButtonBody mblArrowButtonText"},btn);this._body=body;this._head=head;this._btn=btn;this.backBtnNode=btn;this.connect(body,"onclick","onClick");}this.back=back;this._body.innerHTML=this._cv?this._cv(this.back):this.back;}this.resize();},_setLabelAttr:function(_1de){this.label=_1de;this.labelNode.innerHTML=this.labelDivNode.innerHTML=this._cv?this._cv(_1de):_1de;},findCurrentView:function(){var w=this;while(true){w=w.getParent();if(!w){return null;}if(w instanceof View){break;}}return w;},onClick:function(e){var h1=this.domNode;_1d1.add(h1,"mblArrowButtonSelected");setTimeout(function(){_1d1.remove(h1,"mblArrowButtonSelected");},1000);if(this.back&&!this.moveTo&&!this.href&&history){history.back();return;}var view=this.findCurrentView();if(view){view.clickedPosX=e.clientX;view.clickedPosY=e.clientY;}this.goTo(this.moveTo,this.href);},goTo:function(_1df,href){var view=this.findCurrentView();if(!view){return;}if(href){view.performTransition(null,-1,this.transition,this,function(){location.href=href;});}else{if(dm.app&&dm.app.STAGE_CONTROLLER_ACTIVE){_1cf.publish("/dojox/mobile/app/goback");}else{var node=_1d4.byId(view.convertToId(_1df));if(node){var _1e0=node.getParent();while(view){var _1e1=view.getParent();if(_1e0===_1e1){break;}view=_1e1;}}if(view){view.performTransition(_1df,-1,this.transition);}}}}});});},"dojox/mobile/TransitionEvent":function(){define("dojox/mobile/TransitionEvent",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/on","./transition"],function(_1e2,_1e3,lang,on,_1e4){return _1e2("dojox.mobile.TransitionEvent",null,{constructor:function(_1e5,_1e6,_1e7){this.transitionOptions=_1e6;this.target=_1e5;this.triggerEvent=_1e7||null;},dispatch:function(){var opts={bubbles:true,cancelable:true,detail:this.transitionOptions,triggerEvent:this.triggerEvent};var evt=on.emit(this.target,"startTransition",opts);if(evt){_1e3.when(_1e4,lang.hitch(this,function(_1e8){_1e3.when(_1e8.call(this,evt),lang.hitch(this,function(_1e9){this.endTransition(_1e9);}));}));}},endTransition:function(_1ea){on.emit(this.target,"endTransition",{detail:_1ea.transitionOptions});}});});},"dijit/main":function(){define("dijit/main",["dojo/_base/kernel"],function(dojo){return dojo.dijit;});},"versa/api/DataTypes":function(){define("versa/api/DataTypes",["dojo/_base/declare","versa/api/DataType","versa/api/_Collection"],function(_1eb){var o=_1eb("versa.api.DataTypes",[versa.api._Collection],{constructor:function(args){this.zone=null;this.target=versa.api.DataTypes.TRGT;this.schema=versa.api.DataType.schema;this.cache=true;this._initialize();}});o.types={"VOID":0,"BOOLEAN":1,"INTEGER":2,"FLOAT":3,"DATETIME":4,"STRING":5,"TEXT":6};o.TRGT="/data_types";return o;});},"versa/api/DocumentType":function(){define("versa/api/DocumentType",["dojo/_base/declare","versa/api/_Object","versa/api/XhrHelper","versa/api/PropertyMapping"],function(_1ec){var o=_1ec("versa.api.DocumentType",[versa.api._Object],{constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},getMetrics:function(args){var url=dojo.replace(versa.api.DocumentType.MT_TRGT,[args.zone.subdomain,args.library.id,this.id]);var _1ed=versa.api.XhrHelper.doGetAction({target:url});return true;},hasProperty:function(id){var has=dojo.some(this.property_mappings,function(_1ee,idx){return (_1ee.property_definition_id==id);},this);return has;},isValid:function(){var _1ef=true;if(String.isEmpty(this.name.trim())){_1ef=false;}return _1ef;}});o.MT_TRGT="/zones/{0}/libraries/{1}/document_types/{2}/dtmetrics.json";o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":""},"is_system":{type:"boolean","default":false},"property_mappings":{type:"array","default":[],items:{type:"object",properties:{"property_definition_id":{type:"integer"},"choice_list_id":{type:"integer"},"default_value":{type:"string"},"is_required":{type:"boolean"},"sort_order":{type:"integer"},prototype:new versa.api.PropertyMapping()}}},"created_at":{type:"date",format:"date-time"},"created_by":{type:"string"},"description":{type:"string","default":""},"updated_at":{type:"date",format:"date-time"},"updated_by":{type:"string"}},prototype:new o()};return o;});},"dijit/_OnDijitClickMixin":function(){define("dijit/_OnDijitClickMixin",["dojo/on","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/sniff","dojo/_base/unload","dojo/_base/window"],function(on,_1f0,keys,_1f1,has,_1f2,win){var _1f3=null;if(has("ie")){(function(){var _1f4=function(evt){_1f3=evt.srcElement;};win.doc.attachEvent("onkeydown",_1f4);_1f2.addOnWindowUnload(function(){win.doc.detachEvent("onkeydown",_1f4);});})();}else{win.doc.addEventListener("keydown",function(evt){_1f3=evt.target;},true);}var _1f5=function(node,_1f6){if(/input|button/i.test(node.nodeName)){return on(node,"click",_1f6);}else{function _1f7(e){return (e.keyCode==keys.ENTER||e.keyCode==keys.SPACE)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey;};var _1f8=[on(node,"keypress",function(e){if(_1f7(e)){_1f3=e.target;e.preventDefault();}}),on(node,"keyup",function(e){if(_1f7(e)&&e.target==_1f3){_1f3=null;_1f6.call(this,e);}}),on(node,"click",function(e){_1f6.call(this,e);})];return {remove:function(){_1f0.forEach(_1f8,function(h){h.remove();});}};}};return _1f1("dijit._OnDijitClickMixin",null,{connect:function(obj,_1f9,_1fa){return this.inherited(arguments,[obj,_1f9=="ondijitclick"?_1f5:_1f9,_1fa]);}});});},"dojox/mobile/ScrollableView":function(){define("dojox/mobile/ScrollableView",["dojo/_base/array","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dijit/registry","./View","./_ScrollableMixin"],function(_1fb,_1fc,_1fd,_1fe,_1ff,View,_200){return _1fc("dojox.mobile.ScrollableView",[View,_200],{scrollableParams:null,keepScrollPos:false,constructor:function(){this.scrollableParams={noResize:true};},buildRendering:function(){this.inherited(arguments);_1fd.add(this.domNode,"mblScrollableView");this.domNode.style.overflow="hidden";this.domNode.style.top="0px";this.containerNode=_1fe.create("DIV",{className:"mblScrollableViewContainer"},this.domNode);this.containerNode.style.position="absolute";this.containerNode.style.top="0px";if(this.scrollDir==="v"){this.containerNode.style.width="100%";}this.reparent();this.findAppBars();},resize:function(){this.inherited(arguments);_1fb.forEach(this.getChildren(),function(_201){if(_201.resize){_201.resize();}});},isTopLevel:function(e){var _202=this.getParent&&this.getParent();return (!_202||!_202.resize);},addChild:function(_203,_204){var c=_203.domNode;var _205=this.checkFixedBar(c,true);if(_205){this.domNode.appendChild(c);if(_205==="top"){this.fixedHeaderHeight=c.offsetHeight;this.isLocalHeader=true;}else{if(_205==="bottom"){this.fixedFooterHeight=c.offsetHeight;this.isLocalFooter=true;c.style.bottom="0px";}}this.resize();if(this._started&&!_203._started){_203.startup();}}else{this.inherited(arguments);}},reparent:function(){var i,idx,len,c;for(i=0,idx=0,len=this.domNode.childNodes.length;i<len;i++){c=this.domNode.childNodes[idx];if(c===this.containerNode||this.checkFixedBar(c,true)){idx++;continue;}this.containerNode.appendChild(this.domNode.removeChild(c));}},onAfterTransitionIn:function(_206,dir,_207,_208,_209){this.flashScrollBar();},getChildren:function(){var _20a=this.inherited(arguments);if(this.fixedHeader&&this.fixedHeader.parentNode===this.domNode){_20a.push(_1ff.byNode(this.fixedHeader));}if(this.fixedFooter&&this.fixedFooter.parentNode===this.domNode){_20a.push(_1ff.byNode(this.fixedFooter));}return _20a;}});});},"dojox/rpc/JsonRest":function(){define("dojox/rpc/JsonRest",["dojo","dojox","dojox/json/ref","dojox/rpc/Rest"],function(dojo,_20b){var _20c=[];var Rest=_20b.rpc.Rest;var jr;function _20d(_20e,_20f,_210,_211){var _212=_20f.ioArgs&&_20f.ioArgs.xhr&&_20f.ioArgs.xhr.getResponseHeader("Last-Modified");if(_212&&Rest._timeStamps){Rest._timeStamps[_211]=_212;}var _213=_20e._schema&&_20e._schema.hrefProperty;if(_213){_20b.json.ref.refAttribute=_213;}_210=_210&&_20b.json.ref.resolveJson(_210,{defaultId:_211,index:Rest._index,timeStamps:_212&&Rest._timeStamps,time:_212,idPrefix:_20e.servicePath.replace(/[^\/]*$/,""),idAttribute:jr.getIdAttribute(_20e),schemas:jr.schemas,loader:jr._loader,idAsRef:_20e.idAsRef,assignAbsoluteIds:true});_20b.json.ref.refAttribute="$ref";return _210;};jr=_20b.rpc.JsonRest={serviceClass:_20b.rpc.Rest,conflictDateHeader:"If-Unmodified-Since",commit:function(_214){_214=_214||{};var _215=[];var _216={};var _217=[];for(var i=0;i<_20c.length;i++){var _218=_20c[i];var _219=_218.object;var old=_218.old;var _21a=false;if(!(_214.service&&(_219||old)&&(_219||old).__id.indexOf(_214.service.servicePath))&&_218.save){delete _219.__isDirty;if(_219){if(old){var _21b;if((_21b=_219.__id.match(/(.*)#.*/))){_219=Rest._index[_21b[1]];}if(!(_219.__id in _216)){_216[_219.__id]=_219;if(_214.incrementalUpdates&&!_21b){var _21c=(typeof _214.incrementalUpdates=="function"?_214.incrementalUpdates:function(){_21c={};for(var j in _219){if(_219.hasOwnProperty(j)){if(_219[j]!==old[j]){_21c[j]=_219[j];}}else{if(old.hasOwnProperty(j)){return null;}}}return _21c;})(_219,old);}if(_21c){_215.push({method:"post",target:_219,content:_21c});}else{_215.push({method:"put",target:_219,content:_219});}}}else{var _21d=jr.getServiceAndId(_219.__id).service;var _21e=jr.getIdAttribute(_21d);if((_21e in _219)&&!_214.alwaysPostNewItems){_215.push({method:"put",target:_219,content:_219});}else{_215.push({method:"post",target:{__id:_21d.servicePath},content:_219});}}}else{if(old){_215.push({method:"delete",target:old});}}_217.push(_218);_20c.splice(i--,1);}}dojo.connect(_214,"onError",function(){if(_214.revertOnError!==false){var _21f=_20c;_20c=_217;var _220=0;jr.revert();_20c=_21f;}else{_20c=dirtyObject.concat(_217);}});jr.sendToServer(_215,_214);return _215;},sendToServer:function(_221,_222){var _223;var _224=dojo.xhr;var left=_221.length;var i,_225;var _226;var _227=this.conflictDateHeader;dojo.xhr=function(_228,args){args.headers=args.headers||{};args.headers["Transaction"]=_221.length-1==i?"commit":"open";if(_227&&_226){args.headers[_227]=_226;}if(_225){args.headers["Content-ID"]="<"+_225+">";}return _224.apply(dojo,arguments);};for(i=0;i<_221.length;i++){var _229=_221[i];_20b.rpc.JsonRest._contentId=_229.content&&_229.content.__id;var _22a=_229.method=="post";_226=_229.method=="put"&&Rest._timeStamps[_229.content.__id];if(_226){Rest._timeStamps[_229.content.__id]=(new Date())+"";}_225=_22a&&_20b.rpc.JsonRest._contentId;var _22b=jr.getServiceAndId(_229.target.__id);var _22c=_22b.service;var dfd=_229.deferred=_22c[_229.method](_22b.id.replace(/#/,""),_20b.json.ref.toJson(_229.content,false,_22c.servicePath,true));(function(_22d,dfd,_22e){dfd.addCallback(function(_22f){try{var _230=dfd.ioArgs.xhr&&dfd.ioArgs.xhr.getResponseHeader("Location");if(_230){var _231=_230.match(/(^\w+:\/\/)/)&&_230.indexOf(_22e.servicePath);_230=_231>0?_230.substring(_231):(_22e.servicePath+_230).replace(/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/,"$2$3");_22d.__id=_230;Rest._index[_230]=_22d;}_22f=_20d(_22e,dfd,_22f,_22d&&_22d.__id);}catch(e){}if(!(--left)){if(_222.onComplete){_222.onComplete.call(_222.scope,_221);}}return _22f;});})(_229.content,dfd,_22c);dfd.addErrback(function(_232){left=-1;_222.onError.call(_222.scope,_232);});}dojo.xhr=_224;},getDirtyObjects:function(){return _20c;},revert:function(_233){for(var i=_20c.length;i>0;){i--;var _234=_20c[i];var _235=_234.object;var old=_234.old;var _236=_20b.data._getStoreForItem(_235||old);if(!(_233&&(_235||old)&&(_235||old).__id.indexOf(_233.servicePath))){if(_235&&old){for(var j in old){if(old.hasOwnProperty(j)&&_235[j]!==old[j]){if(_236){_236.onSet(_235,j,_235[j],old[j]);}_235[j]=old[j];}}for(j in _235){if(!old.hasOwnProperty(j)){if(_236){_236.onSet(_235,j,_235[j]);}delete _235[j];}}}else{if(!old){if(_236){_236.onDelete(_235);}}else{if(_236){_236.onNew(old);}}}delete (_235||old).__isDirty;_20c.splice(i,1);}}},changing:function(_237,_238){if(!_237.__id){return;}_237.__isDirty=true;for(var i=0;i<_20c.length;i++){var _239=_20c[i];if(_237==_239.object){if(_238){_239.object=false;if(!this._saveNotNeeded){_239.save=true;}}return;}}var old=_237 instanceof Array?[]:{};for(i in _237){if(_237.hasOwnProperty(i)){old[i]=_237[i];}}_20c.push({object:!_238&&_237,old:old,save:!this._saveNotNeeded});},deleteObject:function(_23a){this.changing(_23a,true);},getConstructor:function(_23b,_23c){if(typeof _23b=="string"){var _23d=_23b;_23b=new _20b.rpc.Rest(_23b,true);this.registerService(_23b,_23d,_23c);}if(_23b._constructor){return _23b._constructor;}_23b._constructor=function(data){var self=this;var args=arguments;var _23e;var _23f;function _240(_241){if(_241){_240(_241["extends"]);_23e=_241.properties;for(var i in _23e){var _242=_23e[i];if(_242&&(typeof _242=="object")&&("default" in _242)){self[i]=_242["default"];}}}if(_241&&_241.prototype&&_241.prototype.initialize){_23f=true;_241.prototype.initialize.apply(self,args);}};_240(_23b._schema);if(!_23f&&data&&typeof data=="object"){dojo.mixin(self,data);}var _243=jr.getIdAttribute(_23b);Rest._index[this.__id=this.__clientId=_23b.servicePath+(this[_243]||Math.random().toString(16).substring(2,14)+"@"+((_20b.rpc.Client&&_20b.rpc.Client.clientId)||"client"))]=this;if(_20b.json.schema&&_23e){_20b.json.schema.mustBeValid(_20b.json.schema.validate(this,_23b._schema));}_20c.push({object:this,save:true});};return dojo.mixin(_23b._constructor,_23b._schema,{load:_23b});},fetch:function(_244){var _245=jr.getServiceAndId(_244);return this.byId(_245.service,_245.id);},getIdAttribute:function(_246){var _247=_246._schema;var _248;if(_247){if(!(_248=_247._idAttr)){for(var i in _247.properties){if(_247.properties[i].identity||(_247.properties[i].link=="self")){_247._idAttr=_248=i;}}}}return _248||"id";},getServiceAndId:function(_249){var _24a="";for(var _24b in jr.services){if((_249.substring(0,_24b.length)==_24b)&&(_24b.length>=_24a.length)){_24a=_24b;}}if(_24a){return {service:jr.services[_24a],id:_249.substring(_24a.length)};}var _24c=_249.match(/^(.*\/)([^\/]*)$/);return {service:new jr.serviceClass(_24c[1],true),id:_24c[2]};},services:{},schemas:{},registerService:function(_24d,_24e,_24f){_24e=_24d.servicePath=_24e||_24d.servicePath;_24d._schema=jr.schemas[_24e]=_24f||_24d._schema||{};jr.services[_24e]=_24d;},byId:function(_250,id){var _251,_252=Rest._index[(_250.servicePath||"")+id];if(_252&&!_252._loadObject){_251=new dojo.Deferred();_251.callback(_252);return _251;}return this.query(_250,id);},query:function(_253,id,args){var _254=_253(id,args);_254.addCallback(function(_255){if(_255.nodeType&&_255.cloneNode){return _255;}return _20d(_253,_254,_255,typeof id!="string"||(args&&(args.start||args.count))?undefined:id);});return _254;},_loader:function(_256){var _257=jr.getServiceAndId(this.__id);var self=this;jr.query(_257.service,_257.id).addBoth(function(_258){if(_258==self){delete _258.$ref;delete _258._loadObject;}else{self._loadObject=function(_259){_259(_258);};}_256(_258);});},isDirty:function(item,_25a){if(!item){if(_25a){return dojo.some(_20c,function(_25b){return _20b.data._getStoreForItem(_25b.object||_25b.old)==_25a;});}return !!_20c.length;}return item.__isDirty;}};return _20b.rpc.JsonRest;});},"dojo/data/ItemFileWriteStore":function(){define("dojo/data/ItemFileWriteStore",["../_base/lang","../_base/declare","../_base/array","../_base/json","../_base/window","./ItemFileReadStore","../date/stamp"],function(lang,_25c,_25d,_25e,_25f,_260,_261){return _25c("dojo.data.ItemFileWriteStore",_260,{constructor:function(_262){this._features["dojo.data.api.Write"]=true;this._features["dojo.data.api.Notification"]=true;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};if(!this._datatypeMap["Date"].serialize){this._datatypeMap["Date"].serialize=function(obj){return _261.toISOString(obj,{zulu:true});};}if(_262&&(_262.referenceIntegrity===false)){this.referenceIntegrity=false;}this._saveInProgress=false;},referenceIntegrity:true,_assert:function(_263){if(!_263){throw new Error("assertion failed in ItemFileWriteStore");}},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"];},newItem:function(_264,_265){this._assert(!this._saveInProgress);if(!this._loadFinished){this._forceLoad();}if(typeof _264!="object"&&typeof _264!="undefined"){throw new Error("newItem() was passed something other than an object");}var _266=null;var _267=this._getIdentifierAttribute();if(_267===Number){_266=this._arrayOfAllItems.length;}else{_266=_264[_267];if(typeof _266==="undefined"){throw new Error("newItem() was not passed an identity for the new item");}if(lang.isArray(_266)){throw new Error("newItem() was not passed an single-valued identity");}}if(this._itemsByIdentity){this._assert(typeof this._itemsByIdentity[_266]==="undefined");}this._assert(typeof this._pending._newItems[_266]==="undefined");this._assert(typeof this._pending._deletedItems[_266]==="undefined");var _268={};_268[this._storeRefPropName]=this;_268[this._itemNumPropName]=this._arrayOfAllItems.length;if(this._itemsByIdentity){this._itemsByIdentity[_266]=_268;_268[_267]=[_266];}this._arrayOfAllItems.push(_268);var _269=null;if(_265&&_265.parent&&_265.attribute){_269={item:_265.parent,attribute:_265.attribute,oldValue:undefined};var _26a=this.getValues(_265.parent,_265.attribute);if(_26a&&_26a.length>0){var _26b=_26a.slice(0,_26a.length);if(_26a.length===1){_269.oldValue=_26a[0];}else{_269.oldValue=_26a.slice(0,_26a.length);}_26b.push(_268);this._setValueOrValues(_265.parent,_265.attribute,_26b,false);_269.newValue=this.getValues(_265.parent,_265.attribute);}else{this._setValueOrValues(_265.parent,_265.attribute,_268,false);_269.newValue=_268;}}else{_268[this._rootItemPropName]=true;this._arrayOfTopLevelItems.push(_268);}this._pending._newItems[_266]=_268;for(var key in _264){if(key===this._storeRefPropName||key===this._itemNumPropName){throw new Error("encountered bug in ItemFileWriteStore.newItem");}var _26c=_264[key];if(!lang.isArray(_26c)){_26c=[_26c];}_268[key]=_26c;if(this.referenceIntegrity){for(var i=0;i<_26c.length;i++){var val=_26c[i];if(this.isItem(val)){this._addReferenceToMap(val,_268,key);}}}}this.onNew(_268,_269);return _268;},_removeArrayElement:function(_26d,_26e){var _26f=_25d.indexOf(_26d,_26e);if(_26f!=-1){_26d.splice(_26f,1);return true;}return false;},deleteItem:function(item){this._assert(!this._saveInProgress);this._assertIsItem(item);var _270=item[this._itemNumPropName];var _271=this.getIdentity(item);if(this.referenceIntegrity){var _272=this.getAttributes(item);if(item[this._reverseRefMap]){item["backup_"+this._reverseRefMap]=lang.clone(item[this._reverseRefMap]);}_25d.forEach(_272,function(_273){_25d.forEach(this.getValues(item,_273),function(_274){if(this.isItem(_274)){if(!item["backupRefs_"+this._reverseRefMap]){item["backupRefs_"+this._reverseRefMap]=[];}item["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(_274),attr:_273});this._removeReferenceFromMap(_274,item,_273);}},this);},this);var _275=item[this._reverseRefMap];if(_275){for(var _276 in _275){var _277=null;if(this._itemsByIdentity){_277=this._itemsByIdentity[_276];}else{_277=this._arrayOfAllItems[_276];}if(_277){for(var _278 in _275[_276]){var _279=this.getValues(_277,_278)||[];var _27a=_25d.filter(_279,function(_27b){return !(this.isItem(_27b)&&this.getIdentity(_27b)==_271);},this);this._removeReferenceFromMap(item,_277,_278);if(_27a.length<_279.length){this._setValueOrValues(_277,_278,_27a,true);}}}}}}this._arrayOfAllItems[_270]=null;item[this._storeRefPropName]=null;if(this._itemsByIdentity){delete this._itemsByIdentity[_271];}this._pending._deletedItems[_271]=item;if(item[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,item);}this.onDelete(item);return true;},setValue:function(item,_27c,_27d){return this._setValueOrValues(item,_27c,_27d,true);},setValues:function(item,_27e,_27f){return this._setValueOrValues(item,_27e,_27f,true);},unsetAttribute:function(item,_280){return this._setValueOrValues(item,_280,[],true);},_setValueOrValues:function(item,_281,_282,_283){this._assert(!this._saveInProgress);this._assertIsItem(item);this._assert(lang.isString(_281));this._assert(typeof _282!=="undefined");var _284=this._getIdentifierAttribute();if(_281==_284){throw new Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");}var _285=this._getValueOrValues(item,_281);var _286=this.getIdentity(item);if(!this._pending._modifiedItems[_286]){var _287={};for(var key in item){if((key===this._storeRefPropName)||(key===this._itemNumPropName)||(key===this._rootItemPropName)){_287[key]=item[key];}else{if(key===this._reverseRefMap){_287[key]=lang.clone(item[key]);}else{_287[key]=item[key].slice(0,item[key].length);}}}this._pending._modifiedItems[_286]=_287;}var _288=false;if(lang.isArray(_282)&&_282.length===0){_288=delete item[_281];_282=undefined;if(this.referenceIntegrity&&_285){var _289=_285;if(!lang.isArray(_289)){_289=[_289];}for(var i=0;i<_289.length;i++){var _28a=_289[i];if(this.isItem(_28a)){this._removeReferenceFromMap(_28a,item,_281);}}}}else{var _28b;if(lang.isArray(_282)){_28b=_282.slice(0,_282.length);}else{_28b=[_282];}if(this.referenceIntegrity){if(_285){var _289=_285;if(!lang.isArray(_289)){_289=[_289];}var map={};_25d.forEach(_289,function(_28c){if(this.isItem(_28c)){var id=this.getIdentity(_28c);map[id.toString()]=true;}},this);_25d.forEach(_28b,function(_28d){if(this.isItem(_28d)){var id=this.getIdentity(_28d);if(map[id.toString()]){delete map[id.toString()];}else{this._addReferenceToMap(_28d,item,_281);}}},this);for(var rId in map){var _28e;if(this._itemsByIdentity){_28e=this._itemsByIdentity[rId];}else{_28e=this._arrayOfAllItems[rId];}this._removeReferenceFromMap(_28e,item,_281);}}else{for(var i=0;i<_28b.length;i++){var _28a=_28b[i];if(this.isItem(_28a)){this._addReferenceToMap(_28a,item,_281);}}}}item[_281]=_28b;_288=true;}if(_283){this.onSet(item,_281,_285,_282);}return _288;},_addReferenceToMap:function(_28f,_290,_291){var _292=this.getIdentity(_290);var _293=_28f[this._reverseRefMap];if(!_293){_293=_28f[this._reverseRefMap]={};}var _294=_293[_292];if(!_294){_294=_293[_292]={};}_294[_291]=true;},_removeReferenceFromMap:function(_295,_296,_297){var _298=this.getIdentity(_296);var _299=_295[this._reverseRefMap];var _29a;if(_299){for(_29a in _299){if(_29a==_298){delete _299[_29a][_297];if(this._isEmpty(_299[_29a])){delete _299[_29a];}}}if(this._isEmpty(_299)){delete _295[this._reverseRefMap];}}},_dumpReferenceMap:function(){var i;for(i=0;i<this._arrayOfAllItems.length;i++){var item=this._arrayOfAllItems[i];if(item&&item[this._reverseRefMap]){}}},_getValueOrValues:function(item,_29b){var _29c=undefined;if(this.hasAttribute(item,_29b)){var _29d=this.getValues(item,_29b);if(_29d.length==1){_29c=_29d[0];}else{_29c=_29d;}}return _29c;},_flatten:function(_29e){if(this.isItem(_29e)){return {_reference:this.getIdentity(_29e)};}else{if(typeof _29e==="object"){for(var type in this._datatypeMap){var _29f=this._datatypeMap[type];if(lang.isObject(_29f)&&!lang.isFunction(_29f)){if(_29e instanceof _29f.type){if(!_29f.serialize){throw new Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+type+"]");}return {_type:type,_value:_29f.serialize(_29e)};}}else{if(_29e instanceof _29f){return {_type:type,_value:_29e.toString()};}}}}return _29e;}},_getNewFileContentString:function(){var _2a0={};var _2a1=this._getIdentifierAttribute();if(_2a1!==Number){_2a0.identifier=_2a1;}if(this._labelAttr){_2a0.label=this._labelAttr;}_2a0.items=[];for(var i=0;i<this._arrayOfAllItems.length;++i){var item=this._arrayOfAllItems[i];if(item!==null){var _2a2={};for(var key in item){if(key!==this._storeRefPropName&&key!==this._itemNumPropName&&key!==this._reverseRefMap&&key!==this._rootItemPropName){var _2a3=this.getValues(item,key);if(_2a3.length==1){_2a2[key]=this._flatten(_2a3[0]);}else{var _2a4=[];for(var j=0;j<_2a3.length;++j){_2a4.push(this._flatten(_2a3[j]));_2a2[key]=_2a4;}}}}_2a0.items.push(_2a2);}}var _2a5=true;return _25e.toJson(_2a0,_2a5);},_isEmpty:function(_2a6){var _2a7=true;if(lang.isObject(_2a6)){var i;for(i in _2a6){_2a7=false;break;}}else{if(lang.isArray(_2a6)){if(_2a6.length>0){_2a7=false;}}}return _2a7;},save:function(_2a8){this._assert(!this._saveInProgress);this._saveInProgress=true;var self=this;var _2a9=function(){self._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};self._saveInProgress=false;if(_2a8&&_2a8.onComplete){var _2aa=_2a8.scope||_25f.global;_2a8.onComplete.call(_2aa);}};var _2ab=function(err){self._saveInProgress=false;if(_2a8&&_2a8.onError){var _2ac=_2a8.scope||_25f.global;_2a8.onError.call(_2ac,err);}};if(this._saveEverything){var _2ad=this._getNewFileContentString();this._saveEverything(_2a9,_2ab,_2ad);}if(this._saveCustom){this._saveCustom(_2a9,_2ab);}if(!this._saveEverything&&!this._saveCustom){_2a9();}},revert:function(){this._assert(!this._saveInProgress);var _2ae;for(_2ae in this._pending._modifiedItems){var _2af=this._pending._modifiedItems[_2ae];var _2b0=null;if(this._itemsByIdentity){_2b0=this._itemsByIdentity[_2ae];}else{_2b0=this._arrayOfAllItems[_2ae];}_2af[this._storeRefPropName]=this;for(var key in _2b0){delete _2b0[key];}lang.mixin(_2b0,_2af);}var _2b1;for(_2ae in this._pending._deletedItems){_2b1=this._pending._deletedItems[_2ae];_2b1[this._storeRefPropName]=this;var _2b2=_2b1[this._itemNumPropName];if(_2b1["backup_"+this._reverseRefMap]){_2b1[this._reverseRefMap]=_2b1["backup_"+this._reverseRefMap];delete _2b1["backup_"+this._reverseRefMap];}this._arrayOfAllItems[_2b2]=_2b1;if(this._itemsByIdentity){this._itemsByIdentity[_2ae]=_2b1;}if(_2b1[this._rootItemPropName]){this._arrayOfTopLevelItems.push(_2b1);}}for(_2ae in this._pending._deletedItems){_2b1=this._pending._deletedItems[_2ae];if(_2b1["backupRefs_"+this._reverseRefMap]){_25d.forEach(_2b1["backupRefs_"+this._reverseRefMap],function(_2b3){var _2b4;if(this._itemsByIdentity){_2b4=this._itemsByIdentity[_2b3.id];}else{_2b4=this._arrayOfAllItems[_2b3.id];}this._addReferenceToMap(_2b4,_2b1,_2b3.attr);},this);delete _2b1["backupRefs_"+this._reverseRefMap];}}for(_2ae in this._pending._newItems){var _2b5=this._pending._newItems[_2ae];_2b5[this._storeRefPropName]=null;this._arrayOfAllItems[_2b5[this._itemNumPropName]]=null;if(_2b5[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,_2b5);}if(this._itemsByIdentity){delete this._itemsByIdentity[_2ae];}}this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return true;},isDirty:function(item){if(item){var _2b6=this.getIdentity(item);return new Boolean(this._pending._newItems[_2b6]||this._pending._modifiedItems[_2b6]||this._pending._deletedItems[_2b6]).valueOf();}else{return !this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems);}},onSet:function(item,_2b7,_2b8,_2b9){},onNew:function(_2ba,_2bb){},onDelete:function(_2bc){},close:function(_2bd){if(this.clearOnClose){if(!this.isDirty()){this.inherited(arguments);}else{throw new Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");}}}});});},"versa/api/Application":function(){define("versa/api/Application",["dojo/_base/declare","versa/api/DataTypes","versa/api/Operators"],function(_2be){var o=_2be("versa.api.Application",[],{});o._data_types=null;o._operators=null;o.getDataTypes=function(){if(!versa.api.Application._data_types){versa.api.Application._data_types=new versa.api.DataTypes();versa.api.Application._data_types.fetch();}return versa.api.Application._data_types;};o.getOperators=function(){if(!versa.api.Application._operators){versa.api.Application._operators=new versa.api.Operators();versa.api.Application._operators.fetch();}return versa.api.Application._operators;};return o;});},"versa/api/PropertyMappings":function(){define("versa/api/PropertyMappings",["dojo/_base/declare","versa/api/_Collection","versa/api/Error","versa/api/PropertyMapping"],function(_2bf){var o=_2bf("versa.api.PropertyMappings",[versa.api._Collection],{constructor:function(args){this.zone=args.zone;this.library=args.library;this.target=dojo.replace(versa.api.PropertyMappings.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.PropertyMapping.schema;this.cache=true;this._initialize();}});o.getDefault=function(_2c0,_2c1){var _2c2=_2c1.fetchById({id:_2c0.property_definition_id});if(_2c2.isTypeDate()&&_2c0.default_type==versa.api.PropertyMapping.types.date.floating){var date=new Date();date.setDate(date.getDate()+parseInt(_2c0.default_value));return date;}else{if(_2c0.default_value){if(_2c2.isTypeInteger()){return parseInt(_2c0.default_value);}else{if(_2c2.isTypeFloat()){return parseFloat(_2c0.default_value);}}return _2c0.default_value;}}return null;};o.TRGT="/zones/{0}/libraries/{1}/property_mappings";return o;});},"dojox/mobile/ViewController":function(){define("dojox/mobile/ViewController",["dojo/_base/kernel","dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/on","dojo/ready","dijit/registry","./ProgressIndicator","./TransitionEvent"],function(dojo,_2c3,_2c4,_2c5,lang,win,dom,_2c6,_2c7,on,_2c8,_2c9,_2ca,_2cb){var dm=lang.getObject("dojox.mobile",true);var _2cc=_2c5("dojox.mobile.ViewController",null,{constructor:function(){this.viewMap={};this.currentView=null;this.defaultView=null;_2c8(lang.hitch(this,function(){on(win.body(),"startTransition",lang.hitch(this,"onStartTransition"));}));},findCurrentView:function(_2cd,src){if(_2cd){var w=_2c9.byId(_2cd);if(w&&w.getShowingView){return w.getShowingView();}}if(dm.currentView){return dm.currentView;}w=src;while(true){w=w.getParent();if(!w){return null;}if(_2c6.contains(w.domNode,"mblView")){break;}}return w;},onStartTransition:function(evt){evt.preventDefault();if(!evt.detail||(evt.detail&&!evt.detail.moveTo&&!evt.detail.href&&!evt.detail.url&&!evt.detail.scene)){return;}var w=this.findCurrentView(evt.detail.moveTo,(evt.target&&evt.target.id)?_2c9.byId(evt.target.id):_2c9.byId(evt.target));if(!w||(evt.detail&&evt.detail.moveTo&&w===_2c9.byId(evt.detail.moveTo))){return;}if(evt.detail.href){var t=_2c9.byId(evt.target.id).hrefTarget;if(t){dm.openWindow(evt.detail.href,t);}else{w.performTransition(null,evt.detail.transitionDir,evt.detail.transition,evt.target,function(){location.href=evt.detail.href;});}return;}else{if(evt.detail.scene){_2c4.publish("/dojox/mobile/app/pushScene",[evt.detail.scene]);return;}}var _2ce=evt.detail.moveTo;if(evt.detail.url){var id;if(dm._viewMap&&dm._viewMap[evt.detail.url]){id=dm._viewMap[evt.detail.url];}else{var text=this._text;if(!text){if(_2c9.byId(evt.target.id).sync){dojo.xhrGet({url:evt.detail.url,sync:true,load:function(_2cf){text=lang.trim(_2cf);}});}else{var s="dojo/_base/xhr";require([s],lang.hitch(this,function(xhr){var prog=_2ca.getInstance();win.body().appendChild(prog.domNode);prog.start();var obj=xhr.get({url:evt.detail.url,handleAs:"text"});obj.addCallback(lang.hitch(this,function(_2d0,_2d1){prog.stop();if(_2d0){this._text=_2d0;new _2cb(evt.target,{transition:evt.detail.transition,transitionDir:evt.detail.transitionDir,moveTo:_2ce,href:evt.detail.href,url:evt.detail.url,scene:evt.detail.scene},evt.detail).dispatch();}}));obj.addErrback(function(_2d2){prog.stop();});}));return;}}this._text=null;id=this._parse(text,_2c9.byId(evt.target.id).urlTarget);if(!dm._viewMap){dm._viewMap=[];}dm._viewMap[evt.detail.url]=id;}_2ce=id;w=this.findCurrentView(_2ce,_2c9.byId(evt.target.id))||w;}w.performTransition(_2ce,evt.detail.transitionDir,evt.detail.transition,null,null);},_parse:function(text,id){var _2d3,view,i,j,len;var _2d4=this.findCurrentView();var _2d5=_2c9.byId(id)&&_2c9.byId(id).containerNode||dom.byId(id)||_2d4&&_2d4.domNode.parentNode||win.body();var _2d6=null;for(j=_2d5.childNodes.length-1;j>=0;j--){var c=_2d5.childNodes[j];if(c.nodeType===1){if(c.getAttribute("fixed")==="bottom"){_2d6=c;}break;}}if(text.charAt(0)==="<"){_2d3=_2c7.create("DIV",{innerHTML:text});for(i=0;i<_2d3.childNodes.length;i++){var n=_2d3.childNodes[i];if(n.nodeType===1){view=n;break;}}if(!view){return;}view.style.visibility="hidden";_2d5.insertBefore(_2d3,_2d6);var ws=dojo.parser.parse(_2d3);_2c3.forEach(ws,function(w){if(w&&!w._started&&w.startup){w.startup();}});for(i=0,len=_2d3.childNodes.length;i<len;i++){_2d5.insertBefore(_2d3.firstChild,_2d6);}_2d5.removeChild(_2d3);_2c9.byNode(view)._visible=true;}else{if(text.charAt(0)==="{"){_2d3=_2c7.create("DIV");_2d5.insertBefore(_2d3,_2d6);this._ws=[];view=this._instantiate(eval("("+text+")"),_2d3);for(i=0;i<this._ws.length;i++){var w=this._ws[i];w.startup&&!w._started&&(!w.getParent||!w.getParent())&&w.startup();}this._ws=null;}}view.style.display="none";view.style.visibility="visible";return dojo.hash?"#"+view.id:view.id;},_instantiate:function(obj,node,_2d7){var _2d8;for(var key in obj){if(key.charAt(0)=="@"){continue;}var cls=lang.getObject(key);if(!cls){continue;}var _2d9={};var _2da=cls.prototype;var objs=lang.isArray(obj[key])?obj[key]:[obj[key]];for(var i=0;i<objs.length;i++){for(var prop in objs[i]){if(prop.charAt(0)=="@"){var val=objs[i][prop];prop=prop.substring(1);if(typeof _2da[prop]=="string"){_2d9[prop]=val;}else{if(typeof _2da[prop]=="number"){_2d9[prop]=val-0;}else{if(typeof _2da[prop]=="boolean"){_2d9[prop]=(val!="false");}else{if(typeof _2da[prop]=="object"){_2d9[prop]=eval("("+val+")");}}}}}}_2d8=new cls(_2d9,node);if(node){_2d8._visible=true;this._ws.push(_2d8);}if(_2d7&&_2d7.addChild){_2d7.addChild(_2d8);}this._instantiate(objs[i],null,_2d8);}}return _2d8&&_2d8.domNode;}});new _2cc();return _2cc;});},"versa/api/CellDefinitions":function(){define("versa/api/CellDefinitions",["dojo/_base/declare","versa/api/CellDefinition","versa/api/_Collection","versa/api/Error"],function(_2db){var o=_2db("versa.api.CellDefinitions",[versa.api._Collection],{constructor:function(args){this.zone=args.zone;this.library=args.library;this.target=dojo.replace(versa.api.CellDefinitions.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.CellDefinition.schema;this.cache=true;this._initialize();},isValidItem:function(args){var _2dc=this.inherited(arguments);var item=args.item;if(!_2dc){return;}if((!item.width)||(item.width.length<1)){throw new Error("Cell Definition 'Width' property is empty or invalid");}return true;}});o.getDefaultWidth=function(_2dd){var w=128;switch(_2dd){case versa.api.DataTypes.types.VOID:w=18;break;case versa.api.DataTypes.types.BOOLEAN:w=64;break;case versa.api.DataTypes.types.INTEGER:w=64;break;case versa.api.DataTypes.types.FLOAT:w=64;break;case versa.api.DataTypes.types.DATETIME:w=128;break;case versa.api.DataTypes.types.STRING:w=128;break;case versa.api.DataTypes.types.TEXT:w=128;break;}return w;};o.TRGT="/zones/{0}/libraries/{1}/cell_definitions";return o;});},"versa/api/Operator":function(){define("versa/api/Operator",["dojo/_base/declare","dojox/json/ref","versa/api/Error"],function(_2de){var o=_2de("versa.api.Operator",[],{id:null,name:null,value:null,constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));}});o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":""},"value":{type:"string"},"no_rhs":{type:"boolean"}},prototype:new o()};return o;});},"versa/api/Users":function(){define("versa/api/Users",["dojo/_base/declare","versa/api/_Collection","versa/api/User"],function(_2df){var o=_2df("versa.api.Users",[versa.api._Collection],{zone:null,constructor:function(args){this.zone=args.zone;this.target=dojo.replace(versa.api.Users.TRGT,this.zone);this.schema=versa.api.User.schema;this.cache=true;this._initialize();},getAdmin:function(){var _2e0=null;this.forEach(function(item){if(item.is_admin){_2e0=item;}},this);return _2e0;},reset:function(_2e1,_2e2){versa.api.XhrHelper.doPostAction({target:dojo.replace(versa.api.Users.RESET_TRGT,this.zone),postData:{f:_2e1,newPassword:_2e2}});}});o.generatePassword=function(args){var len=args.length;var _2e3="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var _2e4="";for(var i=0;i<len;i++){_2e4+=_2e3.charAt(Math.floor(Math.random()*(_2e3.length)));}return _2e4;};o.TRGT="/zones/{subdomain}/users";o.RESET_TRGT="/zones/{subdomain}/users/reset";return o;});},"versa/widget/mobile/Footing":function(){require(["dojo/_base/declare","dojox/mobile/TabBar","dojox/mobile/TabBarButton"],function(_2e5){_2e5("versa.widget.mobile.Footing",[dijit._WidgetBase,dojox.mobile.TabBar],{barType:"segmentedControl",center:true,fixed:"bottom",showRoot:true,showSearch:true,reference:null,constructor:function(args){this.inherited("constructor",arguments);},postCreate:function(args){this.inherited("postCreate",arguments);if(this.showRoot){this.footerRootButton=new dojox.mobile.TabBarButton({label:"Root",from:this.from,onCommand:this.onCommand,onClick:function(){this.onCommand(versa.widget.zone.mobile.Show.COMMANDS.SHOW_ROOT,{from:this.from});this.set("selected",false);}},dojo.create("div"));this.addChild(this.footerRootButton);}if(this.reference){this.footerViewButton=new dojox.mobile.TabBarButton({label:"View",onCommand:this.onCommand,reference:this.reference,onClick:function(){this.onCommand(versa.widget.zone.mobile.Show.COMMANDS.SHOW_DOCUMENT_CONTENT,{reference:this.reference});this.set("selected",false);}},dojo.create("div"));this.addChild(this.footerViewButton);}if(this.showSearch){this.footerSearchButton=new dojox.mobile.TabBarButton({label:"Search",from:this.from,onCommand:this.onCommand,onClick:function(){this.onCommand(versa.widget.zone.mobile.Show.COMMANDS.SHOW_SEARCH,{from:this.from});this.set("selected",false);}},dojo.create("div"));this.addChild(this.footerSearchButton);}}});});},"dojo/cache":function(){define("dojo/cache",["./_base/kernel","./text"],function(dojo,text){return dojo.cache;});},"versa/api/PermissionSet":function(){define("versa/api/PermissionSet",["dojo/_base/declare"],function(_2e6){var o=_2e6("versa.api.PermissionSet",[],{_values:null,constructor:function(args){var seed=(args)?args:false;this._values=new Array();for(var p in versa.api.PermissionIndices){var idx=versa.api.PermissionIndices[p];this._values[idx]=seed;}},andSet:function(_2e7){var _2e8=new versa.api.PermissionSet(true);for(var p in versa.api.PermissionIndices){var idx=versa.api.PermissionIndices[p];_2e8._values[idx]=(this._values[idx]&&_2e7._values[idx]);}return _2e8;},orSet:function(_2e9){var _2ea=new versa.api.PermissionSet();for(var p in versa.api.PermissionIndices){var idx=versa.api.PermissionIndices[p];_2ea._values[idx]=(this._values[idx]||_2e9._values[idx]);}return _2ea;},getValue:function(_2eb){return this._values[_2eb];},setValue:function(_2ec,_2ed){this._values[_2ec]=_2ed;}});versa.api.PermissionIndices={"CREATE":0,"VIEW":1,"COPY":2,"EDIT":3,"MOVE":4,"CKO":5,"CKI":6,"CANCEL_CKO":7,"VERSION":8,"DELETE":9,"SECURE":10,"RESTORE":11,"DESTROY":12};return o;});},"versa/api/ChoiceList":function(){define("versa/api/ChoiceList",["dojo/_base/declare","versa/api/_Object"],function(_2ee){var o=_2ee("versa.api.ChoiceList",[versa.api._Object],{constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},isValid:function(){var _2ef=true;if(String.isEmpty(this.name.trim())){_2ef=false;}if((!this.data_type_id)||(this.data_type_id<1)){_2ef=false;}return _2ef;}});o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":"Property"},"data_type_id":{type:"integer"},"choice_values":{type:"array","default":[],items:{type:"object",properties:{"sort_order":{type:"integer"},"name":{type:"string"},"value":{type:"string"}}}},"created_at":{type:"string",format:"date-time","default":dojo.date.stamp.toISOString(new Date(),{zulu:true})},"created_by":{type:"string","default":""},"updated_at":{type:"string",format:"date-time","default":dojo.date.stamp.toISOString(new Date(),{zulu:true})},"updated_by":{type:"string","default":""}},prototype:new o()};return o;});},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(dojo){return dojo.dojox;});},"dojo/text":function(){define("dojo/text",["./_base/kernel","require","./has","./_base/xhr"],function(dojo,_2f0,has,xhr){var _2f1;if(1){_2f1=function(url,sync,load){xhr("GET",{url:url,sync:!!sync,load:load});};}else{if(_2f0.getText){_2f1=_2f0.getText;}else{}}var _2f2={},_2f3=function(text){if(text){text=text.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var _2f4=text.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);if(_2f4){text=_2f4[1];}}else{text="";}return text;},_2f5={},_2f6={},_2f7={dynamic:true,normalize:function(id,_2f8){var _2f9=id.split("!"),url=_2f9[0];return (/^\./.test(url)?_2f8(url):url)+(_2f9[1]?"!"+_2f9[1]:"");},load:function(id,_2fa,load){var _2fb=id.split("!"),_2fc=_2fb.length>1,_2fd=_2fb[0],url=_2fa.toUrl(_2fb[0]),text=_2f5,_2fe=function(text){load(_2fc?_2f3(text):text);};if(_2fd in _2f2){text=_2f2[_2fd];}else{if(url in _2fa.cache){text=_2fa.cache[url];}else{if(url in _2f2){text=_2f2[url];}}}if(text===_2f5){if(_2f6[url]){_2f6[url].push(_2fe);}else{var _2ff=_2f6[url]=[_2fe];_2f1(url,!_2fa.async,function(text){_2f2[_2fd]=_2f2[url]=text;for(var i=0;i<_2ff.length;){_2ff[i++](text);}delete _2f6[url];});}}else{_2fe(text);}}};dojo.cache=function(_300,url,_301){var key;if(typeof _300=="string"){if(/\//.test(_300)){key=_300;_301=url;}else{key=_2f0.toUrl(_300.replace(/\./g,"/")+(url?("/"+url):""));}}else{key=_300+"";_301=url;}var val=(_301!=undefined&&typeof _301!="string")?_301.value:_301,_302=_301&&_301.sanitize;if(typeof val=="string"){_2f2[key]=val;return _302?_2f3(val):val;}else{if(val===null){delete _2f2[key];return null;}else{if(!(key in _2f2)){_2f1(key,true,function(text){_2f2[key]=text;});}return _302?_2f3(_2f2[key]):_2f2[key];}}};return _2f7;});},"versa/api/Error":function(){define("versa/api/Error",["dojo/_base/declare"],function(_303){return _303("versa.api.Error",[],{status:400,message:"",innerMessage:"",err:null,name:null,lineNumber:-1,fileName:null,stack:null,constructor:function(_304,err){this.message=_304;this.err=err;if(this.err){if(this.err.hasOwnProperty("status")){this.status=this.err.status;}if(this.err.hasOwnProperty("responseText")){this.innerMessage=this.err.responseText;}else{if(this.err.hasOwnProperty("message")){this.innerMessage=this.err.message;}else{if(this.err.hasOwnProperty("description")){this.innerMessage=this.err.description;}}}}},getContent:function(_305){var msg=this.message;if((_305)&&(this.innerMessage)){msg+=":<br>"+this.innerMessage;}return msg;},getMessage:function(_306){var msg=this.message;if((_306)&&(this.innerMessage)){msg+=":\n"+this.innerMessage;}return msg;}});});},"versa/api/Utilities":function(){define("versa/api/Utilities",["dojo/_base/declare"],function(_307){var o=_307("versa.api.Utilities",[],{});o.uniqueIdBase=(new Date()).getTime();o.randomNumber=function(args){var l=args.lowerBound;var u=args.upperBound;return (Math.floor(Math.random()*(u-l))+l);};o.readablizeBytes=function(args){var _308="";var _309=args.bytes;if((_309==null)||(_309==Number.NaN)){return "???";}if(_309<1){return "0 bytes";}var s=["bytes","KB","MB","GB","TB","PB"];var e=Math.floor(Math.log(_309)/Math.log(1024));if(e>0){_308=(_309/Math.pow(1024,Math.floor(e))).toFixed(2)+" "+s[e];}else{_308=(_309/Math.pow(1024,Math.floor(e))).toFixed(0)+" "+s[e];}return _308;};o.readabilizeSeconds=function(args){var s=args.seconds;var d=Number(s);var h=Math.floor(d/3600);var m=Math.floor(d%3600/60);var s=Math.floor(d%3600%60);return ((h>0?h+":":"")+(m>0?(h>0&&m<10?"0":"")+m+":":"0:")+(s<10?"0":"")+s);};o.generateUniqueId=function(args){return versa.api.Utilities.uniqueIdBase++;};o.isArray=function(arr){return arr.constructor==Array;};o.generateUniqueName=function(args){var _30a=args.names;var _30b=args.base_name;var _30c=(args.appendix)?args.appendix:"({index})";var _30d=_30b;var i=0;while(++i){var idx=dojo.indexOf(_30a,_30d);if(idx<0){break;}_30d=dojo.replace("{baseName}"+_30c,{baseName:_30b,index:i});}return _30d;};o.getFileExtension=function(args){var _30e=args.file_name;var pos=_30e.lastIndexOf(".");if(pos<1){return "";}return _30e.substring(pos);};o.getFileName=function(args){var _30f=args.file_name;var pos=_30f.lastIndexOf(".");if(pos<1){return _30f;}return _30f.substring(0,pos);};o.saveUrl=function(args){var url=args.url;var _310=args.window_name;var _311=dojo.string.substitute("width=10,height=10,top=-20,left=-20,toolbar=0,resizable=1,location=0,directories=0,status=0,menubar=0",[]);window.location.href=url;};o.getBox=function(args){var _312=dojo.window.getBox();var _313=_312.w;var _314=_312.h;var winW=_313*args.scale;var winH=_314*args.scale;var winT=(_314/2)-(winH/2);var winL=(_313/2)-(winW/2);return {w:winW,h:winH,t:winT,l:winL};};o.getFormatStore=function(){var _315=[{id:versa.api.DataTypes.types.BOOLEAN+":"+versa.api.CellDefinition.formats.none,format_id:versa.api.CellDefinition.formats.none,data_type_id:versa.api.DataTypes.types.BOOLEAN,name:"None"},{id:versa.api.DataTypes.types.DATETIME+":"+versa.api.CellDefinition.formats.none,format_id:versa.api.CellDefinition.formats.none,data_type_id:versa.api.DataTypes.types.DATETIME,name:"None"},{id:versa.api.DataTypes.types.DATETIME+":"+versa.api.CellDefinition.formats.datetime,format_id:versa.api.CellDefinition.formats.datetime,data_type_id:versa.api.DataTypes.types.DATETIME,name:"Date"},{id:versa.api.DataTypes.types.FLOAT+":"+versa.api.CellDefinition.formats.none,format_id:versa.api.CellDefinition.formats.none,data_type_id:versa.api.DataTypes.types.FLOAT,name:"None"},{id:versa.api.DataTypes.types.INTEGER+":"+versa.api.CellDefinition.formats.none,format_id:versa.api.CellDefinition.formats.none,data_type_id:versa.api.DataTypes.types.INTEGER,name:"None"},{id:versa.api.DataTypes.types.INTEGER+":"+versa.api.CellDefinition.formats.size,format_id:versa.api.CellDefinition.formats.size,data_type_id:versa.api.DataTypes.types.INTEGER,name:"File Size"},{id:versa.api.DataTypes.types.STRING+":"+versa.api.CellDefinition.formats.none,format_id:versa.api.CellDefinition.formats.none,data_type_id:versa.api.DataTypes.types.STRING,name:"None"},{id:versa.api.DataTypes.types.TEXT+":"+versa.api.CellDefinition.formats.none,format_id:versa.api.CellDefinition.formats.none,data_type_id:versa.api.DataTypes.types.TEXT,name:"None"}];return new versa.api.ItemFileWriteStore({data:{identifier:"id",label:"name",items:_315}});};o.viewUrl=function(args){var box=args.windowBox;var url=args.url;var _316=args.window_name;var _317=dojo.string.substitute("width=${0},height=${1},top=${2},left=${3},toolbar=0,resizable=1,location=0,directories=0,status=0,menubar=0,scrollbars=1",[box.w,box.h,box.t,box.l]);if(!dojo.isIE){var win=window.open(url,_316,_317);win.focus();}else{var win=window.open(url,"_blank",_317);win.focus();}};o.iePdfPluginInstalled=function(){if(window.ActiveXObject){var _318=null;try{_318=new ActiveXObject("AcroPDF.PDF");}catch(e){}if(!_318){try{_318=new ActiveXObject("PDF.PdfCtrl");}catch(e){}}if(_318){return true;}}return false;};o.formatDate=function(date){var _319=(date.getUTCMonth()+1).toString();var _31a=date.getUTCDate().toString();var _31b=date.getUTCHours().toString();_319=_319.length==1?"0"+_319:_319;_31a=_31a.length==1?"0"+_31a:_31a;_31b=_31b.length==1?"0"+_31b:_31b;return date.getUTCFullYear()+"-"+_319+"-"+_31a+"T"+_31b+":00:00Z";};o.validateEmail=function(str){var _31c=str.lastIndexOf("@");if(_31c<1){return false;}if(_31c==str.length-1){return false;}if(_31c>64){return false;}if(str.length-_31c>255){return false;}var _31d=str.lastIndexOf(".");if(_31d>_31c+1&&_31d<str.length-1){return true;}if(str.charAt(_31c+1)=="["&&str.charAt(str.length-1)=="]"){return true;}return false;};return o;});},"versa/widget/folder/mobile/FolderView":function(){require(["dojo/_base/declare","dijit/_WidgetBase","dojox/mobile/Heading","dojox/mobile/ScrollableView","dojox/mobile/EdgeToEdgeDataList","dojox/mobile/ToolBarButton","versa/api/Folders","versa/api/Documents","versa/api/Zones","dojo/data/ItemFileWriteStore"],function(_31e){_31e("versa.widget.folder.mobile.FolderView",[dijit._WidgetBase,dojox.mobile.ScrollableView],{folder:null,library:null,folders:null,references:null,folderStore:null,refStore:null,etedlMain:null,header:null,footer:null,constructor:function(args){},postCreate:function(){this.inherited("postCreate",arguments);this.folders=this.library.getFolders();this.references=this.library.getReferences();this.folderStore=this.folders.store;this.refStore=this.references.store;this.folderStore.clearCache();var _31f=this.folderStore.fetch({query:{parent_id:this.folder.id}}).results;var _320=this.refStore.fetch({query:{type:1,query:this.folder.id,view:this.folder.view_definition_id}}).results;var _321=[];dojo.forEach(_31f,function(_322){if(!(_322.isSearch()||_322.isTrash()||_322.isShareRoot())){_321.push({label:_322.name,item:_322,parent:this.folder,onCommand:this.onCommand,icon:"../../images/icons/32/folder.png",clickable:true,onClick:function(){this.onCommand(versa.widget.zone.mobile.Show.COMMANDS.SHOW_FOLDER,{parent:this.parent,folder:this.item});}});}},this);dojo.forEach(_320,function(_323){_321.push({label:_323.name,item:_323,from:this,onCommand:this.onCommand,icon:"../../images/mimetypes/32/default.png",clickable:true,onClick:function(){this.onCommand(versa.widget.zone.mobile.Show.COMMANDS.SHOW_DOCUMENT_PROPERTIES,{from:this.from,reference:this.item});}});},this);var _324={items:_321};var _325=new dojo.data.ItemFileWriteStore({data:_324});this.header=new versa.widget.mobile.Heading({label:this.folder.name,from:this,back:this.back,onCommand:this.onCommand});this.footer=new versa.widget.mobile.Footing({showRoot:!this.folder.isRoot(),onCommand:this.onCommand,from:this});this.etedlMain=new dojox.mobile.EdgeToEdgeDataList({store:_325,iconBase:"../../images/mimetypes/48/default.png"});this.addChild(this.header);this.addChild(this.footer);this.addChild(this.etedlMain);},startup:function(){this.inherited("startup",arguments);this.etedlMain.startup();}});});},"dojox/mobile/ListItem":function(){define("dojox/mobile/ListItem",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/has","./common","./_ItemBase","./TransitionEvent"],function(_326,_327,_328,lang,_329,_32a,has,_32b,_32c,_32d){return _328("dojox.mobile.ListItem",_32c,{rightText:"",rightIcon:"",rightIcon2:"",anchorLabel:false,noArrow:false,selected:false,checked:false,arrowClass:"mblDomButtonArrow",checkClass:"mblDomButtonCheck",variableHeight:false,rightIconTitle:"",rightIcon2Title:"",btnClass:"",btnClass2:"",tag:"li",postMixInProperties:function(){if(this.btnClass){this.rightIcon=this.btnClass;}this._setBtnClassAttr=this._setRightIconAttr;this._setBtnClass2Attr=this._setRightIcon2Attr;},buildRendering:function(){this.domNode=this.srcNodeRef||_32a.create(this.tag);this.inherited(arguments);this.domNode.className="mblListItem"+(this.selected?" mblItemSelected":"");var box=this.box=_32a.create("DIV");box.className="mblListItemTextBox";if(this.anchorLabel){box.style.cursor="pointer";}var r=this.srcNodeRef;if(r&&!this.label){this.label="";for(var i=0,len=r.childNodes.length;i<len;i++){var n=r.firstChild;if(n.nodeType===3&&lang.trim(n.nodeValue)!==""){n.nodeValue=this._cv?this._cv(n.nodeValue):n.nodeValue;this.labelNode=_32a.create("SPAN",{className:"mblListItemLabel"});this.labelNode.appendChild(n);n=this.labelNode;}box.appendChild(n);}}if(!this.labelNode){this.labelNode=_32a.create("SPAN",{className:"mblListItemLabel"},box);}if(this.anchorLabel){box.style.display="inline";}var a=this.anchorNode=_32a.create("A");a.className="mblListItemAnchor";this.domNode.appendChild(a);a.appendChild(box);},startup:function(){if(this._started){return;}this.inheritParams();var _32e=this.getParent();if(this.moveTo||this.href||this.url||this.clickable||(_32e&&_32e.select)){this._onClickHandle=this.connect(this.anchorNode,"onclick","onClick");}this.setArrow();if(_329.contains(this.domNode,"mblVariableHeight")){this.variableHeight=true;}if(this.variableHeight){_329.add(this.domNode,"mblVariableHeight");setTimeout(lang.hitch(this,"layoutVariableHeight"));}this.set("icon",this.icon);if(!this.checked&&this.checkClass.indexOf(",")!==-1){this.set("checked",this.checked);}this.inherited(arguments);},resize:function(){if(this.variableHeight){this.layoutVariableHeight();}},onClick:function(e){var a=e.currentTarget;var li=a.parentNode;if(_329.contains(li,"mblItemSelected")){return;}if(this.anchorLabel){for(var p=e.target;p.tagName!==this.tag.toUpperCase();p=p.parentNode){if(p.className=="mblListItemTextBox"){_329.add(p,"mblListItemTextBoxSelected");setTimeout(function(){_329.remove(p,"mblListItemTextBoxSelected");},has("android")?300:1000);this.onAnchorLabelClicked(e);return;}}}var _32f=this.getParent();if(_32f.select){if(_32f.select==="single"){if(!this.checked){this.set("checked",true);}}else{if(_32f.select==="multiple"){this.set("checked",!this.checked);}}}this.select();if(this.href&&this.hrefTarget){_32b.openWindow(this.href,this.hrefTarget);return;}var _330;if(this.moveTo||this.href||this.url||this.scene){_330={moveTo:this.moveTo,href:this.href,url:this.url,scene:this.scene,transition:this.transition,transitionDir:this.transitionDir};}else{if(this.transitionOptions){_330=this.transitionOptions;}}if(_330){this.setTransitionPos(e);return new _32d(this.domNode,_330,e).dispatch();}},select:function(){var _331=this.getParent();if(_331.stateful){_331.deselectAll();}else{var _332=this;setTimeout(function(){_332.deselect();},has("android")?300:1000);}_329.add(this.domNode,"mblItemSelected");},deselect:function(){_329.remove(this.domNode,"mblItemSelected");},onAnchorLabelClicked:function(e){},layoutVariableHeight:function(){var h=this.anchorNode.offsetHeight;if(h===this.anchorNodeHeight){return;}this.anchorNodeHeight=h;_326.forEach([this.rightTextNode,this.rightIcon2Node,this.rightIconNode,this.iconNode],function(n){if(n){var t=Math.round((h-n.offsetHeight)/2);n.style.marginTop=t+"px";}});},setArrow:function(){if(this.checked){return;}var c="";var _333=this.getParent();if(this.moveTo||this.href||this.url||this.clickable){if(!this.noArrow&&!(_333&&_333.stateful)){c=this.arrowClass;}}if(c){this._setRightIconAttr(c);}},_setIconAttr:function(icon){if(!this.getParent()){return;}this.icon=icon;var a=this.anchorNode;if(!this.iconNode){if(icon){var ref=this.rightIconNode||this.rightIcon2Node||this.rightTextNode||this.box;this.iconNode=_32a.create("DIV",{className:"mblListItemIcon"},ref,"before");}}else{_32a.empty(this.iconNode);}if(icon&&icon!=="none"){_32b.createIcon(icon,this.iconPos,null,this.alt,this.iconNode);if(this.iconPos){_329.add(this.iconNode.firstChild,"mblListItemSpriteIcon");}_329.remove(a,"mblListItemAnchorNoIcon");}else{_329.add(a,"mblListItemAnchorNoIcon");}},_setCheckedAttr:function(_334){var _335=this.getParent();if(_335&&_335.select==="single"&&_334){_326.forEach(_335.getChildren(),function(_336){_336.set("checked",false);});}this._setRightIconAttr(this.checkClass);var _337=this.rightIconNode.childNodes;if(_337.length===1){this.rightIconNode.style.display=_334?"":"none";}else{_337[0].style.display=_334?"":"none";_337[1].style.display=!_334?"":"none";}_329.toggle(this.domNode,"mblListItemChecked",_334);if(_335&&this.checked!==_334){_335.onCheckStateChanged(this,_334);}this.checked=_334;},_setRightTextAttr:function(text){if(!this.rightTextNode){this.rightTextNode=_32a.create("DIV",{className:"mblListItemRightText"},this.box,"before");}this.rightText=text;this.rightTextNode.innerHTML=this._cv?this._cv(text):text;},_setRightIconAttr:function(icon){if(!this.rightIconNode){var ref=this.rightIcon2Node||this.rightTextNode||this.box;this.rightIconNode=_32a.create("DIV",{className:"mblListItemRightIcon"},ref,"before");}else{_32a.empty(this.rightIconNode);}this.rightIcon=icon;var arr=(icon||"").split(/,/);if(arr.length===1){_32b.createIcon(icon,null,null,this.rightIconTitle,this.rightIconNode);}else{_32b.createIcon(arr[0],null,null,this.rightIconTitle,this.rightIconNode);_32b.createIcon(arr[1],null,null,this.rightIconTitle,this.rightIconNode);}},_setRightIcon2Attr:function(icon){if(!this.rightIcon2Node){var ref=this.rightTextNode||this.box;this.rightIcon2Node=_32a.create("DIV",{className:"mblListItemRightIcon2"},ref,"before");}else{_32a.empty(this.rightIcon2Node);}this.rightIcon2=icon;_32b.createIcon(icon,null,null,this.rightIcon2Title,this.rightIcon2Node);},_setLabelAttr:function(text){this.label=text;this.labelNode.innerHTML=this._cv?this._cv(text):text;}});});},"dojo/cldr/nls/gregorian":function(){define("dojo/cldr/nls/gregorian",{root:{"months-format-narrow":["1","2","3","4","5","6","7","8","9","10","11","12"],"quarters-standAlone-narrow":["1","2","3","4"],"field-weekday":"Day of the Week","dateFormatItem-yQQQ":"y QQQ","dateFormatItem-yMEd":"EEE, y-M-d","dateFormatItem-MMMEd":"E MMM d","eraNarrow":["BCE","CE"],"dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","dateFormat-long":"y MMMM d","months-format-wide":["1","2","3","4","5","6","7","8","9","10","11","12"],"dateTimeFormat-medium":"{1} {0}","dateFormatItem-EEEd":"d EEE","dayPeriods-format-wide-pm":"PM","dateFormat-full":"EEEE, y MMMM dd","dateFormatItem-Md":"M-d","dayPeriods-format-abbr-am":"AM","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","field-era":"Era","dateFormatItem-yM":"y-M","months-standAlone-wide":["1","2","3","4","5","6","7","8","9","10","11","12"],"timeFormat-short":"HH:mm","quarters-format-wide":["Q1","Q2","Q3","Q4"],"timeFormat-long":"HH:mm:ss z","field-year":"Year","dateFormatItem-yMMM":"y MMM","dateFormatItem-yQ":"y Q","dateTimeFormats-appendItem-Era":"{0} {1}","field-hour":"Hour","months-format-abbr":["1","2","3","4","5","6","7","8","9","10","11","12"],"timeFormat-full":"HH:mm:ss zzzz","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","field-day-relative+0":"Today","field-day-relative+1":"Tomorrow","dateFormatItem-H":"HH","months-standAlone-abbr":["1","2","3","4","5","6","7","8","9","10","11","12"],"quarters-format-abbr":["Q1","Q2","Q3","Q4"],"quarters-standAlone-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-M":"L","days-standAlone-wide":["1","2","3","4","5","6","7"],"timeFormat-medium":"HH:mm:ss","dateFormatItem-Hm":"HH:mm","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],"eraAbbr":["BCE","CE"],"field-minute":"Minute","field-dayperiod":"Dayperiod","days-standAlone-abbr":["1","2","3","4","5","6","7"],"dateFormatItem-d":"d","dateFormatItem-ms":"mm:ss","quarters-format-narrow":["1","2","3","4"],"field-day-relative+-1":"Yesterday","dateFormatItem-h":"h a","dateTimeFormat-long":"{1} {0}","dayPeriods-format-narrow-am":"AM","dateFormatItem-MMMd":"MMM d","dateFormatItem-MEd":"E, M-d","dateTimeFormat-full":"{1} {0}","field-day":"Day","days-format-wide":["1","2","3","4","5","6","7"],"field-zone":"Zone","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","dateFormatItem-y":"y","months-standAlone-narrow":["1","2","3","4","5","6","7","8","9","10","11","12"],"dateFormatItem-hm":"h:mm a","dateTimeFormats-appendItem-Year":"{0} {1}","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","dayPeriods-format-abbr-pm":"PM","days-format-abbr":["1","2","3","4","5","6","7"],"eraNames":["BCE","CE"],"days-format-narrow":["1","2","3","4","5","6","7"],"days-standAlone-narrow":["1","2","3","4","5","6","7"],"dateFormatItem-MMM":"LLL","field-month":"Month","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","dayPeriods-format-wide-am":"AM","dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormat-short":"yyyy-MM-dd","field-second":"Second","dateFormatItem-yMMMEd":"EEE, y MMM d","dateTimeFormats-appendItem-Timezone":"{0} {1}","field-week":"Week","dateFormat-medium":"y MMM d","dayPeriods-format-narrow-pm":"PM","dateTimeFormat-short":"{1} {0}","dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-hms":"h:mm:ss a"},"ar":true,"ca":true,"cs":true,"da":true,"de":true,"el":true,"en":true,"en-au":true,"en-ca":true,"en-gb":true,"es":true,"fi":true,"fr":true,"fr-ch":true,"he":true,"hu":true,"it":true,"ja":true,"ko":true,"nb":true,"nl":true,"pl":true,"pt":true,"pt-pt":true,"ro":true,"ru":true,"sk":true,"sl":true,"sv":true,"th":true,"tr":true,"zh":true,"zh-hant":true,"zh-hk":true,"zh-tw":true});},"versa/widget/zone/mobile/LogonView":function(){define("versa/widget/zone/mobile/LogonView",["dojo/_base/declare","dijit/_Widget","dijit/_TemplatedMixin","dijit/form/Form","versa/api/User","dojox/mobile/Button","dojox/mobile/ScrollableView","dojox/mobile/ContentPane","versa/widget/mobile/TextBox","dojox/mobile/Heading"],function(_338){var o=_338("versa.widget.zone.mobile.LogonView",[dijit._WidgetBase,dojox.mobile.ScrollableView],{_btnReset:null,_btnSubmit:null,_frmLogon:null,_txtEmail:null,_txtPassword:null,_txtResetName:null,_txtUserName:null,user:null,zone:null,_onResetClick:function(e){var a1=dojo.fadeOut({node:this.logonNode,duration:500,onEnd:dojo.hitch(this,function(){dojo.toggleClass(this.logonNode,"versaHide",true);dojo.toggleClass(this.resetNode,"versaHide",false);var _339=this._txtUsername.get("value");this._txtResetName.set("value",_339);})});var a2=dojo.fadeIn({node:this.resetNode,duration:500,onEnd:dojo.hitch(this,function(){this._btnReset.set("disabled",true);this._txtResetName.blur();this._txtResetName.validate();this._txtEmail.blur();this._txtEmail.validate();this._txtResetName.focus();this._btnReset.set("disabled",false);})});dojo.fx.chain([a1,a2]).play();},_onReturnClick:function(e){var a1=dojo.fadeOut({node:this.resetNode,duration:500,onEnd:dojo.hitch(this,function(){dojo.toggleClass(this.logonNode,"versaHide",false);dojo.toggleClass(this.resetNode,"versaHide",true);})});var a2=dojo.fadeIn({node:this.logonNode,duration:500,onEnd:dojo.hitch(this,function(){this._txtPassword.reset();this._txtUsername.setFocus();})});dojo.fx.chain([a1,a2]).play();},_onResetSubmit:function(e){try{if(this._frmReset.validate()){var _33a=this._txtResetName.get("value");var _33b=this._txtEmail.get("value");this.zone.resetPassword(_33a,_33b);this.onReset(_33a);this._txtUsername.set("value",_33a);}}catch(e){this.onResetError(e);this._txtResetName.reset();this._txtEmail.reset();this._txtResetName.setFocus();}finally{e.preventDefault();}},_onLogonSubmit:function(e){try{if(this._frmLogon.isValid()){var _33c=this._txtUsername.get("value");var _33d=this._txtPassword.get("value");var user=this.zone.logon(_33c,_33d);this.onLogon(user);}else{this._txtUsername.validate();}}catch(e){this.onError(e);this._txtPassword.reset();this._txtUsername.setFocus(true);}finally{e.preventDefault();}},constructor:function(args){},onError:function(e){},onLogon:function(user){},onReset:function(_33e){},onResetError:function(e){},postCreate:function(){this.inherited("postCreate",arguments);this.heading=new dojox.mobile.Heading({fixed:"top"});this.heading.domNode.innerHTML="<img src=\"/images/versafile-32-tm.png\"/>";this.addChild(this.heading);this.cpContent=new dojox.mobile.ContentPane({content:dojo.cache("versa.widget.zone.mobile","template/Logon.html","<div align=\"center\">\n    <div id=\"logonFormNode\">\n\n        <div>\n            <div>Username</div>\n            <input id=\"userNameNode\"/>\n        </div>\n\n        <div>\n            <div>Password</div>\n            <input id=\"passwordNode\"/>\n        </div>\n\n        <table id=\"statusNode\">\n            <tr>\n                <td style=\"vertical-align:top;\">\n                    <img id=\"statusImgNode\" src=\"/images/icons/16/blank.png\" width=\"16\" height=\"16\" style=\"float:right;margin-right:8px\"/>\n                </td>\n                <td>\n                    <span id=\"statusMsgNode\"></span>\n                </td>\n            </tr>\n        </table>\n\n        <div>\n            <button id=\"logonButtonNode\" type=\"submit\"></button>\n        </div>\n\n    </div>\n</div>\n")});this.addChild(this.cpContent);this._frmLogon=new dijit.form.Form({onSubmit:dojo.hitch(this,this._onLogonSubmit)},"logonFormNode");this._txtUsername=new versa.widget.mobile.TextBox({name:"txtUsername",required:true,missingMessage:"Username is required",value:(this.user==null)?null:this.user.name,disabled:(this.user!=null),style:"width:160px"},"userNameNode");this._txtPassword=new versa.widget.mobile.TextBox({name:"txtPassword",required:false,type:"password",style:"width:160px"},"passwordNode");this._btnSubmit=new dojox.mobile.Button({iconClass:"buttonIcon bfreeIconLock",label:"Log in",type:"submit"},"logonButtonNode");this._txtUsername.focus();},startup:function(){this.inherited("startup",arguments);}});o.STS_CODES={"ERR":0,"OK":1};o.ERR_MESSAGE="Error: <b>{message}</b>";o.OK_MESSAGE="Success: <b>Logged in as user '{name}'.</b>";return o;});},"dojo/uacss":function(){define("dojo/uacss",["./dom-geometry","./_base/lang","./ready","./_base/sniff","./_base/window"],function(_33f,lang,_340,has,_341){var html=_341.doc.documentElement,ie=has("ie"),_342=has("opera"),maj=Math.floor,ff=has("ff"),_343=_33f.boxModel.replace(/-/,""),_344={"dj_ie":ie,"dj_ie6":maj(ie)==6,"dj_ie7":maj(ie)==7,"dj_ie8":maj(ie)==8,"dj_ie9":maj(ie)==9,"dj_quirks":has("quirks"),"dj_iequirks":ie&&has("quirks"),"dj_opera":_342,"dj_khtml":has("khtml"),"dj_webkit":has("webkit"),"dj_safari":has("safari"),"dj_chrome":has("chrome"),"dj_gecko":has("mozilla"),"dj_ff3":maj(ff)==3};_344["dj_"+_343]=true;var _345="";for(var clz in _344){if(_344[clz]){_345+=clz+" ";}}html.className=lang.trim(html.className+" "+_345);_340(90,function(){if(!_33f.isBodyLtr()){var _346="dj_rtl dijitRtl "+_345.replace(/ /g,"-rtl ");html.className=lang.trim(html.className+" "+_346+"dj_rtl dijitRtl "+_345.replace(/ /g,"-rtl "));}});return has;});},"dojox/mobile/_DataListMixin":function(){define("dojox/mobile/_DataListMixin",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","dijit/registry","./ListItem"],function(_347,_348,_349,lang,_34a,_34b){return _349("dojox.mobile._DataListMixin",null,{store:null,query:null,queryOptions:null,buildRendering:function(){this.inherited(arguments);if(!this.store){return;}var _34c=this.store;this.store=null;this.setStore(_34c,this.query,this.queryOptions);},setStore:function(_34d,_34e,_34f){if(_34d===this.store){return;}this.store=_34d;this.query=_34e;this.queryOptions=_34f;if(_34d&&_34d.getFeatures()["dojo.data.api.Notification"]){_347.forEach(this._conn||[],_348.disconnect);this._conn=[_348.connect(_34d,"onSet",this,"onSet"),_348.connect(_34d,"onNew",this,"onNew"),_348.connect(_34d,"onDelete",this,"onDelete")];}this.refresh();},refresh:function(){if(!this.store){return;}this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:lang.hitch(this,"onComplete"),onError:lang.hitch(this,"onError")});},createListItem:function(item){var attr={};var arr=this.store.getLabelAttributes(item);var _350=arr?arr[0]:null;_347.forEach(this.store.getAttributes(item),function(name){if(name===_350){attr["label"]=this.store.getLabel(item);}else{attr[name]=this.store.getValue(item,name);}},this);var w=new _34b(attr);item._widgetId=w.id;return w;},generateList:function(_351,_352){_347.forEach(this.getChildren(),function(_353){_353.destroyRecursive();});_347.forEach(_351,function(item,_354){this.addChild(this.createListItem(item));},this);},onComplete:function(_355,_356){this.generateList(_355,_356);},onError:function(_357,_358){},onSet:function(item,_359,_35a,_35b){},onNew:function(_35c,_35d){this.addChild(this.createListItem(_35c));},onDelete:function(_35e){_34a.byId(_35e._widgetId).destroyRecursive();}});});},"dojo/string":function(){define("dojo/string",["./_base/kernel","./_base/lang"],function(dojo,lang){lang.getObject("string",true,dojo);dojo.string.rep=function(str,num){if(num<=0||!str){return "";}var buf=[];for(;;){if(num&1){buf.push(str);}if(!(num>>=1)){break;}str+=str;}return buf.join("");};dojo.string.pad=function(text,size,ch,end){if(!ch){ch="0";}var out=String(text),pad=dojo.string.rep(ch,Math.ceil((size-out.length)/ch.length));return end?out+pad:pad+out;};dojo.string.substitute=function(_35f,map,_360,_361){_361=_361||dojo.global;_360=_360?lang.hitch(_361,_360):function(v){return v;};return _35f.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(_362,key,_363){var _364=lang.getObject(key,false,map);if(_363){_364=lang.getObject(_363,false,_361).call(_361,_364,key);}return _360(_364,key).toString();});};dojo.string.trim=String.prototype.trim?lang.trim:function(str){str=str.replace(/^\s+/,"");for(var i=str.length-1;i>=0;i--){if(/\S/.test(str.charAt(i))){str=str.substring(0,i+1);break;}}return str;};return dojo.string;});},"dijit/form/_FormValueMixin":function(){define("dijit/form/_FormValueMixin",["dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/sniff","./_FormWidgetMixin"],function(_365,_366,keys,has,_367){return _365("dijit.form._FormValueMixin",_367,{readOnly:false,_setReadOnlyAttr:function(_368){_366.set(this.focusNode,"readOnly",_368);this.focusNode.setAttribute("aria-readonly",_368);this._set("readOnly",_368);},postCreate:function(){this.inherited(arguments);if(has("ie")){this.connect(this.focusNode||this.domNode,"onkeydown",this._onKeyDown);}if(this._resetValue===undefined){this._lastValueReported=this._resetValue=this.value;}},_setValueAttr:function(_369,_36a){this._handleOnChange(_369,_36a);},_handleOnChange:function(_36b,_36c){this._set("value",_36b);this.inherited(arguments);},undo:function(){this._setValueAttr(this._lastValueReported,false);},reset:function(){this._hasBeenBlurred=false;this._setValueAttr(this._resetValue,true);},_onKeyDown:function(e){if(e.keyCode==keys.ESCAPE&&!(e.ctrlKey||e.altKey||e.metaKey)){var te;if(has("ie")<9||(has("ie")&&has("quirks"))){e.preventDefault();te=document.createEventObject();te.keyCode=keys.ESCAPE;te.shiftKey=e.shiftKey;e.srcElement.fireEvent("onkeypress",te);}}}});});},"dijit/form/_FormWidgetMixin":function(){define("dijit/form/_FormWidgetMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-style","dojo/_base/lang","dojo/mouse","dojo/_base/sniff","dojo/_base/window","dojo/window","../a11y"],function(_36d,_36e,_36f,_370,lang,_371,has,win,_372,a11y){return _36e("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:false,intermediateChanges:false,scrollOnFocus:true,_setIdAttr:"focusNode",postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onmousedown","_onMouseDown");},_setDisabledAttr:function(_373){this._set("disabled",_373);_36f.set(this.focusNode,"disabled",_373);if(this.valueNode){_36f.set(this.valueNode,"disabled",_373);}this.focusNode.setAttribute("aria-disabled",_373);if(_373){this._set("hovering",false);this._set("active",false);var _374="tabIndex" in this.attributeMap?this.attributeMap.tabIndex:("_setTabIndexAttr" in this)?this._setTabIndexAttr:"focusNode";_36d.forEach(lang.isArray(_374)?_374:[_374],function(_375){var node=this[_375];if(has("webkit")||a11y.hasDefaultTabStop(node)){node.setAttribute("tabIndex","-1");}else{node.removeAttribute("tabIndex");}},this);}else{if(this.tabIndex!=""){this.set("tabIndex",this.tabIndex);}}},_onFocus:function(e){if(this.scrollOnFocus){_372.scrollIntoView(this.domNode);}this.inherited(arguments);},isFocusable:function(){return !this.disabled&&this.focusNode&&(_370.get(this.domNode,"display")!="none");},focus:function(){if(!this.disabled&&this.focusNode.focus){try{this.focusNode.focus();}catch(e){}}},compare:function(val1,val2){if(typeof val1=="number"&&typeof val2=="number"){return (isNaN(val1)&&isNaN(val2))?0:val1-val2;}else{if(val1>val2){return 1;}else{if(val1<val2){return -1;}else{return 0;}}}},onChange:function(){},_onChangeActive:false,_handleOnChange:function(_376,_377){if(this._lastValueReported==undefined&&(_377===null||!this._onChangeActive)){this._resetValue=this._lastValueReported=_376;}this._pendingOnChange=this._pendingOnChange||(typeof _376!=typeof this._lastValueReported)||(this.compare(_376,this._lastValueReported)!=0);if((this.intermediateChanges||_377||_377===undefined)&&this._pendingOnChange){this._lastValueReported=_376;this._pendingOnChange=false;if(this._onChangeActive){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);}this._onChangeHandle=setTimeout(lang.hitch(this,function(){this._onChangeHandle=null;this.onChange(_376);}),0);}}},create:function(){this.inherited(arguments);this._onChangeActive=true;},destroy:function(){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);this.onChange(this._lastValueReported);}this.inherited(arguments);},_onMouseDown:function(e){if((!this.focused||!has("ie"))&&!e.ctrlKey&&_371.isLeft(e)&&this.isFocusable()){var _378=this.connect(win.body(),"onmouseup",function(){if(this.isFocusable()){this.focus();}this.disconnect(_378);});}}});});},"dojo/date":function(){define("dojo/date",["./_base/kernel","./_base/lang"],function(dojo,lang){lang.getObject("date",true,dojo);dojo.date.getDaysInMonth=function(_379){var _37a=_379.getMonth();var days=[31,28,31,30,31,30,31,31,30,31,30,31];if(_37a==1&&dojo.date.isLeapYear(_379)){return 29;}return days[_37a];};dojo.date.isLeapYear=function(_37b){var year=_37b.getFullYear();return !(year%400)||(!(year%4)&&!!(year%100));};dojo.date.getTimezoneName=function(_37c){var str=_37c.toString();var tz="";var _37d;var pos=str.indexOf("(");if(pos>-1){tz=str.substring(++pos,str.indexOf(")"));}else{var pat=/([A-Z\/]+) \d{4}$/;if((_37d=str.match(pat))){tz=_37d[1];}else{str=_37c.toLocaleString();pat=/ ([A-Z\/]+)$/;if((_37d=str.match(pat))){tz=_37d[1];}}}return (tz=="AM"||tz=="PM")?"":tz;};dojo.date.compare=function(_37e,_37f,_380){_37e=new Date(+_37e);_37f=new Date(+(_37f||new Date()));if(_380=="date"){_37e.setHours(0,0,0,0);_37f.setHours(0,0,0,0);}else{if(_380=="time"){_37e.setFullYear(0,0,0);_37f.setFullYear(0,0,0);}}if(_37e>_37f){return 1;}if(_37e<_37f){return -1;}return 0;};dojo.date.add=function(date,_381,_382){var sum=new Date(+date);var _383=false;var _384="Date";switch(_381){case "day":break;case "weekday":var days,_385;var mod=_382%5;if(!mod){days=(_382>0)?5:-5;_385=(_382>0)?((_382-5)/5):((_382+5)/5);}else{days=mod;_385=parseInt(_382/5);}var strt=date.getDay();var adj=0;if(strt==6&&_382>0){adj=1;}else{if(strt==0&&_382<0){adj=-1;}}var trgt=strt+days;if(trgt==0||trgt==6){adj=(_382>0)?2:-2;}_382=(7*_385)+days+adj;break;case "year":_384="FullYear";_383=true;break;case "week":_382*=7;break;case "quarter":_382*=3;case "month":_383=true;_384="Month";break;default:_384="UTC"+_381.charAt(0).toUpperCase()+_381.substring(1)+"s";}if(_384){sum["set"+_384](sum["get"+_384]()+_382);}if(_383&&(sum.getDate()<date.getDate())){sum.setDate(0);}return sum;};dojo.date.difference=function(_386,_387,_388){_387=_387||new Date();_388=_388||"day";var _389=_387.getFullYear()-_386.getFullYear();var _38a=1;switch(_388){case "quarter":var m1=_386.getMonth();var m2=_387.getMonth();var q1=Math.floor(m1/3)+1;var q2=Math.floor(m2/3)+1;q2+=(_389*4);_38a=q2-q1;break;case "weekday":var days=Math.round(dojo.date.difference(_386,_387,"day"));var _38b=parseInt(dojo.date.difference(_386,_387,"week"));var mod=days%7;if(mod==0){days=_38b*5;}else{var adj=0;var aDay=_386.getDay();var bDay=_387.getDay();_38b=parseInt(days/7);mod=days%7;var _38c=new Date(_386);_38c.setDate(_38c.getDate()+(_38b*7));var _38d=_38c.getDay();if(days>0){switch(true){case aDay==6:adj=-1;break;case aDay==0:adj=0;break;case bDay==6:adj=-1;break;case bDay==0:adj=-2;break;case (_38d+mod)>5:adj=-2;}}else{if(days<0){switch(true){case aDay==6:adj=0;break;case aDay==0:adj=1;break;case bDay==6:adj=2;break;case bDay==0:adj=1;break;case (_38d+mod)<0:adj=2;}}}days+=adj;days-=(_38b*2);}_38a=days;break;case "year":_38a=_389;break;case "month":_38a=(_387.getMonth()-_386.getMonth())+(_389*12);break;case "week":_38a=parseInt(dojo.date.difference(_386,_387,"day")/7);break;case "day":_38a/=24;case "hour":_38a/=60;case "minute":_38a/=60;case "second":_38a/=1000;case "millisecond":_38a*=_387.getTime()-_386.getTime();}return Math.round(_38a);};return dojo.date;});},"versa/api/Groups":function(){define("versa/api/Groups",["dojo/_base/declare","versa/api/_Collection","versa/api/Group"],function(_38e){var o=_38e("versa.api.Groups",[versa.api._Collection],{zone:null,_matchesQuery:function(item,_38f){if(dojo.isArray(item)||(item.hasOwnProperty("user_id"))){return false;}var _390=_38f.query;var _391=_38f.queryOptions&&_38f.queryOptions.ignoreCase;for(var i in _390){var _392=_390[i];var _393=this.getValue(item,i);if((typeof _392=="string"&&(_392.match(/[\*\.]/)||_391))?!dojo.data.util.filter.patternToRegExp(_392,_391).test(_393):_393!=_392){return false;}}return true;},constructor:function(args){this.zone=args.zone;this.target=dojo.replace(versa.api.Groups.TRGT,this.zone);this.schema=versa.api.Group.schema;this.cache=true;this._initialize();this.store.matchesQuery=dojo.hitch(this,this._matchesQuery);},getAdmin:function(){var _394=null;this.forEach(function(item){if(item.is_admin){_394=item;}},this);return _394;},getEveryone:function(){var _395=null;this.forEach(function(item){if(item.is_everyone){_395=item;}},this);return _395;}});o.TRGT="/zones/{subdomain}/groups";return o;});},"dijit/layout/_ContentPaneResizeMixin":function(){define("dijit/layout/_ContentPaneResizeMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/_base/lang","dojo/query","dojo/_base/sniff","dojo/_base/window","../registry","./utils","../_Contained"],function(_396,_397,_398,_399,_39a,lang,_39b,has,win,_39c,_39d,_39e){return _397("dijit.layout._ContentPaneResizeMixin",null,{doLayout:true,isLayoutContainer:true,startup:function(){if(this._started){return;}var _39f=this.getParent();this._childOfLayoutWidget=_39f&&_39f.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);if(this._isShown()){this._onShow();}if(!this._childOfLayoutWidget){this.connect(has("ie")?this.domNode:win.global,"onresize",function(){this._needLayout=!this._childOfLayoutWidget;this.resize();});}},_checkIfSingleChild:function(){var _3a0=_39b("> *",this.containerNode).filter(function(node){return node.tagName!=="SCRIPT";}),_3a1=_3a0.filter(function(node){return _398.has(node,"data-dojo-type")||_398.has(node,"dojoType")||_398.has(node,"widgetId");}),_3a2=_396.filter(_3a1.map(_39c.byNode),function(_3a3){return _3a3&&_3a3.domNode&&_3a3.resize;});if(_3a0.length==_3a1.length&&_3a2.length==1){this._singleChild=_3a2[0];}else{delete this._singleChild;}_399.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild);},resize:function(_3a4,_3a5){if(!this._wasShown&&this.open!==false){this._onShow();}this._resizeCalled=true;this._scheduleLayout(_3a4,_3a5);},_scheduleLayout:function(_3a6,_3a7){if(this._isShown()){this._layout(_3a6,_3a7);}else{this._needLayout=true;this._changeSize=_3a6;this._resultSize=_3a7;}},_layout:function(_3a8,_3a9){if(_3a8){_39a.setMarginBox(this.domNode,_3a8);}var cn=this.containerNode;if(cn===this.domNode){var mb=_3a9||{};lang.mixin(mb,_3a8||{});if(!("h" in mb)||!("w" in mb)){mb=lang.mixin(_39a.getMarginBox(cn),mb);}this._contentBox=_39d.marginBox2contentBox(cn,mb);}else{this._contentBox=_39a.getContentBox(cn);}this._layoutChildren();delete this._needLayout;},_layoutChildren:function(){if(this.doLayout){this._checkIfSingleChild();}if(this._singleChild&&this._singleChild.resize){var cb=this._contentBox||_39a.getContentBox(this.containerNode);this._singleChild.resize({w:cb.w,h:cb.h});}else{_396.forEach(this.getChildren(),function(_3aa){if(_3aa.resize){_3aa.resize();}});}},_isShown:function(){if(this._childOfLayoutWidget){if(this._resizeCalled&&"open" in this){return this.open;}return this._resizeCalled;}else{if("open" in this){return this.open;}else{var node=this.domNode,_3ab=this.domNode.parentNode;return (node.style.display!="none")&&(node.style.visibility!="hidden")&&!_399.contains(node,"dijitHidden")&&_3ab&&_3ab.style&&(_3ab.style.display!="none");}}},_onShow:function(){if(this._needLayout){this._layout(this._changeSize,this._resultSize);}this.inherited(arguments);this._wasShown=true;}});});},"versa/api/ChoiceLists":function(){define("versa/api/ChoiceLists",["dojo/_base/declare","versa/api/ChoiceList","versa/api/_Collection","versa/api/Error","versa/api/DataTypes"],function(_3ac){var o=_3ac("versa.api.ChoiceLists",[versa.api._Collection],{_matchesQuery:function(item,_3ad){if(dojo.isArray(item)||(item.hasOwnProperty("sort_order"))){return false;}var _3ae=_3ad.query;var _3af=_3ad.queryOptions&&_3ad.queryOptions.ignoreCase;for(var i in _3ae){var _3b0=_3ae[i];var _3b1=this.getValue(item,i);if((typeof _3b0=="string"&&(_3b0.match(/[\*\.]/)||_3af))?!dojo.data.util.filter.patternToRegExp(_3b0,_3af).test(_3b1):_3b1!=_3b0){return false;}}return true;},constructor:function(args){this.zone=args.zone;this.library=args.library;this.target=dojo.replace(versa.api.ChoiceLists.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.ChoiceList.schema;this.cache=true;this._initialize();this.store.matchesQuery=dojo.hitch(this,this._matchesQuery);},isValidItem:function(args){var _3b2=this.inherited(arguments);var item=args.item;var _3b3=args.choice_values;if(!_3b2){return;}if(item.name.length<1){throw new Error("Choice List 'Name' is empty or invalid");}if((!_3b3)||(_3b3.length<1)){throw new Error("Choice List '"+item.name+"' does not contain any values");}return true;}});o.TRGT="/zones/{0}/libraries/{1}/choice_lists";return o;});},"versa/widget/mobile/Heading":function(){require(["dojo/_base/declare","dojox/mobile/Heading"],function(_3b4){_3b4("versa.widget.mobile.Heading",[dijit._WidgetBase,dojox.mobile.Heading],{fixed:"top",back:null,backTransition:null,backDirection:null,backButton:null,logoffButton:null,constructor:function(args){this.inherited("constructor",arguments);},postCreate:function(args){this.set("label",this.label.display_limit(12));this.inherited("postCreate",arguments);this.logoffButton=new dojox.mobile.ToolBarButton({label:"Logoff",from:this.from,onClick:dojo.hitch(this,function(){this.onCommand(versa.widget.zone.mobile.Show.COMMANDS.LOGOFF,{from:this.from});}),style:"float: right;"});this.addChild(this.logoffButton);},_setBackAttr:function(back){this.back=back;if(!this.backButton&&this.back){this.backButton=new dojox.mobile.ToolBarButton({moveTo:this.back,label:"Back",transition:this.backTransition?this.backTransition:"slide",transitionDir:this.backDirection?this.backDirection:-1});this.addChild(this.backButton);}else{if(this.backButton&&this.back){this.backButton.set("moveTo",this.back);}}}});});},"versa/widget/document/mobile/LargeTextView":function(){require(["dojo/_base/declare","dijit/_WidgetBase","dojox/mobile/Heading","dojox/mobile/ScrollableView","dojox/mobile/EdgeToEdgeDataList","dojox/mobile/ToolBarButton","dojox/mobile/ContentPane","versa/api/Folders","versa/api/Documents","versa/api/Zones","dojo/data/ItemFileWriteStore","dojo/date/locale"],function(_3b5){_3b5("versa.widget.document.mobile.LargeTextView",[dijit._WidgetBase,dojox.mobile.ScrollableView],{document:null,library:null,property:null,header:null,footer:null,cpContent:null,constructor:function(args){},postCreate:function(){this.inherited("postCreate",arguments);this.header=new versa.widget.mobile.Heading({label:this.label,from:this,back:this.back,onCommand:this.onCommand});this.footer=new versa.widget.mobile.Footing({onCommand:this.onCommand,from:this});this.cpContent=new dojox.mobile.ContentPane({content:this.document[this.property]});this.addChild(this.header);this.addChild(this.footer);this.addChild(this.cpContent);},startup:function(){this.inherited("startup",arguments);}});});},"versa/api/SharedItem":function(){define("versa/api/SharedItem",["dojo/_base/declare","versa/api/_Object","versa/api/Utilities"],function(_3b6){var o=_3b6("versa.api.SharedItem",[versa.api._Object],{zone:null,constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},copyLocal:function(args){var zone=args.zone;var _3b7=args.share;var form=args.form;var url=dojo.replace(versa.api.SharedItem.CP_TRGT,[zone.subdomain,_3b7.fingerprint,this.getId()]);form.set("action",url);form.set("target","_self");form.set("method","post");form.submit();},view:function(args){var zone=args.zone;var _3b8=args.share;var form=args.form;var url=dojo.replace(versa.api.SharedItem.VW_TRGT,[zone.subdomain,_3b8.fingerprint,this.getId()]);versa.api.Utilities.viewUrl({windowBox:args.windowBox,url:url,window_name:"versa_viewer"});}});o.VW_TRGT="/zones/{0}/shares/{1}/download/?item_id={2}&disposition=inline";o.CP_TRGT="/zones/{0}/shares/{1}/download/?item_id={2}&disposition=attachment";o.schema={type:"object",properties:{"id":{type:"integer"}},prototype:new o()};return o;});},"dojo/cldr/supplemental":function(){define("dojo/cldr/supplemental",["../_base/kernel","../_base/lang","../i18n"],function(dojo,lang){lang.getObject("cldr.supplemental",true,dojo);dojo.cldr.supplemental.getFirstDayOfWeek=function(_3b9){var _3ba={mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,er:6,et:6,iq:6,ir:6,jo:6,ke:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,so:6,sy:6,tn:6,ye:6,ar:0,as:0,az:0,bw:0,ca:0,cn:0,fo:0,ge:0,gl:0,gu:0,hk:0,il:0,"in":0,jm:0,jp:0,kg:0,kr:0,la:0,mh:0,mn:0,mo:0,mp:0,mt:0,nz:0,ph:0,pk:0,sg:0,th:0,tt:0,tw:0,um:0,us:0,uz:0,vi:0,zw:0};var _3bb=dojo.cldr.supplemental._region(_3b9);var dow=_3ba[_3bb];return (dow===undefined)?1:dow;};dojo.cldr.supplemental._region=function(_3bc){_3bc=dojo.i18n.normalizeLocale(_3bc);var tags=_3bc.split("-");var _3bd=tags[1];if(!_3bd){_3bd={de:"de",en:"us",es:"es",fi:"fi",fr:"fr",he:"il",hu:"hu",it:"it",ja:"jp",ko:"kr",nl:"nl",pt:"br",sv:"se",zh:"cn"}[tags[0]];}else{if(_3bd.length==4){_3bd=tags[2];}}return _3bd;};dojo.cldr.supplemental.getWeekend=function(_3be){var _3bf={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5};var _3c0={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6};var _3c1=dojo.cldr.supplemental._region(_3be);var _3c2=_3bf[_3c1];var end=_3c0[_3c1];if(_3c2===undefined){_3c2=6;}if(end===undefined){end=0;}return {start:_3c2,end:end};};return dojo.cldr.supplemental;});},"versa/api/Library":function(){define("versa/api/Library",["dojo/_base/declare","versa/api/_Object","versa/api/_Securable","versa/api/ChoiceLists","versa/api/Documents","versa/api/DocumentTypes","versa/api/Folders","versa/api/PropertyDefinitions","versa/api/References","versa/api/ViewMappings"],function(_3c3){var o=_3c3("versa.api.Library",[versa.api._Object,versa.api._Securable],{zone:null,_choiceLists:null,_documents:null,_documentTypes:null,_folders:null,_propertyDefinitions:null,_references:null,_viewDefinitions:null,_viewMappings:null,_cellDefinitions:null,description:null,constructor:function(args){_3c3.safeMixin(this,((!args)?{}:args));this.securable_type=versa.api._Securable.types.Library;},createShare:function(args){var _3c4=args.shareRoot;var _3c5={parent:_3c4,attribute:"children"};var _3c6=this.getFolders().store.newItem({name:args.name,folder_type:versa.api.Folder.FolderTypes.SHARE,parent_id:_3c4.getId(),password:args.password,expiry:args.expiry,seed_id:(args.seed)?args.seed.getId():null,children:[]},_3c5);this.getFolders().store.changing(_3c6);return _3c6;},empty_trash:function(args){var zone=args.zone;var url=dojo.replace(versa.api.Library.EMPTYTRASH_TRGT,[zone.subdomain,this.getId()]);var _3c7=versa.api.XhrHelper.doPutAction({target:url,putData:{}});return true;},getChoiceLists:function(){if(!this._choiceLists){this._choiceLists=new versa.api.ChoiceLists({zone:this.zone,library:this});}return this._choiceLists;},getDocuments:function(){if(!this._documents){this._documents=new versa.api.Documents({zone:this.zone,library:this});}return this._documents;},getDocumentTypes:function(){if(!this._documentTypes){this._documentTypes=new versa.api.DocumentTypes({zone:this.zone,library:this});}return this._documentTypes;},getFolders:function(){if(!this._folders){this._folders=new versa.api.Folders({zone:this.zone,library:this});}return this._folders;},getPropertyDefinitions:function(){if(!this._propertyDefinitions){this._propertyDefinitions=new versa.api.PropertyDefinitions({zone:this.zone,library:this});}return this._propertyDefinitions;},getPropertyMappings:function(){if(!this._propertyMappings){this._propertyMappings=new versa.api.PropertyMappings({zone:this.zone,library:this});}return this._propertyMappings;},getReferences:function(){if(!this._references){this._references=new versa.api.References({zone:this.zone,library:this});}return this._references;},getViewDefinitions:function(){if(!this._viewDefinitions){this._viewDefinitions=new versa.api.ViewDefinitions({zone:this.zone,library:this});}return this._viewDefinitions;},getViewMappings:function(){if(!this._viewMappings){this._viewMappings=new versa.api.ViewMappings({zone:this.zone,library:this});}return this._viewMappings;},getCellDefinitions:function(){if(!this._cellDefinitions){this._cellDefinitions=new versa.api.CellDefinitions({zone:this.zone,library:this});}return this._cellDefinitions;}});o.EMPTYTRASH_TRGT="/zones/{0}/libraries/{1}/empty_trash.json";o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":""},"description":{type:"string"},"created_at":{type:"date",format:"date-time"},"created_by":{type:"string"},"updated_at":{type:"date",format:"date-time"},"updated_by":{type:"string"}},prototype:new o()};return o;});},"versa/api/SharedItems":function(){define("versa/api/SharedItems",["dojo/_base/declare","versa/api/_Collection","versa/api/SharedItem"],function(_3c8){var o=_3c8("versa.api.SharedItems",[versa.api._Collection],{zone:null,share:null,constructor:function(args){this.zone=args.zone;this.share=args.share;this.target=dojo.replace(versa.api.SharedItems.TRGT,[this.zone.subdomain,this.share.fingerprint]);this.schema=versa.api.SharedItem.schema;this.cache=true;this._initialize();}});o.TRGT="/zones/{0}/shares/{1}/shared_items";return o;});},"dojox/data/JsonRestStore":function(){define("dojox/data/JsonRestStore",["dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojox/rpc/Rest","dojox/rpc/JsonRest","dojox/json/schema","dojox/data/ServiceStore"],function(lang,_3c9,_3ca,_3cb,_3cc,_3cd,_3ce){var _3cf=_3c9("dojox.data.JsonRestStore",_3ce,{constructor:function(_3d0){_3ca.connect(_3cb._index,"onUpdate",this,function(obj,_3d1,_3d2,_3d3){var _3d4=this.service.servicePath;if(!obj.__id){}else{if(obj.__id.substring(0,_3d4.length)==_3d4){this.onSet(obj,_3d1,_3d2,_3d3);}}});this.idAttribute=this.idAttribute||"id";if(typeof _3d0.target=="string"){_3d0.target=_3d0.target.match(/\/$/)||this.allowNoTrailingSlash?_3d0.target:(_3d0.target+"/");if(!this.service){this.service=_3cc.services[_3d0.target]||_3cb(_3d0.target,true);}}_3cc.registerService(this.service,_3d0.target,this.schema);this.schema=this.service._schema=this.schema||this.service._schema||{};this.service._store=this;this.service.idAsRef=this.idAsRef;this.schema._idAttr=this.idAttribute;var _3d5=_3cc.getConstructor(this.service);var self=this;this._constructor=function(data){_3d5.call(this,data);self.onNew(this);};this._constructor.prototype=_3d5.prototype;this._index=_3cb._index;},loadReferencedSchema:true,idAsRef:false,referenceIntegrity:true,target:"",allowNoTrailingSlash:false,newItem:function(data,_3d6){data=new this._constructor(data);if(_3d6){var _3d7=this.getValue(_3d6.parent,_3d6.attribute,[]);_3d7=_3d7.concat([data]);data.__parent=_3d7;this.setValue(_3d6.parent,_3d6.attribute,_3d7);}return data;},deleteItem:function(item){var _3d8=[];var _3d9=_3da._getStoreForItem(item)||this;if(this.referenceIntegrity){_3cc._saveNotNeeded=true;var _3db=_3cb._index;var _3dc=function(_3dd){var _3de;_3d8.push(_3dd);_3dd.__checked=1;for(var i in _3dd){if(i.substring(0,2)!="__"){var _3df=_3dd[i];if(_3df==item){if(_3dd!=_3db){if(_3dd instanceof Array){(_3de=_3de||[]).push(i);}else{(_3da._getStoreForItem(_3dd)||_3d9).unsetAttribute(_3dd,i);}}}else{if((typeof _3df=="object")&&_3df){if(!_3df.__checked){_3dc(_3df);}if(typeof _3df.__checked=="object"&&_3dd!=_3db){(_3da._getStoreForItem(_3dd)||_3d9).setValue(_3dd,i,_3df.__checked);}}}}}if(_3de){i=_3de.length;_3dd=_3dd.__checked=_3dd.concat();while(i--){_3dd.splice(_3de[i],1);}return _3dd;}return null;};_3dc(_3db);_3cc._saveNotNeeded=false;var i=0;while(_3d8[i]){delete _3d8[i++].__checked;}}_3cc.deleteObject(item);_3d9.onDelete(item);},changing:function(item,_3e0){_3cc.changing(item,_3e0);},cancelChanging:function(_3e1){if(!_3e1.__id){return;}dirtyObjects=_3e2=_3cc.getDirtyObjects();for(var i=0;i<dirtyObjects.length;i++){var _3e2=dirtyObjects[i];if(_3e1==_3e2.object){dirtyObjects.splice(i,1);return;}}},setValue:function(item,_3e3,_3e4){var old=item[_3e3];var _3e5=item.__id?_3da._getStoreForItem(item):this;if(_3cd&&_3e5.schema&&_3e5.schema.properties){_3cd.mustBeValid(_3cd.checkPropertyChange(_3e4,_3e5.schema.properties[_3e3]));}if(_3e3==_3e5.idAttribute){throw new Error("Can not change the identity attribute for an item");}_3e5.changing(item);item[_3e3]=_3e4;if(_3e4&&!_3e4.__parent){_3e4.__parent=item;}_3e5.onSet(item,_3e3,old,_3e4);},setValues:function(item,_3e6,_3e7){if(!lang.isArray(_3e7)){throw new Error("setValues expects to be passed an Array object as its value");}this.setValue(item,_3e6,_3e7);},unsetAttribute:function(item,_3e8){this.changing(item);var old=item[_3e8];delete item[_3e8];this.onSet(item,_3e8,old,undefined);},save:function(_3e9){if(!(_3e9&&_3e9.global)){(_3e9=_3e9||{}).service=this.service;}if("syncMode" in _3e9?_3e9.syncMode:this.syncMode){rpcConfig._sync=true;}var _3ea=_3cc.commit(_3e9);this.serverVersion=this._updates&&this._updates.length;return _3ea;},revert:function(_3eb){_3cc.revert(_3eb&&_3eb.global&&this.service);},isDirty:function(item){return _3cc.isDirty(item,this);},isItem:function(item,_3ec){return item&&item.__id&&(_3ec||this.service==_3cc.getServiceAndId(item.__id).service);},_doQuery:function(args){var _3ed=typeof args.queryStr=="string"?args.queryStr:args.query;var _3ee=_3cc.query(this.service,_3ed,args);var self=this;if(this.loadReferencedSchema){_3ee.addCallback(function(_3ef){var _3f0=_3ee.ioArgs&&_3ee.ioArgs.xhr&&_3ee.ioArgs.xhr.getResponseHeader("Content-Type");var _3f1=_3f0&&_3f0.match(/definedby\s*=\s*([^;]*)/);if(_3f0&&!_3f1){_3f1=_3ee.ioArgs.xhr.getResponseHeader("Link");_3f1=_3f1&&_3f1.match(/<([^>]*)>;\s*rel="?definedby"?/);}_3f1=_3f1&&_3f1[1];if(_3f1){var _3f2=_3cc.getServiceAndId((self.target+_3f1).replace(/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/,"$2$3"));var _3f3=_3cc.byId(_3f2.service,_3f2.id);_3f3.addCallbacks(function(_3f4){lang.mixin(self.schema,_3f4);return _3ef;},function(_3f5){return _3ef;});return _3f3;}return undefined;});}return _3ee;},_processResults:function(_3f6,_3f7){var _3f8=_3f6.length;return {totalCount:_3f7.fullLength||(_3f7.request.count==_3f8?(_3f7.request.start||0)+_3f8*2:_3f8),items:_3f6};},getConstructor:function(){return this._constructor;},getIdentity:function(item){var id=item.__clientId||item.__id;if(!id){return id;}var _3f9=this.service.servicePath.replace(/[^\/]*$/,"");return id.substring(0,_3f9.length)!=_3f9?id:id.substring(_3f9.length);},fetchItemByIdentity:function(args){var id=args.identity;var _3fa=this;if(id.toString().match(/^(\w*:)?\//)){var _3fb=_3cc.getServiceAndId(id);_3fa=_3fb.service._store;args.identity=_3fb.id;}args._prefix=_3fa.service.servicePath.replace(/[^\/]*$/,"");return _3fa.inherited(arguments);},onSet:function(){},onNew:function(){},onDelete:function(){},getFeatures:function(){var _3fc=this.inherited(arguments);_3fc["dojo.data.api.Write"]=true;_3fc["dojo.data.api.Notification"]=true;return _3fc;},getParent:function(item){return item&&item.__parent;}});_3cf.getStore=function(_3fd,_3fe){if(typeof _3fd.target=="string"){_3fd.target=_3fd.target.match(/\/$/)||_3fd.allowNoTrailingSlash?_3fd.target:(_3fd.target+"/");var _3ff=(_3cc.services[_3fd.target]||{})._store;if(_3ff){return _3ff;}}return new (_3fe||_3cf)(_3fd);};var _3da=lang.getObject("dojox.data",true);_3da._getStoreForItem=function(item){if(item.__id){var _400=_3cc.getServiceAndId(item.__id);if(_400&&_400.service._store){return _400.service._store;}else{var _401=item.__id.toString().match(/.*\//)[0];return new _3cf({target:_401});}}return null;};var _402=lang.getObject("dojox.json.ref",true);_402._useRefs=true;return _3cf;});},"versa/widget/document/mobile/DocumentContentView":function(){require(["dojo/_base/declare","dijit/_WidgetBase","dojox/mobile/Heading","dojox/mobile/ScrollableView","dojox/mobile/EdgeToEdgeDataList","dojox/mobile/ToolBarButton","dojox/mobile/ContentPane","versa/api/Folders","versa/api/Documents","versa/api/Zones","dojo/data/ItemFileWriteStore","dojo/date/locale"],function(_403){_403("versa.widget.document.mobile.DocumentContentView",[dijit._WidgetBase,dojox.mobile.ScrollableView],{reference:null,zone:null,library:null,header:null,footer:null,cpContent:null,constructor:function(args){},postCreate:function(){this.inherited("postCreate",arguments);this.header=new versa.widget.mobile.Heading({label:this.reference.name,from:this,back:this.back,onCommand:this.onCommand});this.footer=new versa.widget.mobile.Footing({onCommand:this.onCommand,from:this});if(this.reference.binary_content_type.indexOf("image")>=0){this.cpContent=new dojox.mobile.ContentPane({content:dojo.replace("<div style=\"text-align: center;vertical-align: middle;width: 100%; height: 100%;\"><img src=\"{0}\"/></div>",[this.reference.getViewUrl(this.zone,this.library)])});}else{if(this.reference.binary_content_type.indexOf("text")>=0){this.cpContent=new dojox.mobile.ContentPane({content:""});dojo.xhrGet({url:this.reference.getViewUrl(this.zone,this.library),handleAs:"text",load:dojo.hitch(this,function(data){data=data.replace(/\n/g,"<br/>");data=data.replace(/\t/g,"&nbsp;&nbsp;&nbsp;");this.cpContent.domNode.innerHTML=data;})});}}this.addChild(this.header);this.addChild(this.footer);this.addChild(this.cpContent);},startup:function(){this.inherited("startup",arguments);}});});},"dijit/_base/manager":function(){define("dijit/_base/manager",["dojo/_base/array","dojo/_base/config","../registry",".."],function(_404,_405,_406,_407){_404.forEach(["byId","getUniqueId","findWidgets","_destroyAll","byNode","getEnclosingWidget"],function(name){_407[name]=_406[name];});_407.defaultDuration=_405["defaultDuration"]||200;return _407;});},"versa/api/ViewMapping":function(){define("versa/api/ViewMapping",["dojo/_base/declare","versa/api/_Object","versa/api/Error"],function(_408){var o=_408("versa.api.ViewMapping",[versa.api._Object],{constructor:function(args){if(args){dojo.safeMixin(this,args);}}});o.compare=function(_409,_40a){return _409.sort_order-_40a.sort_order;};o.schema={type:"object",properties:{"library_id":{type:"integer"},"folder_id":{type:"integer"},"user_id":{type:"integer"},"view_id":{type:"integer"}}};return o;});},"dojox/mobile/common":function(){define("dojox/mobile/common",["dojo/_base/kernel","dojo/_base/array","dojo/_base/config","dojo/_base/connect","dojo/_base/lang","dojo/_base/window","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/ready","dijit/registry","./sniff","./uacss"],function(dojo,_40b,_40c,_40d,lang,win,_40e,_40f,_410,_411,_412,has,_413){var dm=lang.getObject("dojox.mobile",true);dm.getScreenSize=function(){return {h:win.global.innerHeight||win.doc.documentElement.clientHeight,w:win.global.innerWidth||win.doc.documentElement.clientWidth};};dm.updateOrient=function(){var dim=dm.getScreenSize();_40e.replace(win.doc.documentElement,dim.h>dim.w?"dj_portrait":"dj_landscape",dim.h>dim.w?"dj_landscape":"dj_portrait");};dm.updateOrient();dm.tabletSize=500;dm.detectScreenSize=function(_414){var dim=dm.getScreenSize();var sz=Math.min(dim.w,dim.h);var from,to;if(sz>=dm.tabletSize&&(_414||(!this._sz||this._sz<dm.tabletSize))){from="phone";to="tablet";}else{if(sz<dm.tabletSize&&(_414||(!this._sz||this._sz>=dm.tabletSize))){from="tablet";to="phone";}}if(to){_40e.replace(win.doc.documentElement,"dj_"+to,"dj_"+from);_40d.publish("/dojox/mobile/screenSize/"+to,[dim]);}this._sz=sz;};dm.detectScreenSize();dm.setupIcon=function(_415,_416){if(_415&&_416){var arr=_40b.map(_416.split(/[ ,]/),function(item){return item-0;});var t=arr[0];var r=arr[1]+arr[2];var b=arr[0]+arr[3];var l=arr[1];_410.set(_415,{clip:"rect("+t+"px "+r+"px "+b+"px "+l+"px)",top:(_415.parentNode?_410.get(_415,"top"):0)-t+"px",left:-l+"px"});}};dm.hideAddressBarWait=typeof (_40c["mblHideAddressBarWait"])==="number"?_40c["mblHideAddressBarWait"]:1500;dm.hide_1=function(_417){scrollTo(0,1);var h=dm.getScreenSize().h+"px";if(has("android")){if(_417){win.body().style.minHeight=h;}dm.resizeAll();}else{if(_417||dm._h===h&&h!==win.body().style.minHeight){win.body().style.minHeight=h;dm.resizeAll();}}dm._h=h;};dm.hide_fs=function(){var t=win.body().style.minHeight;win.body().style.minHeight=(dm.getScreenSize().h*2)+"px";scrollTo(0,1);setTimeout(function(){dm.hide_1(1);dm._hiding=false;},1000);};dm.hideAddressBar=function(evt){if(dm.disableHideAddressBar||dm._hiding){return;}dm._hiding=true;dm._h=0;win.body().style.minHeight=(dm.getScreenSize().h*2)+"px";setTimeout(dm.hide_1,0);setTimeout(dm.hide_1,200);setTimeout(dm.hide_1,800);setTimeout(dm.hide_fs,dm.hideAddressBarWait);};dm.resizeAll=function(evt,root){if(dm.disableResizeAll){return;}_40d.publish("/dojox/mobile/resizeAll",[evt,root]);dm.updateOrient();dm.detectScreenSize();var _418=function(w){var _419=w.getParent&&w.getParent();return !!((!_419||!_419.resize)&&w.resize);};var _41a=function(w){_40b.forEach(w.getChildren(),function(_41b){if(_418(_41b)){_41b.resize();}_41a(_41b);});};if(root){if(root.resize){root.resize();}_41a(root);}else{_40b.forEach(_40b.filter(_412.toArray(),_418),function(w){w.resize();});}};dm.openWindow=function(url,_41c){win.global.open(url,_41c||"_blank");};dm.createDomButton=function(_41d,_41e,_41f){if(!dm._domButtons){if(has("webkit")){var _420=function(_421,dic){var i,j;if(!_421){var dic={};var ss=dojo.doc.styleSheets;for(i=0;i<ss.length;i++){ss[i]&&_420(ss[i],dic);}return dic;}var _422=_421.cssRules||[];for(i=0;i<_422.length;i++){var rule=_422[i];if(rule.href&&rule.styleSheet){_420(rule.styleSheet,dic);}else{if(rule.selectorText){var sels=rule.selectorText.split(/,/);for(j=0;j<sels.length;j++){var sel=sels[j];var n=sel.split(/>/).length-1;if(sel.match(/(mblDomButton\w+)/)){var cls=RegExp.$1;if(!dic[cls]||n>dic[cls]){dic[cls]=n;}}}}}}};dm._domButtons=_420();}else{dm._domButtons={};}}var s=_41d.className;var node=_41f||_41d;if(s.match(/(mblDomButton\w+)/)&&s.indexOf("/")===-1){var _423=RegExp.$1;var nDiv=4;if(s.match(/(mblDomButton\w+_(\d+))/)){nDiv=RegExp.$2-0;}else{if(dm._domButtons[_423]!==undefined){nDiv=dm._domButtons[_423];}}var _424=null;if(has("bb")&&_40c["mblBBBoxShadowWorkaround"]!==false){_424={style:"-webkit-box-shadow:none"};}for(var i=0,p=node;i<nDiv;i++){p=p.firstChild||_40f.create("DIV",_424,p);}if(_41f){setTimeout(function(){_40e.remove(_41d,_423);},0);_40e.add(_41f,_423);}}else{if(s.indexOf(".")!==-1){_40f.create("IMG",{src:s},node);}else{return null;}}_40e.add(node,"mblDomButton");if(_40c["mblAndroidWorkaround"]!==false&&has("android")>=2.2){_410.set(node,"webkitTransform","translate3d(0,0,0)");}!!_41e&&_410.set(node,_41e);return node;};dm.createIcon=function(icon,_425,node,_426,_427){if(icon&&icon.indexOf("mblDomButton")===0){if(node&&node.className.match(/(mblDomButton\w+)/)){_40e.remove(node,RegExp.$1);}else{node=_40f.create("DIV");}node.title=_426;_40e.add(node,icon);dm.createDomButton(node);}else{if(icon&&icon!=="none"){if(!node||node.nodeName!=="IMG"){node=_40f.create("IMG",{alt:_426});}node.src=(icon||"").replace("${theme}",dm.currentTheme);dm.setupIcon(node,_425);if(_427&&_425){var arr=_425.split(/[ ,]/);_410.set(_427,{width:arr[2]+"px",height:arr[3]+"px"});}}}if(_427){_427.appendChild(node);}return node;};dm._iw=_40c["mblIosWorkaround"]!==false&&has("iphone");if(dm._iw){dm._iwBgCover=_40f.create("div");}if(_40c.parseOnLoad){_411(90,function(){var _428=win.body().getElementsByTagName("*");var i,len,s;len=_428.length;for(i=0;i<len;i++){s=_428[i].getAttribute("dojoType");if(s){if(_428[i].parentNode.getAttribute("lazy")=="true"){_428[i].setAttribute("__dojoType",s);_428[i].removeAttribute("dojoType");}}}});}_411(function(){dm.detectScreenSize(true);if(_40c["mblApplyPageStyles"]!==false){_40e.add(win.doc.documentElement,"mobile");}if(has("chrome")){_40e.add(win.doc.documentElement,"dj_chrome");}if(_40c["mblAndroidWorkaround"]!==false&&has("android")>=2.2){if(_40c["mblAndroidWorkaroundButtonStyle"]!==false){_40f.create("style",{innerHTML:"BUTTON,INPUT[type='button'],INPUT[type='submit'],INPUT[type='reset'],INPUT[type='file']::-webkit-file-upload-button{-webkit-appearance:none;}"},win.doc.head,"first");}if(has("android")<3){_410.set(win.doc.documentElement,"webkitTransform","translate3d(0,0,0)");_40d.connect(null,"onfocus",null,function(e){_410.set(win.doc.documentElement,"webkitTransform","");});_40d.connect(null,"onblur",null,function(e){_410.set(win.doc.documentElement,"webkitTransform","translate3d(0,0,0)");});}else{if(_40c["mblAndroid3Workaround"]!==false){_410.set(win.doc.documentElement,{webkitBackfaceVisibility:"hidden",webkitPerspective:8000});}}}var f=dm.resizeAll;if(_40c["mblHideAddressBar"]!==false&&navigator.appVersion.indexOf("Mobile")!=-1||_40c["mblForceHideAddressBar"]===true){dm.hideAddressBar();if(_40c["mblAlwaysHideAddressBar"]===true){f=dm.hideAddressBar;}}_40d.connect(null,(win.global.onorientationchange!==undefined&&!has("android"))?"onorientationchange":"onresize",null,f);var _429=win.body().getElementsByTagName("*");var i,len=_429.length,s;for(i=0;i<len;i++){s=_429[i].getAttribute("__dojoType");if(s){_429[i].setAttribute("dojoType",s);_429[i].removeAttribute("__dojoType");}}if(dojo.hash){var _42a=function(root){if(!root){return [];}var arr=_412.findWidgets(root);var _42b=arr;for(var i=0;i<_42b.length;i++){arr=arr.concat(_42a(_42b[i].containerNode));}return arr;};_40d.subscribe("/dojo/hashchange",null,function(_42c){var view=dm.currentView;if(!view){return;}var _42d=dm._params;if(!_42d){var _42e=_42c?_42c:dm._defaultView.id;var _42f=_42a(view.domNode);var dir=1,_430="slide";for(i=0;i<_42f.length;i++){var w=_42f[i];if("#"+_42e==w.moveTo){_430=w.transition;dir=(w instanceof dm.Heading)?-1:1;break;}}_42d=[_42e,dir,_430];}view.performTransition.apply(view,_42d);dm._params=null;});}win.body().style.visibility="visible";});_412.getEnclosingWidget=function(node){while(node){var id=node.getAttribute&&node.getAttribute("widgetId");if(id){return _412.byId(id);}node=node._parentNode||node.parentNode;}return null;};return dm;});},"dojox/rpc/Rest":function(){define("dojox/rpc/Rest",["dojo","dojox"],function(dojo,_431){dojo.getObject("rpc.Rest",true,_431);if(_431.rpc&&_431.rpc.transportRegistry){_431.rpc.transportRegistry.register("REST",function(str){return str=="REST";},{getExecutor:function(func,_432,svc){return new _431.rpc.Rest(_432.name,(_432.contentType||svc._smd.contentType||"").match(/json|javascript/),null,function(id,args){var _433=svc._getRequest(_432,[id]);_433.url=_433.target+(_433.data?"?"+_433.data:"");if(args&&(args.start>=0||args.count>=0)){_433.headers=_433.headers||{};_433.headers.Range="items="+(args.start||"0")+"-"+(("count" in args&&args.count!=Infinity)?(args.count+(args.start||0)-1):"");}return _433;});}});}var drr;function _434(_435,_436,_437,id){_435.addCallback(function(_438){if(_435.ioArgs.xhr&&_437){_437=_435.ioArgs.xhr.getResponseHeader("Content-Range");_435.fullLength=_437&&(_437=_437.match(/\/(.*)/))&&parseInt(_437[1]);}return _438;});return _435;};drr=_431.rpc.Rest=function(path,_439,_43a,_43b){var _43c;_43c=function(id,args){return drr._get(_43c,id,args);};_43c.isJson=_439;_43c._schema=_43a;_43c.cache={serialize:_439?((_431.json&&_431.json.ref)||dojo).toJson:function(_43d){return _43d;}};_43c._getRequest=_43b||function(id,args){if(dojo.isObject(id)){id=dojo.objectToQuery(id);id=id?"?"+id:"";}if(args&&args.sort&&!args.queryStr){id+=(id?"&":"?")+"sort(";for(var i=0;i<args.sort.length;i++){var sort=args.sort[i];id+=(i>0?",":"")+(sort.descending?"-":"+")+encodeURIComponent(sort.attribute);}id+=")";}var _43e={url:path+(id==null?"":id),handleAs:_439?"json":"text",contentType:_439?"application/json":"text/plain",sync:_431.rpc._sync,headers:{Accept:_439?"application/json,application/javascript":"*/*"}};if(args&&(args.start>=0||args.count>=0)){_43e.headers.Range="items="+(args.start||"0")+"-"+(("count" in args&&args.count!=Infinity)?(args.count+(args.start||0)-1):"");}_431.rpc._sync=false;return _43e;};function _43f(name){_43c[name]=function(id,_440){return drr._change(name,_43c,id,_440);};};_43f("put");_43f("post");_43f("delete");_43c.servicePath=path;return _43c;};drr._index={};drr._timeStamps={};drr._change=function(_441,_442,id,_443){var _444=_442._getRequest(id);_444[_441+"Data"]=_443;return _434(dojo.xhr(_441.toUpperCase(),_444,true),_442);};drr._get=function(_445,id,args){args=args||{};return _434(dojo.xhrGet(_445._getRequest(id,args)),_445,(args.start>=0||args.count>=0),id);};return _431.rpc.Rest;});},"dijit/_WidgetBase":function(){define("dijit/_WidgetBase",["require","dojo/_base/array","dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/ready","dojo/Stateful","dojo/topic","dojo/_base/window","./registry"],function(_446,_447,_448,_449,_44a,_44b,dom,_44c,_44d,_44e,_44f,_450,_451,lang,on,_452,_453,_454,win,_455){if(!_451.isAsync){_452(0,function(){var _456=["dijit/_base/manager"];_446(_456);});}var _457={};function _458(obj){var ret={};for(var attr in obj){ret[attr.toLowerCase()]=true;}return ret;};function _459(attr){return function(val){_44c[val?"set":"remove"](this.domNode,attr,val);this._set(attr,val);};};return _44b("dijit._WidgetBase",_453,{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:_459("lang"),dir:"",_setDirAttr:_459("dir"),textDir:"","class":"",_setClassAttr:{node:"domNode",type:"class"},style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,attributeMap:{},_blankGif:_449.blankGif||_446.toUrl("dojo/resources/blank.gif"),postscript:function(_45a,_45b){this.create(_45a,_45b);},create:function(_45c,_45d){this.srcNodeRef=dom.byId(_45d);this._connects=[];this._supportingWidgets=[];if(this.srcNodeRef&&(typeof this.srcNodeRef.id=="string")){this.id=this.srcNodeRef.id;}if(_45c){this.params=_45c;lang.mixin(this,_45c);}this.postMixInProperties();if(!this.id){this.id=_455.getUniqueId(this.declaredClass.replace(/\./g,"_"));}_455.add(this);this.buildRendering();if(this.domNode){this._applyAttributes();var _45e=this.srcNodeRef;if(_45e&&_45e.parentNode&&this.domNode!==_45e){_45e.parentNode.replaceChild(this.domNode,_45e);}}if(this.domNode){this.domNode.setAttribute("widgetId",this.id);}this.postCreate();if(this.srcNodeRef&&!this.srcNodeRef.parentNode){delete this.srcNodeRef;}this._created=true;},_applyAttributes:function(){var ctor=this.constructor,list=ctor._setterAttrs;if(!list){list=(ctor._setterAttrs=[]);for(var attr in this.attributeMap){list.push(attr);}var _45f=ctor.prototype;for(var _460 in _45f){if(_460 in this.attributeMap){continue;}var _461="_set"+_460.replace(/^[a-z]|-[a-zA-Z]/g,function(c){return c.charAt(c.length-1).toUpperCase();})+"Attr";if(_461 in _45f){list.push(_460);}}}_447.forEach(list,function(attr){if(this.params&&attr in this.params){}else{if(this[attr]){this.set(attr,this[attr]);}}},this);for(var _462 in this.params){this.set(_462,this[_462]);}},postMixInProperties:function(){},buildRendering:function(){if(!this.domNode){this.domNode=this.srcNodeRef||_44e.create("div");}if(this.baseClass){var _463=this.baseClass.split(" ");if(!this.isLeftToRight()){_463=_463.concat(_447.map(_463,function(name){return name+"Rtl";}));}_44d.add(this.domNode,_463);}},postCreate:function(){},startup:function(){if(this._started){return;}this._started=true;_447.forEach(this.getChildren(),function(obj){if(!obj._started&&!obj._destroyed&&lang.isFunction(obj.startup)){obj.startup();obj._started=true;}});},destroyRecursive:function(_464){this._beingDestroyed=true;this.destroyDescendants(_464);this.destroy(_464);},destroy:function(_465){this._beingDestroyed=true;this.uninitialize();var c;while(c=this._connects.pop()){c.remove();}var w;while(w=this._supportingWidgets.pop()){if(w.destroyRecursive){w.destroyRecursive();}else{if(w.destroy){w.destroy();}}}this.destroyRendering(_465);_455.remove(this.id);this._destroyed=true;},destroyRendering:function(_466){if(this.bgIframe){this.bgIframe.destroy(_466);delete this.bgIframe;}if(this.domNode){if(_466){_44c.remove(this.domNode,"widgetId");}else{_44e.destroy(this.domNode);}delete this.domNode;}if(this.srcNodeRef){if(!_466){_44e.destroy(this.srcNodeRef);}delete this.srcNodeRef;}},destroyDescendants:function(_467){_447.forEach(this.getChildren(),function(_468){if(_468.destroyRecursive){_468.destroyRecursive(_467);}});},uninitialize:function(){return false;},_setStyleAttr:function(_469){var _46a=this.domNode;if(lang.isObject(_469)){_450.set(_46a,_469);}else{if(_46a.style.cssText){_46a.style.cssText+="; "+_469;}else{_46a.style.cssText=_469;}}this._set("style",_469);},_attrToDom:function(attr,_46b,_46c){_46c=arguments.length>=3?_46c:this.attributeMap[attr];_447.forEach(lang.isArray(_46c)?_46c:[_46c],function(_46d){var _46e=this[_46d.node||_46d||"domNode"];var type=_46d.type||"attribute";switch(type){case "attribute":if(lang.isFunction(_46b)){_46b=lang.hitch(this,_46b);}var _46f=_46d.attribute?_46d.attribute:(/^on[A-Z][a-zA-Z]*$/.test(attr)?attr.toLowerCase():attr);_44c.set(_46e,_46f,_46b);break;case "innerText":_46e.innerHTML="";_46e.appendChild(win.doc.createTextNode(_46b));break;case "innerHTML":_46e.innerHTML=_46b;break;case "class":_44d.replace(_46e,_46b,this[attr]);break;}},this);},get:function(name){var _470=this._getAttrNames(name);return this[_470.g]?this[_470.g]():this[name];},set:function(name,_471){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _472=this._getAttrNames(name),_473=this[_472.s];if(lang.isFunction(_473)){var _474=_473.apply(this,Array.prototype.slice.call(arguments,1));}else{var _475=this.focusNode&&!lang.isFunction(this.focusNode)?"focusNode":"domNode",tag=this[_475].tagName,_476=_457[tag]||(_457[tag]=_458(this[_475])),map=name in this.attributeMap?this.attributeMap[name]:_472.s in this?this[_472.s]:((_472.l in _476&&typeof _471!="function")||/^aria-|^data-|^role$/.test(name))?_475:null;if(map!=null){this._attrToDom(name,_471,map);}this._set(name,_471);}return _474||this;},_attrPairNames:{},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.replace(/^[a-z]|-[a-zA-Z]/g,function(c){return c.charAt(c.length-1).toUpperCase();});return (apn[name]={n:name+"Node",s:"_set"+uc+"Attr",g:"_get"+uc+"Attr",l:uc.toLowerCase()});},_set:function(name,_477){var _478=this[name];this[name]=_477;if(this._watchCallbacks&&this._created&&_477!==_478){this._watchCallbacks(name,_478,_477);}},on:function(type,func){return _448.after(this,this._onMap(type),func,true);},_onMap:function(type){var ctor=this.constructor,map=ctor._onMap;if(!map){map=(ctor._onMap={});for(var attr in ctor.prototype){if(/^on/.test(attr)){map[attr.replace(/^on/,"").toLowerCase()]=attr;}}}return map[type.toLowerCase()];},toString:function(){return "[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]";},getChildren:function(){return this.containerNode?_455.findWidgets(this.containerNode):[];},getParent:function(){return _455.getEnclosingWidget(this.domNode.parentNode);},connect:function(obj,_479,_47a){var _47b=_44a.connect(obj,_479,this,_47a);this._connects.push(_47b);return _47b;},disconnect:function(_47c){var i=_447.indexOf(this._connects,_47c);if(i!=-1){_47c.remove();this._connects.splice(i,1);}},subscribe:function(t,_47d){var _47e=_454.subscribe(t,lang.hitch(this,_47d));this._connects.push(_47e);return _47e;},unsubscribe:function(_47f){this.disconnect(_47f);},isLeftToRight:function(){return this.dir?(this.dir=="ltr"):_44f.isBodyLtr();},isFocusable:function(){return this.focus&&(_450.get(this.domNode,"display")!="none");},placeAt:function(_480,_481){if(_480.declaredClass&&_480.addChild){_480.addChild(this,_481);}else{_44e.place(this.domNode,_480,_481);}return this;},getTextDir:function(text,_482){return _482;},applyTextDir:function(){}});});},"dijit/form/Form":function(){define("dijit/form/Form",["dojo/_base/declare","dojo/dom-attr","dojo/_base/event","dojo/_base/kernel","dojo/_base/sniff","../_Widget","../_TemplatedMixin","./_FormMixin","../layout/_ContentPaneResizeMixin"],function(_483,_484,_485,_486,has,_487,_488,_489,_48a){return _483("dijit.form.Form",[_487,_488,_489,_48a],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"<form data-dojo-attach-point='containerNode' data-dojo-attach-event='onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}></form>",postMixInProperties:function(){this.nameAttrSetting=this.name?("name='"+this.name+"'"):"";this.inherited(arguments);},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(_48b){this.encType=_48b;_484.set(this.domNode,"encType",_48b);if(has("ie")){this.domNode.encoding=_48b;}},reset:function(e){var faux={returnValue:true,preventDefault:function(){this.returnValue=false;},stopPropagation:function(){},currentTarget:e?e.target:this.domNode,target:e?e.target:this.domNode};if(!(this.onReset(faux)===false)&&faux.returnValue){this.inherited(arguments,[]);}},onReset:function(){return true;},_onReset:function(e){this.reset(e);_485.stop(e);return false;},_onSubmit:function(e){var fp=this.constructor.prototype;if(this.execute!=fp.execute||this.onExecute!=fp.onExecute){_486.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0");this.onExecute();this.execute(this.getValues());}if(this.onSubmit(e)===false){_485.stop(e);}},onSubmit:function(){return this.isValid();},submit:function(){if(!(this.onSubmit()===false)){this.containerNode.submit();}}});});},"versa/api/PropertyDefinitions":function(){define("versa/api/PropertyDefinitions",["dojo/_base/declare","versa/api/_Collection","versa/api/PropertyDefinition"],function(_48c){var o=_48c("versa.api.PropertyDefinitions",[versa.api._Collection],{library:null,constructor:function(args){this.zone=args.zone;this.library=args.library;this.target=dojo.replace(versa.api.PropertyDefinitions.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.PropertyDefinition.schema;this.cache=true;this._initialize();},fetchByDbName:function(_48d){var _48e=null;function _48f(_490,_491){dojo.some(_490,function(item){if(item.getDbName()==_48d){_48e=item;return false;}},this);};this.store.fetch({query:{},queryOptions:{cache:true},onComplete:_48f});return _48e;},getNameProperty:function(){var _492=null;this.forEach(function(item){if(item.is_name){_492=item;}},this);return _492;}});o.TRGT="/zones/{0}/libraries/{1}/property_definitions";return o;});},"dojox/mobile/_ItemBase":function(){define("dojox/mobile/_ItemBase",["dojo/_base/kernel","dojo/_base/config","dojo/_base/declare","dijit/registry","dijit/_Contained","dijit/_Container","dijit/_WidgetBase","./TransitionEvent","./View"],function(_493,_494,_495,_496,_497,_498,_499,_49a,View){return _495("dojox.mobile._ItemBase",[_499,_498,_497],{icon:"",iconPos:"",alt:"",href:"",hrefTarget:"",moveTo:"",scene:"",clickable:false,url:"",urlTarget:"",transition:"",transitionDir:1,transitionOptions:null,callback:null,sync:true,label:"",toggle:false,_duration:800,inheritParams:function(){var _49b=this.getParent();if(_49b){if(!this.transition){this.transition=_49b.transition;}if(this.icon&&_49b.iconBase&&_49b.iconBase.charAt(_49b.iconBase.length-1)==="/"){this.icon=_49b.iconBase+this.icon;}if(!this.icon){this.icon=_49b.iconBase;}if(!this.iconPos){this.iconPos=_49b.iconPos;}}},select:function(){},deselect:function(){},defaultClickAction:function(e){if(this.toggle){if(this.selected){this.deselect();}else{this.select();}}else{if(!this.selected){this.select();if(!this.selectOne){var _49c=this;setTimeout(function(){_49c.deselect();},this._duration);}var _49d;if(this.moveTo||this.href||this.url||this.scene){_49d={moveTo:this.moveTo,href:this.href,url:this.url,scene:this.scene,transition:this.transition,transitionDir:this.transitionDir};}else{if(this.transitionOptions){_49d=this.transitionOptions;}}if(_49d){return new _49a(this.domNode,_49d,e).dispatch();}}}},getParent:function(){var ref=this.srcNodeRef||this.domNode;return ref&&ref.parentNode?_496.getEnclosingWidget(ref.parentNode):null;},setTransitionPos:function(e){var w=this;while(true){w=w.getParent();if(!w||w instanceof View){break;}}if(w){w.clickedPosX=e.clientX;w.clickedPosY=e.clientY;}},transitionTo:function(_49e,href,url,_49f){if(_494.isDebug){var _4a0=arguments.callee._ach||(arguments.callee._ach={}),_4a1=(arguments.callee.caller||"unknown caller").toString();if(!_4a0[_4a1]){_493.deprecated(this.declaredClass+"::transitionTo() is deprecated."+_4a1,"","2.0");_4a0[_4a1]=true;}}new _49a(this.domNode,{moveTo:_49e,href:href,url:url,scene:_49f,transition:this.transition,transitionDir:this.transitionDir}).dispatch();}});});},"versa/api/Versions":function(){define("versa/api/Versions",["dojo/_base/declare","versa/api/_Collection","versa/api/Version"],function(_4a2){var o=_4a2("versa.api.Versions",[versa.api._Collection],{zone:null,library:null,document:null,constructor:function(args){this.zone=args.zone;this.library=args.library;this.document=args.document;this.target=dojo.replace(versa.api.Versions.TRGT,[this.zone.subdomain,this.library.id,this.document.getId()]);this.schema=versa.api.Version.schema;this.cache=true;this._initialize();}});o.TRGT="/zones/{0}/libraries/{1}/documents/{2}/versions";return o;});},"versa/api/User":function(){define("versa/api/User",["dojo/_base/declare","dojo/date/stamp","versa/api/_Object"],function(_4a3){var o=_4a3("versa.api.User",[versa.api._Object],{email:null,first_name:null,last_name:null,group:null,reset_password:null,constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},getAvatarUrl:function(args){return dojo.replace(versa.api.User.AVT_TRGT,[args.zone.subdomain,this.id]);},getFullName:function(){var _4a4=(this.last_name==null)?"":this.last_name;if((this.first_name!=null)&&(this.first_name!="")){_4a4+=(_4a4=="")?this.first_name:", "+this.first_name;}return (_4a4.length<1)?this.name:_4a4;},isValid:function(){var _4a5=true;if(String.isEmpty(this.name)){_4a5=false;}if(this.name.length<4){_4a5=false;}if(this.name.indexOf(" ")>=0){_4a5=false;}if(!versa.api.Utilities.validateEmail(this.email)){_4a5=false;}if(this.password){if(String.isEmpty(this.password)||(this.password.length<8)){_4a5=false;}}if(String.isEmpty(this.email)){_4a5=false;}return _4a5;}});o.AVT_TRGT="/zones/{0}/users/{1}/avatar";o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":""},"email":{type:"string","default":""},"first_name":{type:"string","default":""},"last_name":{type:"string","default":""},"password":{type:"string","default":""},"active_group":{type:"integer","default":0},"created_at":{type:"string",format:"date-time","default":dojo.date.stamp.toISOString(new Date(),{zulu:true})},"created_by":{type:"string","default":""},"updated_at":{type:"string",format:"date-time","default":dojo.date.stamp.toISOString(new Date(),{zulu:true})},"updated_by":{type:"string","default":""}},prototype:new o()};return o;});},"versa/api/_Securable":function(){define("versa/api/_Securable",["dojo/_base/declare","versa/api/XhrHelper"],function(_4a6){var o=_4a6("versa.api._Securable",[],{securable_type:null,active_permissions:0,constructor:function(args){},hasRights:function(_4a7){return ((this.active_permissions&_4a7)==_4a7);},hasRole:function(role){return this.hasRights(role.permissions);},getAcl:function(zone){var url=dojo.replace(versa.api._Securable.GETACL_URL,[zone.subdomain,this.id,this.securable_type]);var _4a8=null;var _4a9=versa.api.XhrHelper.doGetAction({target:url,getData:_4a8});return new versa.api.Acl(_4a9);},setAcl:function(zone,acl){var url=dojo.replace(versa.api._Securable.SETACL_URL,[zone.subdomain,this.id,this.securable_type]);var data=acl;return versa.api.XhrHelper.doPutAction({target:url,putData:data});}});o.types={"Library":"Library","Folder":"Folder","Document":"Document","Reference":"Reference"};o.permissions={"NONE":0,"VIEW":1,"READ_METADATA":2,"WRITE_METADATA":4,"VERSION":8,"CREATE_DOCUMENTS":16,"CREATE_FOLDERS":32,"CREATE_VIEWS":64,"DELETE_ITEMS":128,"READ_ACL":256,"WRITE_ACL":512,"ADMIN":134217727};o.GETACL_URL="/zones/{0}/acls/{1}.json?securable_type={2}";o.SETACL_URL="/zones/{0}/acls/{1}.json?securable_type={2}";return o;});},"dojox/mobile/EdgeToEdgeList":function(){define("dojox/mobile/EdgeToEdgeList",["dojo/_base/declare","./RoundRectList"],function(_4aa,_4ab){return _4aa("dojox.mobile.EdgeToEdgeList",_4ab,{buildRendering:function(){this.inherited(arguments);this.domNode.className="mblEdgeToEdgeList";}});});},"dojo/regexp":function(){define("dojo/regexp",["./_base/kernel","./_base/lang"],function(dojo,lang){lang.getObject("regexp",true,dojo);dojo.regexp.escapeString=function(str,_4ac){return str.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(ch){if(_4ac&&_4ac.indexOf(ch)!=-1){return ch;}return "\\"+ch;});};dojo.regexp.buildGroupRE=function(arr,re,_4ad){if(!(arr instanceof Array)){return re(arr);}var b=[];for(var i=0;i<arr.length;i++){b.push(re(arr[i]));}return dojo.regexp.group(b.join("|"),_4ad);};dojo.regexp.group=function(_4ae,_4af){return "("+(_4af?"?:":"")+_4ae+")";};return dojo.regexp;});},"versa/widget/search/mobile/SearchView":function(){require(["dojo/_base/declare","dijit/_WidgetBase","dojox/mobile/Heading","dojox/mobile/ScrollableView","dojox/mobile/EdgeToEdgeDataList","dojox/mobile/ToolBarButton","dojox/mobile/ContentPane","versa/api/Folders","versa/api/Documents","versa/api/Zones","dojo/data/ItemFileWriteStore","dojo/date/locale"],function(_4b0){_4b0("versa.widget.search.mobile.SearchView",[dijit._WidgetBase,dojox.mobile.ScrollableView],{header:null,cpContent:null,constructor:function(args){},_setBackAttr:function(back){this.back=back;if(this.header){this.header.set("back",back);}},postCreate:function(){this.inherited("postCreate",arguments);this.header=new versa.widget.mobile.Heading({label:"Search",from:this,back:this.back,backTransition:"slidev",onCommand:this.onCommand});this.footer=new versa.widget.mobile.Footing({showSearch:false,onCommand:this.onCommand,from:this});this.cpContent=new dojox.mobile.ContentPane({content:dojo.cache("versa.widget.search.mobile","template/SearchView.html","<div style=\"width: 100%; height: 100%; text-align: center;\">\n    <input id=\"searchField\"   data-dojo-type=\"versa.widget.mobile.TextBox\"/>\n    <button id=\"searchButton\" data-dojo-type=\"dojox.mobile.Button\">Search</button>\n</div>\n"),parseOnLoad:true});this.searchField=dijit.byId("searchField");this.searchButton=dijit.byId("searchButton");dojo.connect(this.searchButton,"onClick",dojo.hitch(this,function(){this.onCommand(versa.widget.zone.mobile.Show.COMMANDS.PERFORM_SEARCH,{search:this.searchField.get("value")});}));this.addChild(this.cpContent);this.addChild(this.footer);this.addChild(this.header);},startup:function(){this.inherited("startup",arguments);}});});},"versa/api/ViewDefinition":function(){define("versa/api/ViewDefinition",["dojo/_base/declare","versa/api/_Object","versa/api/Error","versa/api/Formatter"],function(_4b1){var o=_4b1("versa.api.ViewDefinition",[versa.api._Object],{_view:null,constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},_generate:function(_4b2){var view={name:this.name,id:this.getId(),sort_column:1,cells:[]};dojo.forEach(this.cell_definitions,function(item,idx){var cell={field:dojo.replace("{table_name}.{column_name}",item),name:String.isBlank(item.label)?"&nbsp;":item.label,width:item.width,noresize:item.noresize,style:item.style,date_format:item.date_format};cell.get=this._generateGetFn(item,_4b2);cell.formatter=this._generateFormatterFn(item);view.cells.push(cell);if(cell.field==this.sort_by){view.sort_column=(this.is_desc)?((idx+1)*-1):(idx+1);}},this);return view;},_generateFormatterFn:function(_4b3){var fn=versa.api.CellDefinition.formatData;if(_4b3.column_name.indexOf("prp_bln")>=0){fn=versa.api.CellDefinition.formatBoolean;}switch(_4b3.formatter){case versa.api.CellDefinition.formats.icon:fn=versa.api.CellDefinition.formatIcon;break;case versa.api.CellDefinition.formats.size:fn=versa.api.CellDefinition.formatSize;break;case versa.api.CellDefinition.formats.status:fn=versa.api.CellDefinition.formatStatus;break;}return fn;},_generateGetFn:function(_4b4,_4b5){var fn=null;switch(_4b4.table_name){case "versions":fn=dojo.hitch([this,_4b4],versa.api.ViewDefinition._getVersionAttrFn);break;case "documents":fn=dojo.hitch([this,_4b4],versa.api.ViewDefinition._getDocumentAttrFn);break;case "document_types":fn=dojo.hitch([this,_4b4,_4b5],versa.api.ViewDefinition._getDocumentTypeAttrFn);break;}return fn;},_formatDateTime:function(_4b6,_4b7){return versa.api.Formatter.formatDateTime(_4b7);},getCellByField:function(_4b8){var cell=null;dojo.some(this.cell_definitions,function(_4b9,idx){if(versa.api.CellDefinition.getDbName(_4b9)==_4b8){cell=_4b9;}return (cell);},this);return cell;},getView:function(_4ba){return this._generate(_4ba);},isValid:function(){var _4bb=true;if(String.isEmpty(this.name.trim())){_4bb=false;}if(String.isEmpty(this.sort_by)){_4bb=false;}return _4bb;},findColumn:function(_4bc,_4bd){for(var i=0;i<this.cell_definitions.length;i++){if(this.cell_definitions[i].table_name&&this.cell_definitions[i].column_name&&_4bc==this.cell_definitions[i].table_name&&_4bd==this.cell_definitions[i].column_name){return this.cell_definitions[i];}}return null;}});o.getCustomName=function(user,_4be){return dojo.replace("{0}.{1}",[user.name,_4be.name]);};o._getDocumentAttrFn=function(_4bf,item){var _4c0="";var _4c1=this[0];var _4c2=this[1];if(!item){return _4c0;}var _4c3=_4c2.column_name;switch(_4c3){case "created_at":case "updated_at":_4c0=_4c1._formatDateTime(_4c2,item[_4c3]);break;default:if(/prp_dtt/.test(_4c3)&&item[_4c3]){_4c0=_4c1._formatDateTime(_4c2,item[_4c3]);}else{_4c0=item[_4c3];}break;}return _4c0;};o._getDocumentTypeAttrFn=function(_4c4,item){var _4c5="";var _4c6=this[0];var _4c7=this[1];var _4c8=this[2];if((!item)){return _4c5;}switch(_4c7.column_name){case "name":_4c5=item.document_type_name;break;}return _4c5;};o._getVersionAttrFn=function(_4c9,item){var _4ca=null;var _4cb=this[0];var _4cc=this[1];if(!item){return _4ca;}try{switch(_4cc.column_name){case "binary_content_type":_4ca=item.binary_content_type;break;case "version_number":_4ca=item.major_version_number;break;case "binary_file_size":_4ca=item.binary_file_size;break;}}catch(e){}return (!_4ca)?"":_4ca;};o.compare=function(_4cd,_4ce){if((!_4cd)&&(_4ce)){return -1;}if((_4cd)&&(!_4ce)){return 1;}if((!_4cd)&&(!_4ce)){return 0;}if((!_4cd.name)&&(_4ce.name)){return -1;}if((_4cd.name)&&(!_4ce.name)){return 1;}if((!_4cd.name)&&(!_4ce.name)){return 0;}if(_4cd.name.toLowerCase()==_4ce.name.toLowerCase()){return 0;}return (_4cd.name.toLowerCase()<_4ce.name.toLowerCase())?-1:1;};o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string"},"description":{type:"string"},"is_desc":{type:"boolean","default":false},"is_template":{type:"boolean","default":false},"scope":{type:"string","default":"*"},"sort_by":{type:"string"},"cell_definitions":{type:"array","default":[],"items":{type:"object",properties:{"table_name":{type:"string"},"column_name":{type:"string"},"name":{type:"string"},"label":{type:"string"},"column_order":{type:"integer"},"formatter":{type:"integer"},"date_format":{type:"string"},"width":{type:"string"}}}},"created_at":{type:"date",format:"date-time"},"created_by":{type:"string","default":""},"updated_at":{type:"date",format:"date-time"},"updated_by":{type:"string","default":""}},prototype:o.prototype};return o;});},"dijit/form/_FormMixin":function(){define("dijit/form/_FormMixin",["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/window"],function(_4cf,_4d0,_4d1,lang,_4d2){return _4d0("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(_4d3){var res=[];_4cf.forEach(_4d3||this.getChildren(),function(_4d4){if("value" in _4d4){res.push(_4d4);}else{res=res.concat(this._getDescendantFormWidgets(_4d4.getChildren()));}},this);return res;},reset:function(){_4cf.forEach(this._getDescendantFormWidgets(),function(_4d5){if(_4d5.reset){_4d5.reset();}});},validate:function(){var _4d6=false;return _4cf.every(_4cf.map(this._getDescendantFormWidgets(),function(_4d7){_4d7._hasBeenBlurred=true;var _4d8=_4d7.disabled||!_4d7.validate||_4d7.validate();if(!_4d8&&!_4d6){_4d2.scrollIntoView(_4d7.containerNode||_4d7.domNode);_4d7.focus();_4d6=true;}return _4d8;}),function(item){return item;});},setValues:function(val){_4d1.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",val);},_setValueAttr:function(obj){var map={};_4cf.forEach(this._getDescendantFormWidgets(),function(_4d9){if(!_4d9.name){return;}var _4da=map[_4d9.name]||(map[_4d9.name]=[]);_4da.push(_4d9);});for(var name in map){if(!map.hasOwnProperty(name)){continue;}var _4db=map[name],_4dc=lang.getObject(name,false,obj);if(_4dc===undefined){continue;}if(!lang.isArray(_4dc)){_4dc=[_4dc];}if(typeof _4db[0].checked=="boolean"){_4cf.forEach(_4db,function(w){w.set("value",_4cf.indexOf(_4dc,w.value)!=-1);});}else{if(_4db[0].multiple){_4db[0].set("value",_4dc);}else{_4cf.forEach(_4db,function(w,i){w.set("value",_4dc[i]);});}}}},getValues:function(){_4d1.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value");},_getValueAttr:function(){var obj={};_4cf.forEach(this._getDescendantFormWidgets(),function(_4dd){var name=_4dd.name;if(!name||_4dd.disabled){return;}var _4de=_4dd.get("value");if(typeof _4dd.checked=="boolean"){if(/Radio/.test(_4dd.declaredClass)){if(_4de!==false){lang.setObject(name,_4de,obj);}else{_4de=lang.getObject(name,false,obj);if(_4de===undefined){lang.setObject(name,null,obj);}}}else{var ary=lang.getObject(name,false,obj);if(!ary){ary=[];lang.setObject(name,ary,obj);}if(_4de!==false){ary.push(_4de);}}}else{var prev=lang.getObject(name,false,obj);if(typeof prev!="undefined"){if(lang.isArray(prev)){prev.push(_4de);}else{lang.setObject(name,[prev,_4de],obj);}}else{lang.setObject(name,_4de,obj);}}});return obj;},isValid:function(){return this.state=="";},onValidStateChange:function(){},_getState:function(){var _4df=_4cf.map(this._descendants,function(w){return w.get("state")||"";});return _4cf.indexOf(_4df,"Error")>=0?"Error":_4cf.indexOf(_4df,"Incomplete")>=0?"Incomplete":"";},disconnectChildren:function(){_4cf.forEach(this._childConnections||[],lang.hitch(this,"disconnect"));_4cf.forEach(this._childWatches||[],function(w){w.unwatch();});},connectChildren:function(_4e0){var _4e1=this;this.disconnectChildren();this._descendants=this._getDescendantFormWidgets();var set=_4e0?function(name,val){_4e1[name]=val;}:lang.hitch(this,"_set");set("value",this.get("value"));set("state",this._getState());var _4e2=(this._childConnections=[]),_4e3=(this._childWatches=[]);_4cf.forEach(_4cf.filter(this._descendants,function(item){return item.validate;}),function(_4e4){_4cf.forEach(["state","disabled"],function(attr){_4e3.push(_4e4.watch(attr,function(){_4e1.set("state",_4e1._getState());}));});});var _4e5=function(){if(_4e1._onChangeDelayTimer){clearTimeout(_4e1._onChangeDelayTimer);}_4e1._onChangeDelayTimer=setTimeout(function(){delete _4e1._onChangeDelayTimer;_4e1._set("value",_4e1.get("value"));},10);};_4cf.forEach(_4cf.filter(this._descendants,function(item){return item.onChange;}),function(_4e6){_4e2.push(_4e1.connect(_4e6,"onChange",_4e5));_4e3.push(_4e6.watch("disabled",_4e5));});},startup:function(){this.inherited(arguments);this.connectChildren(true);this.watch("state",function(attr,_4e7,_4e8){this.onValidStateChange(_4e8=="");});},destroy:function(){this.disconnectChildren();this.inherited(arguments);}});});},"dojo/data/util/simpleFetch":function(){define("dojo/data/util/simpleFetch",["dojo/_base/lang","dojo/_base/window","./sorter"],function(lang,_4e9,_4ea){var _4eb=lang.getObject("dojo.data.util.simpleFetch",true);_4eb.fetch=function(_4ec){_4ec=_4ec||{};if(!_4ec.store){_4ec.store=this;}var self=this;var _4ed=function(_4ee,_4ef){if(_4ef.onError){var _4f0=_4ef.scope||_4e9.global;_4ef.onError.call(_4f0,_4ee,_4ef);}};var _4f1=function(_4f2,_4f3){var _4f4=_4f3.abort||null;var _4f5=false;var _4f6=_4f3.start?_4f3.start:0;var _4f7=(_4f3.count&&(_4f3.count!==Infinity))?(_4f6+_4f3.count):_4f2.length;_4f3.abort=function(){_4f5=true;if(_4f4){_4f4.call(_4f3);}};var _4f8=_4f3.scope||_4e9.global;if(!_4f3.store){_4f3.store=self;}if(_4f3.onBegin){_4f3.onBegin.call(_4f8,_4f2.length,_4f3);}if(_4f3.sort){_4f2.sort(_4ea.createSortFunction(_4f3.sort,self));}if(_4f3.onItem){for(var i=_4f6;(i<_4f2.length)&&(i<_4f7);++i){var item=_4f2[i];if(!_4f5){_4f3.onItem.call(_4f8,item,_4f3);}}}if(_4f3.onComplete&&!_4f5){var _4f9=null;if(!_4f3.onItem){_4f9=_4f2.slice(_4f6,_4f7);}_4f3.onComplete.call(_4f8,_4f9,_4f3);}};this._fetchItems(_4ec,_4f1,_4ed);return _4ec;};return _4eb;});},"dojox/mobile/ProgressIndicator":function(){define("dojox/mobile/ProgressIndicator",["dojo/_base/config","dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dojo/has"],function(_4fa,_4fb,_4fc,_4fd,has){var cls=_4fb("dojox.mobile.ProgressIndicator",null,{interval:100,colors:["#C0C0C0","#C0C0C0","#C0C0C0","#C0C0C0","#C0C0C0","#C0C0C0","#B8B9B8","#AEAFAE","#A4A5A4","#9A9A9A","#8E8E8E","#838383"],constructor:function(){this._bars=[];this.domNode=_4fc.create("DIV");this.domNode.className="mblProgContainer";if(_4fa["mblAndroidWorkaround"]!==false&&has("android")>=2.2&&has("android")<3){_4fd.set(this.domNode,"webkitTransform","translate3d(0,0,0)");}this.spinnerNode=_4fc.create("DIV",null,this.domNode);for(var i=0;i<this.colors.length;i++){var div=_4fc.create("DIV",{className:"mblProg mblProg"+i},this.spinnerNode);this._bars.push(div);}},start:function(){if(this.imageNode){var img=this.imageNode;var l=Math.round((this.domNode.offsetWidth-img.offsetWidth)/2);var t=Math.round((this.domNode.offsetHeight-img.offsetHeight)/2);img.style.margin=t+"px "+l+"px";return;}var cntr=0;var _4fe=this;var n=this.colors.length;this.timer=setInterval(function(){cntr--;cntr=cntr<0?n-1:cntr;var c=_4fe.colors;for(var i=0;i<n;i++){var idx=(cntr+i)%n;_4fe._bars[i].style.backgroundColor=c[idx];}},this.interval);},stop:function(){if(this.timer){clearInterval(this.timer);}this.timer=null;if(this.domNode.parentNode){this.domNode.parentNode.removeChild(this.domNode);}},setImage:function(file){if(file){this.imageNode=_4fc.create("IMG",{src:file},this.domNode);this.spinnerNode.style.display="none";}else{if(this.imageNode){this.domNode.removeChild(this.imageNode);this.imageNode=null;}this.spinnerNode.style.display="";}}});cls._instance=null;cls.getInstance=function(){if(!cls._instance){cls._instance=new cls();}return cls._instance;};return cls;});},"versa/api/Folders":function(){define("versa/api/Folders",["dojo/_base/declare","versa/api/_Collection","versa/api/Folder","versa/api/Utilities"],function(_4ff){var o=_4ff("versa.api.Folders",[versa.api._Collection],{library:null,_getExistingNames:function(_500){var _501=[];if((_500)&&(_500.children)){dojo.forEach(_500.children,function(_502){_501.push(_502.name);});}return _501;},constructor:function(args){this.zone=args.zone;this.library=args.library;this.target=dojo.replace(versa.api.Folders.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.Folder.schema;this.cache=true;this._initialize();},generateUniqueName:function(args){var _503=this._getExistingNames(args.parent);var _504=args.base_name;return versa.api.Utilities.generateUniqueName({names:_503,base_name:_504});},getTextPath:function(args){var item=args.item;if(item.parent_id){var _505=this.fetchById({id:item.parent_id});return this.getTextPath({item:_505})+"/"+item.name;}else{return "/"+item.name;}}});o.TRGT="/zones/{0}/libraries/{1}/folders";o.generateUniqueName=function(args){var _506=args.folder;var _507=[];dojo.forEach(_506.children,function(_508){_507.push(_508.name);});return versa.api.Utilities.generateUniqueName({names:_507,base_name:args.base_name});};return o;});},"versa/api/XhrHelper":function(){define("versa/api/XhrHelper",["dojo/_base/declare","dojox/json/ref","versa/api/Error"],function(_509){var o=_509("versa.api.XhrHelper",[],{});o._doXhrAction=function(_50a,args){var rsp=null;var err=null;function _50b(_50c,_50d){rsp=_50c;};function _50e(_50f,_510){err=new versa.api.Error(_50f.responseText,_50f);};args.contentType="application/json";args.handleAs="json";args.sync=true;args.load=_50b;args.error=_50e;_50a(args);if(err!=null){throw err;}return rsp;};o.doGetAction=function(args){var _511=(args.getData)?dojo.toJson(args.getData):null;var _512={url:args.target,content:_511};return versa.api.XhrHelper._doXhrAction(dojo.xhrGet,_512);};o.doPostAction=function(args){var _513=args.postData;var _514=dojo.toJson(_513);var _515={url:args.target,postData:_514};return versa.api.XhrHelper._doXhrAction(dojo.xhrPost,_515);};o.doPutAction=function(args){var _516=args.putData;var _517=dojo.toJson(_516);var _518={url:args.target,putData:_517};return versa.api.XhrHelper._doXhrAction(dojo.xhrPut,_518);};o.authenticity_token=null;o.originalXhr=dojo.xhr;dojo.xhr=function(_519,_51a,_51b){if(versa.api.XhrHelper.authenticity_token!=null){if(_519.toUpperCase()=="POST"){var _51c=(_51a.postData)?dojo.fromJson(_51a.postData):{};_51c["authenticity_token"]=versa.api.XhrHelper.authenticity_token;_51a.postData=dojo.toJson(_51c);}if(_519.toUpperCase()=="PUT"){var _51d=(_51a.putData)?dojo.fromJson(_51a.putData):{};_51d["authenticity_token"]=versa.api.XhrHelper.authenticity_token;_51a.putData=dojo.toJson(_51d);}if(_519.toUpperCase()=="DELETE"){_51a.rawBody=dojo.toJson({authenticity_token:versa.api.XhrHelper.authenticity_token});}}if((_51a.headers)&&_51a.headers.hasOwnProperty("Range")){_51a.headers["dojo-Range"]=_51a.headers["Range"];}return versa.api.XhrHelper.originalXhr(_519,_51a,_51b);};return o;});},"dijit/layout/utils":function(){define("dijit/layout/utils",["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang",".."],function(_51e,_51f,_520,_521,lang,_522){var _523=lang.getObject("layout",true,_522);_523.marginBox2contentBox=function(node,mb){var cs=_521.getComputedStyle(node);var me=_520.getMarginExtents(node,cs);var pb=_520.getPadBorderExtents(node,cs);return {l:_521.toPixelValue(node,cs.paddingLeft),t:_521.toPixelValue(node,cs.paddingTop),w:mb.w-(me.w+pb.w),h:mb.h-(me.h+pb.h)};};function _524(word){return word.substring(0,1).toUpperCase()+word.substring(1);};function size(_525,dim){var _526=_525.resize?_525.resize(dim):_520.setMarginBox(_525.domNode,dim);if(_526){lang.mixin(_525,_526);}else{lang.mixin(_525,_520.getMarginBox(_525.domNode));lang.mixin(_525,dim);}};_523.layoutChildren=function(_527,dim,_528,_529,_52a){dim=lang.mixin({},dim);_51f.add(_527,"dijitLayoutContainer");_528=_51e.filter(_528,function(item){return item.region!="center"&&item.layoutAlign!="client";}).concat(_51e.filter(_528,function(item){return item.region=="center"||item.layoutAlign=="client";}));_51e.forEach(_528,function(_52b){var elm=_52b.domNode,pos=(_52b.region||_52b.layoutAlign);if(!pos){throw new Error("No region setting for "+_52b.id);}var _52c=elm.style;_52c.left=dim.l+"px";_52c.top=dim.t+"px";_52c.position="absolute";_51f.add(elm,"dijitAlign"+_524(pos));var _52d={};if(_529&&_529==_52b.id){_52d[_52b.region=="top"||_52b.region=="bottom"?"h":"w"]=_52a;}if(pos=="top"||pos=="bottom"){_52d.w=dim.w;size(_52b,_52d);dim.h-=_52b.h;if(pos=="top"){dim.t+=_52b.h;}else{_52c.top=dim.t+dim.h+"px";}}else{if(pos=="left"||pos=="right"){_52d.h=dim.h;size(_52b,_52d);dim.w-=_52b.w;if(pos=="left"){dim.l+=_52b.w;}else{_52c.left=dim.l+dim.w+"px";}}else{if(pos=="client"||pos=="center"){size(_52b,dim);}}}});};return {marginBox2contentBox:_523.marginBox2contentBox,layoutChildren:_523.layoutChildren};});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_52e,_52f){return _52e("dijit._Contained",null,{_getSibling:function(_530){var node=this.domNode;do{node=node[_530+"Sibling"];}while(node&&node.nodeType!=1);return node&&_52f.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"versa/api/Document":function(){define("versa/api/Document",["dojo/_base/declare","dojox/json/ref","versa/api/_Object","versa/api/_Securable","versa/api/Acl","versa/api/Application","versa/api/Utilities","versa/api/Versions","versa/api/PermissionSet"],function(_531){var o=_531("versa.api.Document",[versa.api._Object,versa.api._Securable],{zone:null,library:null,checked_out_by:"",document_type_id:null,library:null,state:0,clean_properties:function(args){var _532=args.library;var _533=_532.getDocumentTypes().fetchById({id:this.document_type_id});for(var p in this){if(!dojo.isFunction(this[p])){var _534=dojo.replace("documents.{0}",[p]);var _535=_532.getPropertyDefinitions().fetchByDbName(_534);if((_535)&&(!_535.is_system)){if(!_533.hasProperty(_535.id)){delete this[p];}}}}},constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));this.securable_type=versa.api._Securable.types.Document;if((this.created_at!=null)&&(typeof this.created_at=="string")){this.created_at=dojo.date.stamp.fromISOString(this.created_at);}if((this.updated_at!=null)&&(typeof this.updated_at=="string")){this.updated_at=dojo.date.stamp.fromISOString(this.created_at);}},copyLocal:function(args){var zone=args.zone;var _536=args.library;var url=dojo.replace(versa.api.Document.CP_TRGT,[zone.subdomain,_536.id,this.getId()]);versa.api.Utilities.saveUrl({url:url,window_name:"versa_save"});},file:function(args){var zone=args.zone;var _537=args.library;var url=dojo.replace(versa.api.Document.FILE_TRGT,[zone.subdomain,_537.id,this.getId()]);var _538={folder_id:args.folder.id};var _539=versa.api.XhrHelper.doPutAction({target:url,putData:_538});return true;},getFullVersion:function(){return this.major_version_number;},getPermissionSet:function(_53a,_53b,user){var _53c=new versa.api.PermissionSet();_53c.setValue(versa.api.PermissionIndices.VIEW,this.hasRights(versa.api._Securable.permissions.VIEW));_53c.setValue(versa.api.PermissionIndices.COPY,this.hasRights(versa.api._Securable.permissions.VIEW));_53c.setValue(versa.api.PermissionIndices.EDIT,this.hasRights(versa.api._Securable.permissions.WRITE_METADATA));_53c.setValue(versa.api.PermissionIndices.MOVE,_53c.getValue(versa.api.PermissionIndices.EDIT));_53c.setValue(versa.api.PermissionIndices.CKO,(this.hasRights(versa.api._Securable.permissions.VERSION)&&this.getState(versa.api.Document.states.CHECKED_IN)));_53c.setValue(versa.api.PermissionIndices.CKI,(this.hasRights(versa.api._Securable.permissions.VERSION)&&this.getState(versa.api.Document.states.CHECKED_OUT)&&(this.checked_out_by==user.name)));_53c.setValue(versa.api.PermissionIndices.CANCEL_CKO,_53c.getValue(versa.api.PermissionIndices.CKI));_53c.setValue(versa.api.PermissionIndices.DELETE,this.hasRights(versa.api._Securable.permissions.DELETE_ITEMS));_53c.setValue(versa.api.PermissionIndices.SECURE,this.hasRights(versa.api._Securable.permissions.WRITE_ACL));_53c.setValue(versa.api.PermissionIndices.RESTORE,this.hasRights(versa.api._Securable.permissions.DELETE_ITEMS));_53c.setValue(versa.api.PermissionIndices.DESTROY,this.hasRights(versa.api._Securable.permissions.DELETE_ITEMS));return _53c;},getState:function(_53d){return versa.api.Document._isState(this.state,_53d);},getVersions:function(args){if(!this._versions){this._versions=new versa.api.Versions({zone:args.zone,library:args.library,document:this});}return this._versions;},isDeleted:function(){return this.getState(versa.api.Document.states.DELETED);},restore:function(args){var zone=args.zone;var _53e=args.library;var url=dojo.replace(versa.api.Document.RESTORE_TRGT,[zone.subdomain,_53e.getId(),this.getId()]);var _53f={};var _540=versa.api.XhrHelper.doPutAction({target:url,putData:_53f});return true;},setState:function(_541,_542){if(_542){this.state=this.state|_541;}else{this.state=this.state&~_541;}return this.state;},unfile:function(args){var zone=args.zone;var _543=args.library;var url=dojo.replace(versa.api.Document.UNFILE_TRGT,[zone.subdomain,_543.id,this.id]);var _544={};var _545=versa.api.XhrHelper.doPutAction({target:url,putData:_544});return true;},validate:function(args){if(!this.document_type_id){this.state|=versa.api.Document.states.INVALID;return false;}var _546=args.library.getDocumentTypes().fetchById({id:this.document_type_id});var _547=args.library.getPropertyDefinitions();var _548=versa.api.Application.getDataTypes();var _549=dojo.every(_546.property_mappings,function(item,idx){var _54a=true;if(item.is_required){var _54b=_547.fetchById({id:item.property_definition_id});var _54c=_548.fetchById({id:_54b.data_type_id});if(!_54b){return false;}var _54d=this[_54b.column_name];if(_54c.isString()){_54a=!String.isEmpty(_54d);}}return _54a;},this);this.setState(versa.api.Document.states.INVALID,!_549);return _549;},getViewUrl:function(zone,_54e){return dojo.replace(versa.api.Document.VW_TRGT,[zone.subdomain,_54e.id,this.getId()]);},view:function(args){var zone=args.zone;var _54f=args.library;var url=this.getViewUrl(zone,_54f);versa.api.Utilities.viewUrl({windowBox:args.windowBox,url:url,window_name:"versa_viewer"});}});o.getIconUrl=function(_550,size){return dojo.replace("/icons/{0}?size={1}",[encodeURIComponent(_550),size]);};o._isState=function(_551,_552){return ((_551&_552)==_552);};o.getStateIcon=function(_553){var icon="none.16.png";if(versa.api.Document._isState(_553,versa.api.Document.states.ERROR)){icon="error.16.png";}else{if(versa.api.Document._isState(_553,versa.api.Document.states.INVALID)){icon="invalid.16.png";}else{if(versa.api.Document._isState(_553,versa.api.Document.states.CHECKED_IN)){icon="cki.16.png";}else{if(versa.api.Document._isState(_553,versa.api.Document.states.PENDING)){icon="pending.16.gif";}else{if(versa.api.Document._isState(_553,versa.api.Document.states.UPLOADED)){icon="uploaded.16.png";}}}}}return icon;};o.getStateMessage=function(_554){var msg="";if(versa.api.Document._isState(_554,versa.api.Document.states.ERROR)){msg="An error occurred";}else{if(versa.api.Document._isState(_554,versa.api.Document.states.INVALID)){msg="The file contains missing or invalid property values";}else{if(versa.api.Document._isState(_554,versa.api.Document.states.CHECKED_IN)){msg="The file has been added to VersaFile";}else{if(versa.api.Document._isState(_554,(versa.api.Document.states.PENDING|versa.api.Document.states.UPLOADED))){msg="The file is being added to VersaFile";}else{if(versa.api.Document._isState(_554,versa.api.Document.states.PENDING)){msg="Uploading...";}else{if(versa.api.Document._isState(_554,versa.api.Document.states.UPLOADED)){msg="The file has been uploaded and is ready for checkin";}}}}}}return msg;};o.VW_TRGT="/zones/{0}/libraries/{1}/documents/{2}/download/?disposition=inline";o.CP_TRGT="/zones/{0}/libraries/{1}/documents/{2}/download/?disposition=attachment";o.CKO_TRGT="/zones/{0}/libraries/{1}/documents/{2}/checkout.json";o.CKI_TRGT="/zones/{0}/libraries/{1}/documents/{2}/checkin.json";o.XCKO_TRGT="/zones/{0}/libraries/{1}/documents/{2}/cancel_checkout.json";o.FILE_TRGT="/zones/{0}/libraries/{1}/documents/{2}/file.json";o.UNFILE_TRGT="/zones/{0}/libraries/{1}/documents/{2}/unfile.json";o.RESTORE_TRGT="/zones/{0}/libraries/{1}/documents/{2}/restore.json";o.SDEL_TRGT="/zones/{0}/libraries/{1}/documents/{2}/soft_delete.json";o.states={"NONE":0,"PENDING":1,"UPLOADED":2,"BUSY":4,"INDEXED":16,"CHECKED_IN":32,"CHECKED_OUT":64,"INVALID":1024,"DELETED":2048,"ERROR":32768};o.schema={type:"object",properties:{"id":{type:"integer"},"document_type_id":{type:"integer"},"name":{type:"string","default":"","required":true},"created_at":{type:["string","object","null"],format:"date-time"},"created_by":{type:["string","null"],"default":""},"checked_out_by":{type:["string","null"]},"state":{type:"integer","default":o.PENDING},"updated_at":{type:["string","object","null"],format:"date-time"},"updated_by":{type:["string","null"],"default":""},"prp_dtt001":{type:["string","object","null"],format:"date-time"},"prp_dtt002":{type:["string","object","null"],format:"date-time"},"prp_dtt003":{type:["string","object","null"],format:"date-time"},"prp_dtt004":{type:["string","object","null"],format:"date-time"},"prp_dtt005":{type:["string","object","null"],format:"date-time"},"prp_dtt006":{type:["string","object","null"],format:"date-time"},"prp_dtt007":{type:["string","object","null"],format:"date-time"},"prp_dtt008":{type:["string","object","null"],format:"date-time"}},prototype:new o()};return o;});},"versa/api/Preference":function(){define("versa/api/Preference",["dojo/_base/declare","versa/api/_Object","dojo/data/ItemFileReadStore"],function(_555){var o=_555("versa.api.Preference",[versa.api._Object],{constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));}});o.dateEntryFormats={_date:1,_time:2,_datetime:3};o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string"},"value":{type:"string"},"created_at":{type:"date",format:"date-time"},"created_by":{type:"string","default":""},"updated_at":{type:"date",format:"date-time"},"updated_by":{type:"string","default":""}}};return o;});},"dojox/mobile/sniff":function(){define("dojox/mobile/sniff",["dojo/_base/window","dojo/_base/sniff"],function(win,has){var ua=navigator.userAgent;has.add("bb",ua.indexOf("BlackBerry")>=0&&parseFloat(ua.split("Version/")[1])||undefined,undefined,true);has.add("android",parseFloat(ua.split("Android ")[1])||undefined,undefined,true);if(ua.match(/(iPhone|iPod|iPad)/)){var p=RegExp.$1.replace(/P/,"p");var v=ua.match(/OS ([\d_]+)/)?RegExp.$1:"1";var os=parseFloat(v.replace(/_/,".").replace(/_/g,""));has.add(p,os,undefined,true);has.add("iphone",os,undefined,true);}if(has("webkit")){has.add("touch",(typeof win.doc.documentElement.ontouchstart!="undefined"&&navigator.appVersion.indexOf("Mobile")!=-1)||!!has("android"),undefined,true);}return has;});},"dijit/_Container":function(){define("dijit/_Container",["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","./registry"],function(_556,_557,_558,_559){return _557("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}},addChild:function(_55a,_55b){var _55c=this.containerNode;if(_55b&&typeof _55b=="number"){var _55d=this.getChildren();if(_55d&&_55d.length>=_55b){_55c=_55d[_55b-1].domNode;_55b="after";}}_558.place(_55a.domNode,_55c,_55b);if(this._started&&!_55a._started){_55a.startup();}},removeChild:function(_55e){if(typeof _55e=="number"){_55e=this.getChildren()[_55e];}if(_55e){var node=_55e.domNode;if(node&&node.parentNode){node.parentNode.removeChild(node);}}},hasChildren:function(){return this.getChildren().length>0;},_getSiblingOfChild:function(_55f,dir){var node=_55f.domNode,_560=(dir>0?"nextSibling":"previousSibling");do{node=node[_560];}while(node&&(node.nodeType!=1||!_559.byNode(node)));return node&&_559.byNode(node);},getIndexOfChild:function(_561){return _556.indexOf(this.getChildren(),_561);}});});},"dojo/data/ItemFileReadStore":function(){define("dojo/data/ItemFileReadStore",["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","../_base/window","./util/filter","./util/simpleFetch","../date/stamp"],function(_562,lang,_563,_564,xhr,_565,_566,_567,_568,_569){var _56a=_563("dojo.data.ItemFileReadStore",[_565],{constructor:function(_56b){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_56b.url;this._ccUrl=_56b.url;this.url=_56b.url;this._jsonData=_56b.data;this.data=null;this._datatypeMap=_56b.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_56c){return _569.fromISOString(_56c);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_56b.urlPreventCache!==undefined){this.urlPreventCache=_56b.urlPreventCache?true:false;}if(_56b.hierarchical!==undefined){this.hierarchical=_56b.hierarchical?true:false;}if(_56b.clearOnClose){this.clearOnClose=true;}if("failOk" in _56b){this.failOk=_56b.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error("dojo.data.ItemFileReadStore: Invalid item argument.");}},_assertIsAttribute:function(_56d){if(typeof _56d!=="string"){throw new Error("dojo.data.ItemFileReadStore: Invalid attribute argument.");}},getValue:function(item,_56e,_56f){var _570=this.getValues(item,_56e);return (_570.length>0)?_570[0]:_56f;},getValues:function(item,_571){this._assertIsItem(item);this._assertIsAttribute(_571);return (item[_571]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _572=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_572.push(key);}}return _572;},hasAttribute:function(item,_573){this._assertIsItem(item);this._assertIsAttribute(_573);return (_573 in item);},containsValue:function(item,_574,_575){var _576=undefined;if(typeof _575==="string"){_576=_567.patternToRegExp(_575,false);}return this._containsValue(item,_574,_575,_576);},_containsValue:function(item,_577,_578,_579){return _564.some(this.getValues(item,_577),function(_57a){if(_57a!==null&&!lang.isObject(_57a)&&_579){if(_57a.toString().match(_579)){return true;}}else{if(_578===_57a){return true;}}});},isItem:function(_57b){if(_57b&&_57b[this._storeRefPropName]===this){if(this._arrayOfAllItems[_57b[this._itemNumPropName]]===_57b){return true;}}return false;},isItemLoaded:function(_57c){return this.isItem(_57c);},loadItem:function(_57d){this._assertIsItem(_57d.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},_fetchItems:function(_57e,_57f,_580){var self=this,_581=function(_582,_583){var _584=[],i,key;if(_582.query){var _585,_586=_582.queryOptions?_582.queryOptions.ignoreCase:false;var _587={};for(key in _582.query){_585=_582.query[key];if(typeof _585==="string"){_587[key]=_567.patternToRegExp(_585,_586);}else{if(_585 instanceof RegExp){_587[key]=_585;}}}for(i=0;i<_583.length;++i){var _588=true;var _589=_583[i];if(_589===null){_588=false;}else{for(key in _582.query){_585=_582.query[key];if(!self._containsValue(_589,key,_585,_587[key])){_588=false;}}}if(_588){_584.push(_589);}}_57f(_584,_582);}else{for(i=0;i<_583.length;++i){var item=_583[i];if(item!==null){_584.push(item);}}_57f(_584,_582);}};if(this._loadFinished){_581(_57e,this._getItemsArray(_57e.queryOptions));}else{if(this._jsonFileUrl!==this._ccUrl){_562.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_57e,filter:_581});}else{this._loadInProgress=true;var _58a={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _58b=xhr.get(_58a);_58b.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;_581(_57e,self._getItemsArray(_57e.queryOptions));self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_580(e,_57e);}});_58b.addErrback(function(_58c){self._loadInProgress=false;_580(_58c,_57e);});var _58d=null;if(_57e.abort){_58d=_57e.abort;}_57e.abort=function(){var df=_58b;if(df&&df.fired===-1){df.cancel();df=null;}if(_58d){_58d.call(_57e);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;_581(_57e,this._getItemsArray(_57e.queryOptions));}catch(e){_580(e,_57e);}}else{_580(new Error("dojo.data.ItemFileReadStore: No JSON source data was provided as either URL or a nested Javascript object."),_57e);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _58e=this._queuedFetches[i],_58f=_58e.args,_590=_58e.filter;if(_590){_590(_58f,this._getItemsArray(_58f.queryOptions));}else{this.fetchItemByIdentity(_58f);}}this._queuedFetches=[];}},_getItemsArray:function(_591){if(_591&&_591.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_592){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_593){var _594=false,self=this;function _595(_596){return (_596!==null)&&(typeof _596==="object")&&(!lang.isArray(_596)||_594)&&(!lang.isFunction(_596))&&(_596.constructor==Object||lang.isArray(_596))&&(typeof _596._reference==="undefined")&&(typeof _596._type==="undefined")&&(typeof _596._value==="undefined")&&self.hierarchical;};function _597(_598){self._arrayOfAllItems.push(_598);for(var _599 in _598){var _59a=_598[_599];if(_59a){if(lang.isArray(_59a)){var _59b=_59a;for(var k=0;k<_59b.length;++k){var _59c=_59b[k];if(_595(_59c)){_597(_59c);}}}else{if(_595(_59a)){_597(_59a);}}}}};this._labelAttr=_593.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_593.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_594=true;}_597(item);item[this._rootItemPropName]=true;}var _59d={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _59e=item[key];if(_59e!==null){if(!lang.isArray(_59e)){item[key]=[_59e];}}else{item[key]=[null];}}_59d[key]=key;}}while(_59d[this._storeRefPropName]){this._storeRefPropName+="_";}while(_59d[this._itemNumPropName]){this._itemNumPropName+="_";}while(_59d[this._reverseRefMap]){this._reverseRefMap+="_";}var _59f;var _5a0=_593.identifier;if(_5a0){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_5a0;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_59f=item[_5a0];var _5a1=_59f[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_5a1)){this._itemsByIdentity[_5a1]=item;}else{if(this._jsonFileUrl){throw new Error("dojo.data.ItemFileReadStore:  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_5a0+"].  Value collided: ["+_5a1+"]");}else{if(this._jsonData){throw new Error("dojo.data.ItemFileReadStore:  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_5a0+"].  Value collided: ["+_5a1+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_59f=item[key];for(var j=0;j<_59f.length;++j){_59e=_59f[j];if(_59e!==null&&typeof _59e=="object"){if(("_type" in _59e)&&("_value" in _59e)){var type=_59e._type;var _5a2=this._datatypeMap[type];if(!_5a2){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_5a2)){_59f[j]=new _5a2(_59e._value);}else{if(lang.isFunction(_5a2.deserialize)){_59f[j]=_5a2.deserialize(_59e._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_59e._reference){var _5a3=_59e._reference;if(!lang.isObject(_5a3)){_59f[j]=this._getItemByIdentity(_5a3);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _5a4=this._arrayOfAllItems[k],_5a5=true;for(var _5a6 in _5a3){if(_5a4[_5a6]!=_5a3[_5a6]){_5a5=false;}}if(_5a5){_59f[j]=_5a4;}}}if(this.referenceIntegrity){var _5a7=_59f[j];if(this.isItem(_5a7)){this._addReferenceToMap(_5a7,item,key);}}}else{if(this.isItem(_59e)){if(this.referenceIntegrity){this._addReferenceToMap(_59e,item,key);}}}}}}}},_addReferenceToMap:function(_5a8,_5a9,_5aa){},getIdentity:function(item){var _5ab=this._features["dojo.data.api.Identity"];if(_5ab===Number){return item[this._itemNumPropName];}else{var _5ac=item[_5ab];if(_5ac){return _5ac[0];}}return null;},fetchItemByIdentity:function(_5ad){var item,_5ae;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_562.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_5ad});}else{this._loadInProgress=true;var _5af={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _5b0=xhr.get(_5af);_5b0.addCallback(function(data){var _5b1=_5ad.scope?_5ad.scope:_566.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_5ad.identity);if(_5ad.onItem){_5ad.onItem.call(_5b1,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_5ad.onError){_5ad.onError.call(_5b1,error);}}});_5b0.addErrback(function(_5b2){self._loadInProgress=false;if(_5ad.onError){var _5b3=_5ad.scope?_5ad.scope:_566.global;_5ad.onError.call(_5b3,_5b2);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_5ad.identity);if(_5ad.onItem){_5ae=_5ad.scope?_5ad.scope:_566.global;_5ad.onItem.call(_5ae,item);}}}}else{item=this._getItemByIdentity(_5ad.identity);if(_5ad.onItem){_5ae=_5ad.scope?_5ad.scope:_566.global;_5ad.onItem.call(_5ae,item);}}},_getItemByIdentity:function(_5b4){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_5b4)){item=this._itemsByIdentity[_5b4];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_5b4)){item=this._arrayOfAllItems[_5b4];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _5b5=this._features["dojo.data.api.Identity"];if(_5b5===Number){return null;}else{return [_5b5];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_562.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _5b6={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _5b7=xhr.get(_5b6);_5b7.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error("dojo.data.ItemFileReadStore:  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){throw e;}});_5b7.addErrback(function(_5b8){throw _5b8;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_56a,_568);return _56a;});},"dojo/window":function(){define("dojo/window",["./_base/lang","./_base/sniff","./_base/window","./dom","./dom-geometry","./dom-style"],function(lang,has,_5b9,dom,geom,_5ba){var _5bb=lang.getObject("dojo.window",true);_5bb.getBox=function(){var _5bc=(_5b9.doc.compatMode=="BackCompat")?_5b9.body():_5b9.doc.documentElement,_5bd=geom.docScroll(),w,h;if(has("touch")){var _5be=_5b9.doc.parentWindow||_5b9.doc.defaultView;w=_5be.innerWidth||_5bc.clientWidth;h=_5be.innerHeight||_5bc.clientHeight;}else{w=_5bc.clientWidth;h=_5bc.clientHeight;}return {l:_5bd.x,t:_5bd.y,w:w,h:h};};_5bb.get=function(doc){if(has("ie")&&_5bb!==document.parentWindow){doc.parentWindow.execScript("document._parentWindow = window;","Javascript");var win=doc._parentWindow;doc._parentWindow=null;return win;}return doc.parentWindow||doc.defaultView;};_5bb.scrollIntoView=function(node,pos){try{node=dom.byId(node);var doc=node.ownerDocument||_5b9.doc,body=doc.body||_5b9.body(),html=doc.documentElement||body.parentNode,isIE=has("ie"),isWK=has("webkit");if((!(has("mozilla")||isIE||isWK||has("opera"))||node==body||node==html)&&(typeof node.scrollIntoView!="undefined")){node.scrollIntoView(false);return;}var _5bf=doc.compatMode=="BackCompat",_5c0=(isIE>=9&&node.ownerDocument.parentWindow.frameElement)?((html.clientHeight>0&&html.clientWidth>0&&(body.clientHeight==0||body.clientWidth==0||body.clientHeight>html.clientHeight||body.clientWidth>html.clientWidth))?html:body):(_5bf?body:html),_5c1=isWK?body:_5c0,_5c2=_5c0.clientWidth,_5c3=_5c0.clientHeight,rtl=!geom.isBodyLtr(),_5c4=pos||geom.position(node),el=node.parentNode,_5c5=function(el){return ((isIE<=6||(isIE&&_5bf))?false:(_5ba.get(el,"position").toLowerCase()=="fixed"));};if(_5c5(node)){return;}while(el){if(el==body){el=_5c1;}var _5c6=geom.position(el),_5c7=_5c5(el);if(el==_5c1){_5c6.w=_5c2;_5c6.h=_5c3;if(_5c1==html&&isIE&&rtl){_5c6.x+=_5c1.offsetWidth-_5c6.w;}if(_5c6.x<0||!isIE){_5c6.x=0;}if(_5c6.y<0||!isIE){_5c6.y=0;}}else{var pb=geom.getPadBorderExtents(el);_5c6.w-=pb.w;_5c6.h-=pb.h;_5c6.x+=pb.l;_5c6.y+=pb.t;var _5c8=el.clientWidth,_5c9=_5c6.w-_5c8;if(_5c8>0&&_5c9>0){_5c6.w=_5c8;_5c6.x+=(rtl&&(isIE||el.clientLeft>pb.l))?_5c9:0;}_5c8=el.clientHeight;_5c9=_5c6.h-_5c8;if(_5c8>0&&_5c9>0){_5c6.h=_5c8;}}if(_5c7){if(_5c6.y<0){_5c6.h+=_5c6.y;_5c6.y=0;}if(_5c6.x<0){_5c6.w+=_5c6.x;_5c6.x=0;}if(_5c6.y+_5c6.h>_5c3){_5c6.h=_5c3-_5c6.y;}if(_5c6.x+_5c6.w>_5c2){_5c6.w=_5c2-_5c6.x;}}var l=_5c4.x-_5c6.x,t=_5c4.y-Math.max(_5c6.y,0),r=l+_5c4.w-_5c6.w,bot=t+_5c4.h-_5c6.h;if(r*l>0){var s=Math[l<0?"max":"min"](l,r);if(rtl&&((isIE==8&&!_5bf)||isIE>=9)){s=-s;}_5c4.x+=el.scrollLeft;el.scrollLeft+=s;_5c4.x-=el.scrollLeft;}if(bot*t>0){_5c4.y+=el.scrollTop;el.scrollTop+=Math[t<0?"max":"min"](t,bot);_5c4.y-=el.scrollTop;}el=(el!=_5c1)&&!_5c7&&el.parentNode;}}catch(error){node.scrollIntoView(false);}};return _5bb;});},"dijit/_FocusMixin":function(){define("dijit/_FocusMixin",["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(_5ca,_5cb,_5cc,lang){lang.extend(_5cb,{focused:false,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus();},_onBlur:function(){this.onBlur();}});return _5cc("dijit._FocusMixin",null,{_focusManager:_5ca});});},"dojo/data/util/filter":function(){define("dojo/data/util/filter",["dojo/_base/lang"],function(lang){var _5cd=lang.getObject("dojo.data.util.filter",true);_5cd.patternToRegExp=function(_5ce,_5cf){var rxp="^";var c=null;for(var i=0;i<_5ce.length;i++){c=_5ce.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_5ce.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_5cf){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _5cd;});},"versa/api/Role":function(){define("versa/api/Role",["dojo/_base/declare","versa/api/_Object"],function(_5d0){var o=_5d0("versa.api.Role",[versa.api._Object],{constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));}});o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":""},"permissions":{type:"integer"},"created_at":{type:"date",format:"date-time"},"created_by":{type:"string"},"updated_at":{type:"date",format:"date-time"},"updated_by":{type:"string"}},prototype:new o()};return o;});},"versa/api/Operators":function(){define("versa/api/Operators",["dojo/_base/declare","versa/api/_Collection","versa/api/Operator"],function(_5d1){var o=_5d1("versa.api.Operators",[versa.api._Collection],{_andOp:null,_fetch_onComplete:function(_5d2,_5d3){this.isLoaded=true;if((_5d2!=null)&&(_5d2.length>1)){this.first=_5d2[0];}dojo.forEach(_5d2,function(item,idx){if(item.name=="and"){this._andOp=item;}},this);},constructor:function(args){this.target=versa.api.Operators.TRGT;this.schema=versa.api.Operator.schema;this.cache=true;this._initialize();},byDataType:function(id){var ops=[];this.forEach(function(item){if(item.data_type_id==id){ops.push(item);}},this);return ops;},getAndOp:function(){return this._andOp;}});o.TRGT="/operators";return o;});},"versa/api/Reference":function(){define("versa/api/Reference",["dojo/_base/declare","versa/api/_Object","versa/api/_Securable","versa/api/Utilities","versa/api/Document"],function(_5d4){var o=_5d4("versa.api.Reference",[versa.api._Object,versa.api._Securable],{zone:null,library:null,clean_properties:function(args){var _5d5=args.library;var _5d6=_5d5.getDocumentTypes().fetchById({id:this.document_type_id});for(var p in this){if(!dojo.isFunction(this[p])){var _5d7=dojo.replace("documents.{0}",[p]);var _5d8=_5d5.getPropertyDefinitions().fetchByDbName(_5d7);if((_5d8)&&(!_5d8.is_system)){if(!_5d6.hasProperty(_5d8.id)){delete this[p];}}}}},constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));this.securable_type=versa.api._Securable.types.Reference;},cancelCheckout:function(args){var zone=args.zone;var _5d9=args.library;var url=dojo.replace(versa.api.Reference.XCKO_TRGT,[zone.subdomain,_5d9.id,this.getId()]);var _5da={};var _5db=versa.api.XhrHelper.doPutAction({target:url,putData:_5da});return true;},checkin:function(args){var zone=args.zone;var _5dc=args.library;var url=dojo.replace(versa.api.Reference.CKI_TRGT,[zone.subdomain,_5dc.id,this.getId()]);var _5dd=dojo.fromJson(dojox.json.ref.toJson(this,false,"",true));var _5de=versa.api.XhrHelper.doPutAction({target:url,putData:_5dd});return true;},checkout:function(args){var zone=args.zone;var _5df=args.library;var url=dojo.replace(versa.api.Reference.CKO_TRGT,[zone.subdomain,_5df.id,this.getId()]);var _5e0={};var _5e1=versa.api.XhrHelper.doPutAction({target:url,putData:_5e0});return true;},getCopyUrl:function(zone,_5e2){return dojo.replace(versa.api.Reference.CP_TRGT,[zone.subdomain,_5e2.id,this.getId()]);},getCopyVersionUrl:function(zone,_5e3,_5e4){return dojo.replace(versa.api.Reference.CPV_TRGT,[zone.subdomain,_5e3.id,this.getId(),_5e4]);},copyLocal:function(args){var zone=args.zone;var _5e5=args.library;var url=(args.version_id)?this.getCopyVersionUrl(zone,_5e5,args.version_id):this.getCopyUrl(zone,_5e5);versa.api.Utilities.saveUrl({url:url,window_name:"versa_save"});},file:function(args){var zone=args.zone;var _5e6=args.library;var _5e7=args.folder;var url=dojo.replace(versa.api.Reference.FILE_TRGT,[zone.subdomain,_5e6.id,this.getId(),_5e7.getId()]);var _5e8={};var _5e9=versa.api.XhrHelper.doPutAction({target:url,putData:_5e8});_5e6.getReferences().store.onDelete(this);return true;},getPermissionSet:function(_5ea,_5eb,user){var _5ec=new versa.api.PermissionSet();_5ec.setValue(versa.api.PermissionIndices.VIEW,this.hasRights(versa.api._Securable.permissions.VIEW));_5ec.setValue(versa.api.PermissionIndices.COPY,this.hasRights(versa.api._Securable.permissions.VIEW));_5ec.setValue(versa.api.PermissionIndices.EDIT,this.hasRights(versa.api._Securable.permissions.WRITE_METADATA));_5ec.setValue(versa.api.PermissionIndices.MOVE,_5ec.getValue(versa.api.PermissionIndices.EDIT));_5ec.setValue(versa.api.PermissionIndices.CKO,(this.hasRights(versa.api._Securable.permissions.VERSION)&&this.getState(versa.api.Document.states.CHECKED_IN)));_5ec.setValue(versa.api.PermissionIndices.CKI,(this.hasRights(versa.api._Securable.permissions.VERSION)&&this.getState(versa.api.Document.states.CHECKED_OUT)&&(this.checked_out_by==user.name)));_5ec.setValue(versa.api.PermissionIndices.CANCEL_CKO,_5ec.getValue(versa.api.PermissionIndices.CKI));_5ec.setValue(versa.api.PermissionIndices.DELETE,this.hasRights(versa.api._Securable.permissions.DELETE_ITEMS));_5ec.setValue(versa.api.PermissionIndices.SECURE,this.hasRights(versa.api._Securable.permissions.WRITE_ACL));_5ec.setValue(versa.api.PermissionIndices.RESTORE,this.hasRights(versa.api._Securable.permissions.DELETE_ITEMS));_5ec.setValue(versa.api.PermissionIndices.DESTROY,this.hasRights(versa.api._Securable.permissions.DELETE_ITEMS));return _5ec;},getState:function(_5ed){return ((this.state&_5ed)==_5ed);},isDeleted:function(){return this.getState(versa.api.Document.states.DELETED);},isShare:function(){return this.reference_type==versa.api.Reference.types.SHARE;},restore:function(args){var zone=args.zone;var _5ee=args.library;var url=dojo.replace(versa.api.Reference.RESTORE_TRGT,[zone.subdomain,_5ee.getId(),this.getId()]);var _5ef={folder_id:(args.folder)?args.folder.id:null};var _5f0=versa.api.XhrHelper.doPutAction({target:url,putData:_5ef});_5ee.getReferences().store.onDelete(this);return true;},share:function(args){var zone=args.zone;var _5f1=args.library;var _5f2=args.folder;var url=dojo.replace(versa.api.Reference.SHARE_TRGT,[zone.subdomain,_5f1.id,this.getId(),_5f2.getId()]);var _5f3={};var _5f4=versa.api.XhrHelper.doPutAction({target:url,putData:_5f3});return true;},unshare:function(args){var zone=args.zone;var _5f5=args.library;var url=dojo.replace(versa.api.Reference.UNSHARE_TRGT,[zone.subdomain,_5f5.id,this.getId()]);var _5f6={};var _5f7=versa.api.XhrHelper.doPutAction({target:url,putData:_5f6});_5f5.getReferences().store.onDelete(this);return true;},getViewUrl:function(zone,_5f8){return dojo.replace(versa.api.Reference.VW_TRGT,[zone.subdomain,_5f8.id,this.getId()]);},getViewVersionUrl:function(zone,_5f9,_5fa){return dojo.replace(versa.api.Reference.VWV_TRGT,[zone.subdomain,_5f9.id,this.getId(),_5fa]);},view:function(args){var zone=args.zone;var _5fb=args.library;var url=(args.version_id)?this.getViewVersionUrl(zone,_5fb,args.version_id):this.getViewUrl(zone,_5fb);versa.api.Utilities.viewUrl({windowBox:args.windowBox,url:url,window_name:"versa_viewer"});}});o.VW_TRGT="/zones/{0}/libraries/{1}/references/{2}/download/?disposition=inline";o.VWV_TRGT="/zones/{0}/libraries/{1}/references/{2}/download/?disposition=inline&version_id={3}";o.CP_TRGT="/zones/{0}/libraries/{1}/references/{2}/download/?disposition=attachment";o.CPV_TRGT="/zones/{0}/libraries/{1}/references/{2}/download/?disposition=attachment&version_id={3}";o.CKO_TRGT="/zones/{0}/libraries/{1}/references/{2}/checkout.json";o.CKI_TRGT="/zones/{0}/libraries/{1}/references/{2}/checkin.json";o.XCKO_TRGT="/zones/{0}/libraries/{1}/references/{2}/cancel_checkout.json";o.FILE_TRGT="/zones/{0}/libraries/{1}/references/{2}/file.json?folder_id={3}";o.SHARE_TRGT="/zones/{0}/libraries/{1}/references/{2}/share.json?folder_id={3}";o.UNSHARE_TRGT="/zones/{0}/libraries/{1}/references/{2}/unshare.json?";o.RESTORE_TRGT="/zones/{0}/libraries/{1}/references/{2}/restore.json";o.types={"CONTENT":0,"SHARE":17,"TRASH":18};o.schema={type:"object",properties:{"id":{type:"integer"},"reference_type":{type:"integer"},"state":{type:"integer","default":versa.api.Document.states.PENDING}},prototype:new o()};return o;});},"dojox/json/ref":function(){define("dojox/json/ref",["dojo/_base/kernel","dojox","dojo/date/stamp","dojo/_base/array","dojo/_base/json"],function(dojo,_5fc){dojo.getObject("json",true,_5fc);return _5fc.json.ref={resolveJson:function(root,args){args=args||{};var _5fd=args.idAttribute||"id";var _5fe=this.refAttribute;var _5ff=args.idAsRef;var _600=args.idPrefix||"";var _601=args.assignAbsoluteIds;var _602=args.index||{};var _603=args.timeStamps;var ref,_604=[];var _605=/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/;var _606=this._addProp;var F=function(){};function walk(it,stop,_607,_608,_609,_60a){var i,_60b,val,id=_5fd in it?it[_5fd]:_607;if(_5fd in it||((id!==undefined)&&_608)){id=(_600+id).replace(_605,"$2$3");}var _60c=_60a||it;if(id!==undefined){if(_601){it.__id=id;}if(args.schemas&&(!(it instanceof Array))&&(val=id.match(/^(.+\/)[^\.\[]*$/))){_609=args.schemas[val[1]];}if(_602[id]&&((it instanceof Array)==(_602[id] instanceof Array))){_60c=_602[id];delete _60c.$ref;delete _60c._loadObject;_60b=true;}else{var _60d=_609&&_609.prototype;if(_60d){F.prototype=_60d;_60c=new F();}}_602[id]=_60c;if(_603){_603[id]=args.time;}}while(_609){var _60e=_609.properties;if(_60e){for(i in it){var _60f=_60e[i];if(_60f&&_60f.format=="date-time"&&typeof it[i]=="string"){it[i]=dojo.date.stamp.fromISOString(it[i]);}}}_609=_609["extends"];}var _610=it.length;for(i in it){if(i==_610){break;}if(it.hasOwnProperty(i)){val=it[i];if((typeof val=="object")&&val&&!(val instanceof Date)&&i!="__parent"){ref=val[_5fe]||(_5ff&&val[_5fd]);if(!ref||!val.__parent){if(it!=_604){val.__parent=_60c;}}if(ref){delete it[i];var path=ref.toString().replace(/(#)([^\.\[])/,"$1.$2").match(/(^([^\[]*\/)?[^#\.\[]*)#?([\.\[].*)?/);if(_602[(_600+ref).replace(_605,"$2$3")]){ref=_602[(_600+ref).replace(_605,"$2$3")];}else{if((ref=(path[1]=="$"||path[1]=="this"||path[1]=="")?root:_602[(_600+path[1]).replace(_605,"$2$3")])){if(path[3]){path[3].replace(/(\[([^\]]+)\])|(\.?([^\.\[]+))/g,function(t,a,b,c,d){ref=ref&&ref[b?b.replace(/[\"\'\\]/,""):d];});}}}if(ref){val=ref;}else{if(!stop){var _611;if(!_611){_604.push(_60c);}_611=true;val=walk(val,false,val[_5fe],true,_60f);val._loadObject=args.loader;}}}else{if(!stop){val=walk(val,_604==it,id===undefined?undefined:_606(id,i),false,_60f,_60c!=it&&typeof _60c[i]=="object"&&_60c[i]);}}}it[i]=val;if(_60c!=it&&!_60c.__isDirty){var old=_60c[i];_60c[i]=val;if(_60b&&val!==old&&!_60c._loadObject&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")&&i!="$ref"&&!(val instanceof Date&&old instanceof Date&&val.getTime()==old.getTime())&&!(typeof val=="function"&&typeof old=="function"&&val.toString()==old.toString())&&_602.onUpdate){_602.onUpdate(_60c,i,old,val);}}}}if(_60b&&(_5fd in it||_60c instanceof Array)){for(i in _60c){if(!_60c.__isDirty&&_60c.hasOwnProperty(i)&&!it.hasOwnProperty(i)&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")&&!(_60c instanceof Array&&isNaN(i))){if(_602.onUpdate&&i!="_loadObject"&&i!="_idAttr"){_602.onUpdate(_60c,i,_60c[i],undefined);}delete _60c[i];while(_60c instanceof Array&&_60c.length&&_60c[_60c.length-1]===undefined){_60c.length--;}}}}else{if(_602.onLoad){_602.onLoad(_60c);}}return _60c;};if(root&&typeof root=="object"){root=walk(root,false,args.defaultId,true);walk(_604,false);}return root;},fromJson:function(str,args){function ref(_612){var _613={};_613[this.refAttribute]=_612;return _613;};try{var root=eval("("+str+")");}catch(e){throw new SyntaxError("Invalid JSON string: "+e.message+" parsing: "+str);}if(root){return this.resolveJson(root,args);}return root;},toJson:function(it,_614,_615,_616){var _617=this._useRefs;var _618=this._addProp;var _619=this.refAttribute;_615=_615||"";var _61a={};var _61b={};function _61c(it,path,_61d){if(typeof it=="object"&&it){var _61e;if(it instanceof Date){return "\""+dojo.date.stamp.toISOString(it,{zulu:true})+"\"";}var id=it.__id;if(id){if(path!="#"&&((_617&&!id.match(/#/))||_61a[id])){var ref=id;if(id.charAt(0)!="#"){if(it.__clientId==id){ref="cid:"+id;}else{if(id.substring(0,_615.length)==_615){ref=id.substring(_615.length);}else{ref=id;}}}var _61f={};_61f[_619]=ref;return _61c(_61f,"#");}path=id;}else{it.__id=path;_61b[path]=it;}_61a[path]=it;_61d=_61d||"";var _620=_614?_61d+dojo.toJsonIndentStr:"";var _621=_614?"\n":"";var sep=_614?" ":"";if(it instanceof Array){var res=dojo.map(it,function(obj,i){var val=_61c(obj,_618(path,i),_620);if(typeof val!="string"){val="undefined";}return _621+_620+val;});return "["+res.join(","+sep)+_621+_61d+"]";}var _622=[];for(var i in it){if(it.hasOwnProperty(i)){var _623;if(typeof i=="number"){_623="\""+i+"\"";}else{if(typeof i=="string"&&(i.charAt(0)!="_"||i.charAt(1)!="_")){_623=dojo._escapeString(i);}else{continue;}}var val=_61c(it[i],_618(path,i),_620);if(typeof val!="string"){continue;}_622.push(_621+_620+_623+":"+sep+val);}}return "{"+_622.join(","+sep)+_621+_61d+"}";}else{if(typeof it=="function"&&_5fc.json.ref.serializeFunctions){return it.toString();}}return dojo.toJson(it);};var json=_61c(it,"#","");if(!_616){for(var i in _61b){delete _61b[i].__id;}}return json;},_addProp:function(id,prop){return id+(id.match(/#/)?id.length==1?"":".":"#")+prop;},refAttribute:"$ref",_useRefs:false,serializeFunctions:false};});},"dojox/mobile/View":function(){define("dojox/mobile/View",["dojo/_base/kernel","dojo/_base/array","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/Deferred","dojo/dom","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dijit/registry","dijit/_Contained","dijit/_Container","dijit/_WidgetBase","./ViewController","./transition"],function(dojo,_624,_625,_626,_627,lang,has,win,_628,dom,_629,_62a,_62b,_62c,_62d,_62e,_62f,_630,_631){var dm=lang.getObject("dojox.mobile",true);return _627("dojox.mobile.View",[_62f,_62e,_62d],{selected:false,keepScrollPos:true,constructor:function(_632,node){if(node){dom.byId(node).style.visibility="hidden";}this._aw=has("android")>=2.2&&has("android")<3;},buildRendering:function(){this.domNode=this.containerNode=this.srcNodeRef||win.doc.createElement("DIV");this.domNode.className="mblView";this.connect(this.domNode,"webkitAnimationEnd","onAnimationEnd");this.connect(this.domNode,"webkitAnimationStart","onAnimationStart");if(!_625["mblCSS3Transition"]){this.connect(this.domNode,"webkitTransitionEnd","onAnimationEnd");}var id=location.href.match(/#(\w+)([^\w=]|$)/)?RegExp.$1:null;this._visible=this.selected&&!id||this.id==id;if(this.selected){dm._defaultView=this;}},startup:function(){if(this._started){return;}var _633=[];var _634=this.domNode.parentNode.childNodes;var _635=false;for(var i=0;i<_634.length;i++){var c=_634[i];if(c.nodeType===1&&_629.contains(c,"mblView")){_633.push(c);_635=_635||_62c.byNode(c)._visible;}}var _636=this._visible;if(_633.length===1||(!_635&&_633[0]===this.domNode)){_636=true;}var _637=this;setTimeout(function(){if(!_636){_637.domNode.style.display="none";}else{dm.currentView=_637;_637.onStartView();_626.publish("/dojox/mobile/startView",[_637]);}if(_637.domNode.style.visibility!="visible"){_637.domNode.style.visibility="visible";}var _638=_637.getParent&&_637.getParent();if(!_638||!_638.resize){_637.resize();}},has("ie")?100:0);this.inherited(arguments);},resize:function(){_624.forEach(this.getChildren(),function(_639){if(_639.resize){_639.resize();}});},onStartView:function(){},onBeforeTransitionIn:function(_63a,dir,_63b,_63c,_63d){},onAfterTransitionIn:function(_63e,dir,_63f,_640,_641){},onBeforeTransitionOut:function(_642,dir,_643,_644,_645){},onAfterTransitionOut:function(_646,dir,_647,_648,_649){},_saveState:function(_64a,dir,_64b,_64c,_64d){this._context=_64c;this._method=_64d;if(_64b=="none"){_64b=null;}this._moveTo=_64a;this._dir=dir;this._transition=_64b;this._arguments=lang._toArray(arguments);this._args=[];if(_64c||_64d){for(var i=5;i<arguments.length;i++){this._args.push(arguments[i]);}}},_fixViewState:function(_64e){var _64f=this.domNode.parentNode.childNodes;for(var i=0;i<_64f.length;i++){var n=_64f[i];if(n.nodeType===1&&_629.contains(n,"mblView")){n.className="mblView";}}_64e.className="mblView";},convertToId:function(_650){if(typeof (_650)=="string"){_650.match(/^#?([^&?]+)/);return RegExp.$1;}return _650;},performTransition:function(_651,dir,_652,_653,_654){if(_651==="#"){return;}if(dojo.hash){if(typeof (_651)=="string"&&_651.charAt(0)=="#"&&!dm._params){dm._params=[];for(var i=0;i<arguments.length;i++){dm._params.push(arguments[i]);}dojo.hash(_651);return;}}this._saveState.apply(this,arguments);var _655;if(_651){_655=this.convertToId(_651);}else{if(!this._dummyNode){this._dummyNode=win.doc.createElement("DIV");win.body().appendChild(this._dummyNode);}_655=this._dummyNode;}var _656=this.domNode;var _657=_656.offsetTop;_655=this.toNode=dom.byId(_655);if(!_655){return;}_655.style.visibility=this._aw?"visible":"hidden";_655.style.display="";this._fixViewState(_655);var _658=_62c.byNode(_655);if(_658){if(_625["mblAlwaysResizeOnTransition"]||!_658._resized){dm.resizeAll(null,_658);_658._resized=true;}if(_652&&_652!="none"){_658.containerNode.style.paddingTop=_657+"px";}_658.movedFrom=_656.id;}this.onBeforeTransitionOut.apply(this,arguments);_626.publish("/dojox/mobile/beforeTransitionOut",[this].concat(lang._toArray(arguments)));if(_658){if(this.keepScrollPos&&!this.getParent()){var _659=win.body().scrollTop||win.doc.documentElement.scrollTop||win.global.pageYOffset||0;_656._scrollTop=_659;var _65a=(dir==1)?0:(_655._scrollTop||0);_655.style.top="0px";if(_659>1||_65a!==0){_656.style.top=_65a-_659+"px";if(_625["mblHideAddressBar"]!==false){setTimeout(function(){win.global.scrollTo(0,(_65a||1));},0);}}}else{_655.style.top="0px";}_658.onBeforeTransitionIn.apply(_658,arguments);_626.publish("/dojox/mobile/beforeTransitionIn",[_658].concat(lang._toArray(arguments)));}if(!this._aw){_655.style.display="none";_655.style.visibility="visible";}if(dm._iw&&dm.scrollable){var ss=dm.getScreenSize();win.body().appendChild(dm._iwBgCover);_62b.set(dm._iwBgCover,{position:"absolute",top:"0px",left:"0px",height:(ss.h+1)+"px",width:ss.w+"px",backgroundColor:_62b.get(win.body(),"background-color"),zIndex:-10000,display:""});_62b.set(_655,{position:"absolute",zIndex:-10001,visibility:"visible",display:""});setTimeout(lang.hitch(this,function(){this._doTransition(_656,_655,_652,dir);}),80);}else{this._doTransition(_656,_655,_652,dir);}},_toCls:function(s){return "mbl"+s.charAt(0).toUpperCase()+s.substring(1);},_doTransition:function(_65b,_65c,_65d,dir){var rev=(dir==-1)?" mblReverse":"";if(dm._iw&&dm.scrollable){_62b.set(_65c,{position:"",zIndex:""});win.body().removeChild(dm._iwBgCover);}else{if(!this._aw){_65c.style.display="";}}if(!_65d||_65d=="none"){this.domNode.style.display="none";this.invokeCallback();}else{if(_625["mblCSS3Transition"]){_628.when(_631,lang.hitch(this,function(_65e){var _65f=_62b.get(_65c,"position");_62b.set(_65c,"position","absolute");_628.when(_65e(_65b,_65c,{transition:_65d,reverse:(dir===-1)?true:false}),lang.hitch(this,function(){_62b.set(_65c,"position",_65f);this.invokeCallback();}));}));}else{var s=this._toCls(_65d);_629.add(_65b,s+" mblOut"+rev);_629.add(_65c,s+" mblIn"+rev);setTimeout(function(){_629.add(_65b,"mblTransition");_629.add(_65c,"mblTransition");},100);var _660="50% 50%";var _661="50% 50%";var _662,posX,posY;if(_65d.indexOf("swirl")!=-1||_65d.indexOf("zoom")!=-1){if(this.keepScrollPos&&!this.getParent()){_662=win.body().scrollTop||win.doc.documentElement.scrollTop||win.global.pageYOffset||0;}else{_662=-_62a.position(_65b,true).y;}posY=win.global.innerHeight/2+_662;_660="50% "+posY+"px";_661="50% "+posY+"px";}else{if(_65d.indexOf("scale")!=-1){var _663=_62a.position(_65b,true);posX=((this.clickedPosX!==undefined)?this.clickedPosX:win.global.innerWidth/2)-_663.x;if(this.keepScrollPos&&!this.getParent()){_662=win.body().scrollTop||win.doc.documentElement.scrollTop||win.global.pageYOffset||0;}else{_662=-_663.y;}posY=((this.clickedPosY!==undefined)?this.clickedPosY:win.global.innerHeight/2)+_662;_660=posX+"px "+posY+"px";_661=posX+"px "+posY+"px";}}_62b.set(_65b,{webkitTransformOrigin:_660});_62b.set(_65c,{webkitTransformOrigin:_661});}}dm.currentView=_62c.byNode(_65c);},onAnimationStart:function(e){},onAnimationEnd:function(e){var name=e.animationName||e.target.className;if(name.indexOf("Out")===-1&&name.indexOf("In")===-1&&name.indexOf("Shrink")===-1){return;}var _664=false;if(_629.contains(this.domNode,"mblOut")){_664=true;this.domNode.style.display="none";_629.remove(this.domNode,[this._toCls(this._transition),"mblIn","mblOut","mblReverse"]);}else{this.containerNode.style.paddingTop="";}_62b.set(this.domNode,{webkitTransformOrigin:""});if(name.indexOf("Shrink")!==-1){var li=e.target;li.style.display="none";_629.remove(li,"mblCloseContent");}if(_664){this.invokeCallback();}this.domNode&&(this.domNode.className="mblView");this.clickedPosX=this.clickedPosY=undefined;},invokeCallback:function(){this.onAfterTransitionOut.apply(this,this._arguments);_626.publish("/dojox/mobile/afterTransitionOut",[this].concat(this._arguments));var _665=_62c.byNode(this.toNode);if(_665){_665.onAfterTransitionIn.apply(_665,this._arguments);_626.publish("/dojox/mobile/afterTransitionIn",[_665].concat(this._arguments));_665.movedFrom=undefined;}var c=this._context,m=this._method;if(!c&&!m){return;}if(!m){m=c;c=null;}c=c||win.global;if(typeof (m)=="string"){c[m].apply(c,this._args);}else{m.apply(c,this._args);}},getShowingView:function(){var _666=this.domNode.parentNode.childNodes;for(var i=0;i<_666.length;i++){var n=_666[i];if(n.nodeType===1&&_629.contains(n,"mblView")&&_62b.get(n,"display")!=="none"){return _62c.byNode(n);}}return null;},show:function(){var view=this.getShowingView();if(view){view.domNode.style.display="none";}this.domNode.style.display="";dm.currentView=this;}});});},"dojox/data/ClientFilter":function(){define("dojox/data/ClientFilter",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","dojo/data/util/filter"],function(_667,lang,_668,_669,_66a){var _66b=function(_66c,_66d,_66e){return function(item){_66c._updates.push({create:_66d&&item,remove:_66e&&item});_66f.onUpdate();};};var _66f=_667("dojox.data.ClientFilter",null,{cacheByDefault:false,constructor:function(){this.onSet=_66b(this,true,true);this.onNew=_66b(this,true,false);this.onDelete=_66b(this,false,true);this._updates=[];this._fetchCache=[];},clearCache:function(){this._fetchCache=[];},updateResultSet:function(_670,_671){if(this.isUpdateable(_671)){for(var i=_671._version||0;i<this._updates.length;i++){var _672=this._updates[i].create;var _673=this._updates[i].remove;if(_673){for(var j=0;j<_670.length;j++){if(this.getIdentity(_670[j])==this.getIdentity(_673)){_670.splice(j--,1);var _674=true;}}}if(_672&&this.matchesQuery(_672,_671)&&_668.indexOf(_670,_672)==-1){_670.push(_672);_674=true;}}if(_671.sort&&_674){_670.sort(this.makeComparator(_671.sort.concat()));}_670._fullLength=_670.length;if(_671.count&&_674&&_671.count!==Infinity){_670.splice(_671.count,_670.length);}_671._version=this._updates.length;return _674?2:1;}return 0;},querySuperSet:function(_675,_676){if(_675.query==_676.query){return {};}if(!(_676.query instanceof Object&&(!_675.query||typeof _675.query=="object"))){return false;}var _677=lang.mixin({},_676.query);for(var i in _675.query){if(_677[i]==_675.query[i]){delete _677[i];}else{if(!(typeof _675.query[i]=="string"&&_66a.patternToRegExp(_675.query[i]).test(_677[i]))){return false;}}}return _677;},serverVersion:0,cachingFetch:function(args){var self=this;for(var i=0;i<this._fetchCache.length;i++){var _678=this._fetchCache[i];var _679=this.querySuperSet(_678,args);if(_679!==false){var _67a=_678._loading;if(!_67a){_67a=new _669();_67a.callback(_678.cacheResults);}_67a.addCallback(function(_67b){_67b=self.clientSideFetch(lang.mixin(lang.mixin({},args),{query:_679}),_67b);_67a.fullLength=_67b._fullLength;return _67b;});args._version=_678._version;break;}}if(!_67a){var _67c=lang.mixin({},args);var _67d=(args.queryOptions||0).cache;var _67e=this._fetchCache;if(_67d===undefined?this.cacheByDefault:_67d){if(args.start||args.count){delete _67c.start;delete _67c.count;args.clientQuery=lang.mixin(args.clientQuery||{},{start:args.start,count:args.count});}args=_67c;_67e.push(args);}_67a=args._loading=this._doQuery(args);_67a.addErrback(function(){_67e.splice(_668.indexOf(_67e,args),1);});}var _67f=this.serverVersion;_67a.addCallback(function(_680){delete args._loading;if(_680){args._version=typeof args._version=="number"?args._version:_67f;self.updateResultSet(_680,args);args.cacheResults=_680;if(!args.count||_680.length<args.count){_67a.fullLength=((args.start)?args.start:0)+_680.length;}}return _680;});return _67a;},isUpdateable:function(_681){return typeof _681.query=="object";},clientSideFetch:function(_682,_683){if(_682.queryOptions&&_682.queryOptions.results){_683=_682.queryOptions.results;}if(_682.query){var _684=[];for(var i=0;i<_683.length;i++){var _685=_683[i];if(_685&&this.matchesQuery(_685,_682)){_684.push(_683[i]);}}}else{_684=_682.sort?_683.concat():_683;}if(_682.sort){_684.sort(this.makeComparator(_682.sort.concat()));}return this.clientSidePaging(_682,_684);},clientSidePaging:function(_686,_687){var _688=_686.start||0;var _689=(_688||_686.count)?_687.slice(_688,_688+(_686.count||_687.length)):_687;_689._fullLength=_687.length;return _689;},matchesQuery:function(item,_68a){var _68b=_68a.query;var _68c=_68a.queryOptions&&_68a.queryOptions.ignoreCase;for(var i in _68b){var _68d=_68b[i];var _68e=this.getValue(item,i);if((typeof _68d=="string"&&(_68d.match(/[\*\.]/)||_68c))?!_66a.patternToRegExp(_68d,_68c).test(_68e):_68e!=_68d){return false;}}return true;},makeComparator:function(sort){var _68f=sort.shift();if(!_68f){return function(){return 0;};}var _690=_68f.attribute;var _691=!!_68f.descending;var next=this.makeComparator(sort);var _692=this;return function(a,b){var av=_692.getValue(a,_690);var bv=_692.getValue(b,_690);if(av!=bv){return av<bv==_691?1:-1;}return next(a,b);};}});_66f.onUpdate=function(){};return _66f;});},"dojo/data/util/sorter":function(){define("dojo/data/util/sorter",["dojo/_base/lang"],function(lang){var _693=lang.getObject("dojo.data.util.sorter",true);_693.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_693.createSortFunction=function(_694,_695){var _696=[];function _697(attr,dir,comp,s){return function(_698,_699){var a=s.getValue(_698,attr);var b=s.getValue(_699,attr);return dir*comp(a,b);};};var _69a;var map=_695.comparatorMap;var bc=_693.basicComparator;for(var i=0;i<_694.length;i++){_69a=_694[i];var attr=_69a.attribute;if(attr){var dir=(_69a.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_696.push(_697(attr,dir,comp,_695));}}return function(rowA,rowB){var i=0;while(i<_696.length){var ret=_696[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _693;});},"dijit/form/_ButtonMixin":function(){define("dijit/form/_ButtonMixin",["dojo/_base/declare","dojo/dom","dojo/_base/event","../registry"],function(_69b,dom,_69c,_69d){return _69b("dijit.form._ButtonMixin",null,{label:"",type:"button",_onClick:function(e){if(this.disabled){_69c.stop(e);return false;}var _69e=this.onClick(e)===false;if(!_69e&&this.type=="submit"&&!(this.valueNode||this.focusNode).form){for(var node=this.domNode;node.parentNode;node=node.parentNode){var _69f=_69d.byNode(node);if(_69f&&typeof _69f._onSubmit=="function"){_69f._onSubmit(e);_69e=true;break;}}}if(_69e){e.preventDefault();}return !_69e;},postCreate:function(){this.inherited(arguments);dom.setSelectable(this.focusNode,false);},onClick:function(){return true;},_setLabelAttr:function(_6a0){this._set("label",_6a0);(this.containerNode||this.focusNode).innerHTML=_6a0;}});});},"dojox/mobile/RoundRectList":function(){define("dojox/mobile/RoundRectList",["dojo/_base/array","dojo/_base/declare","dojo/_base/window","dijit/_Contained","dijit/_Container","dijit/_WidgetBase"],function(_6a1,_6a2,win,_6a3,_6a4,_6a5){return _6a2("dojox.mobile.RoundRectList",[_6a5,_6a4,_6a3],{transition:"slide",iconBase:"",iconPos:"",select:"",stateful:false,buildRendering:function(){this.domNode=this.containerNode=this.srcNodeRef||win.doc.createElement("UL");this.domNode.className="mblRoundRectList";},resize:function(){_6a1.forEach(this.getChildren(),function(_6a6){if(_6a6.resize){_6a6.resize();}});},onCheckStateChanged:function(_6a7,_6a8){},_setStatefulAttr:function(_6a9){this.stateful=_6a9;_6a1.forEach(this.getChildren(),function(_6aa){_6aa.setArrow&&_6aa.setArrow();});},deselectItem:function(item){item.deselect();},deselectAll:function(){_6a1.forEach(this.getChildren(),function(_6ab){_6ab.deselect&&_6ab.deselect();});},selectItem:function(item){item.select();}});});},"dijit/registry":function(){define("dijit/registry",["dojo/_base/array","dojo/_base/sniff","dojo/_base/unload","dojo/_base/window","."],function(_6ac,has,_6ad,win,_6ae){var _6af={},hash={};var _6b0={length:0,add:function(_6b1){if(hash[_6b1.id]){throw new Error("Tried to register widget with id=="+_6b1.id+" but that id is already registered");}hash[_6b1.id]=_6b1;this.length++;},remove:function(id){if(hash[id]){delete hash[id];this.length--;}},byId:function(id){return typeof id=="string"?hash[id]:id;},byNode:function(node){return hash[node.getAttribute("widgetId")];},toArray:function(){var ar=[];for(var id in hash){ar.push(hash[id]);}return ar;},getUniqueId:function(_6b2){var id;do{id=_6b2+"_"+(_6b2 in _6af?++_6af[_6b2]:_6af[_6b2]=0);}while(hash[id]);return _6ae._scopeName=="dijit"?id:_6ae._scopeName+"_"+id;},findWidgets:function(root){var _6b3=[];function _6b4(root){for(var node=root.firstChild;node;node=node.nextSibling){if(node.nodeType==1){var _6b5=node.getAttribute("widgetId");if(_6b5){var _6b6=hash[_6b5];if(_6b6){_6b3.push(_6b6);}}else{_6b4(node);}}}};_6b4(root);return _6b3;},_destroyAll:function(){_6ae._curFocus=null;_6ae._prevFocus=null;_6ae._activeStack=[];_6ac.forEach(_6b0.findWidgets(win.body()),function(_6b7){if(!_6b7._destroyed){if(_6b7.destroyRecursive){_6b7.destroyRecursive();}else{if(_6b7.destroy){_6b7.destroy();}}}});},getEnclosingWidget:function(node){while(node){var id=node.getAttribute&&node.getAttribute("widgetId");if(id){return hash[id];}node=node.parentNode;}return null;},_hash:hash};if(has("ie")){_6ad.addOnWindowUnload(function(){_6b0._destroyAll();});}_6ae.registry=_6b0;return _6b0;});},"dojo/date/locale":function(){define("dojo/date/locale",["../_base/kernel","../_base/lang","../_base/array","../date","../cldr/supplemental","../regexp","../string","../i18n!../cldr/nls/gregorian"],function(dojo,lang,_6b8,date,cldr,_6b9,_6ba,_6bb){lang.getObject("date.locale",true,dojo);function _6bc(_6bd,_6be,_6bf,_6c0){return _6c0.replace(/([a-z])\1*/ig,function(_6c1){var s,pad,c=_6c1.charAt(0),l=_6c1.length,_6c2=["abbr","wide","narrow"];switch(c){case "G":s=_6be[(l<4)?"eraAbbr":"eraNames"][_6bd.getFullYear()<0?0:1];break;case "y":s=_6bd.getFullYear();switch(l){case 1:break;case 2:if(!_6bf.fullYear){s=String(s);s=s.substr(s.length-2);break;}default:pad=true;}break;case "Q":case "q":s=Math.ceil((_6bd.getMonth()+1)/3);pad=true;break;case "M":var m=_6bd.getMonth();if(l<3){s=m+1;pad=true;}else{var _6c3=["months","format",_6c2[l-3]].join("-");s=_6be[_6c3][m];}break;case "w":var _6c4=0;s=dojo.date.locale._getWeekOfYear(_6bd,_6c4);pad=true;break;case "d":s=_6bd.getDate();pad=true;break;case "D":s=dojo.date.locale._getDayOfYear(_6bd);pad=true;break;case "E":var d=_6bd.getDay();if(l<3){s=d+1;pad=true;}else{var _6c5=["days","format",_6c2[l-3]].join("-");s=_6be[_6c5][d];}break;case "a":var _6c6=(_6bd.getHours()<12)?"am":"pm";s=_6bf[_6c6]||_6be["dayPeriods-format-wide-"+_6c6];break;case "h":case "H":case "K":case "k":var h=_6bd.getHours();switch(c){case "h":s=(h%12)||12;break;case "H":s=h;break;case "K":s=(h%12);break;case "k":s=h||24;break;}pad=true;break;case "m":s=_6bd.getMinutes();pad=true;break;case "s":s=_6bd.getSeconds();pad=true;break;case "S":s=Math.round(_6bd.getMilliseconds()*Math.pow(10,l-3));pad=true;break;case "v":case "z":s=dojo.date.locale._getZone(_6bd,true,_6bf);if(s){break;}l=4;case "Z":var _6c7=dojo.date.locale._getZone(_6bd,false,_6bf);var tz=[(_6c7<=0?"+":"-"),_6ba.pad(Math.floor(Math.abs(_6c7)/60),2),_6ba.pad(Math.abs(_6c7)%60,2)];if(l==4){tz.splice(0,0,"GMT");tz.splice(3,0,":");}s=tz.join("");break;default:throw new Error("dojo.date.locale.format: invalid pattern char: "+_6c0);}if(pad){s=_6ba.pad(s,l);}return s;});};dojo.date.locale._getZone=function(_6c8,_6c9,_6ca){if(_6c9){return date.getTimezoneName(_6c8);}else{return _6c8.getTimezoneOffset();}};dojo.date.locale.format=function(_6cb,_6cc){_6cc=_6cc||{};var _6cd=dojo.i18n.normalizeLocale(_6cc.locale),_6ce=_6cc.formatLength||"short",_6cf=dojo.date.locale._getGregorianBundle(_6cd),str=[],_6d0=lang.hitch(this,_6bc,_6cb,_6cf,_6cc);if(_6cc.selector=="year"){return _6d1(_6cf["dateFormatItem-yyyy"]||"yyyy",_6d0);}var _6d2;if(_6cc.selector!="date"){_6d2=_6cc.timePattern||_6cf["timeFormat-"+_6ce];if(_6d2){str.push(_6d1(_6d2,_6d0));}}if(_6cc.selector!="time"){_6d2=_6cc.datePattern||_6cf["dateFormat-"+_6ce];if(_6d2){str.push(_6d1(_6d2,_6d0));}}return str.length==1?str[0]:_6cf["dateTimeFormat-"+_6ce].replace(/\{(\d+)\}/g,function(_6d3,key){return str[key];});};dojo.date.locale.regexp=function(_6d4){return dojo.date.locale._parseInfo(_6d4).regexp;};dojo.date.locale._parseInfo=function(_6d5){_6d5=_6d5||{};var _6d6=dojo.i18n.normalizeLocale(_6d5.locale),_6d7=dojo.date.locale._getGregorianBundle(_6d6),_6d8=_6d5.formatLength||"short",_6d9=_6d5.datePattern||_6d7["dateFormat-"+_6d8],_6da=_6d5.timePattern||_6d7["timeFormat-"+_6d8],_6db;if(_6d5.selector=="date"){_6db=_6d9;}else{if(_6d5.selector=="time"){_6db=_6da;}else{_6db=_6d7["dateTimeFormat-"+_6d8].replace(/\{(\d+)\}/g,function(_6dc,key){return [_6da,_6d9][key];});}}var _6dd=[],re=_6d1(_6db,lang.hitch(this,_6de,_6dd,_6d7,_6d5));return {regexp:re,tokens:_6dd,bundle:_6d7};};dojo.date.locale.parse=function(_6df,_6e0){var _6e1=/[\u200E\u200F\u202A\u202E]/g,info=dojo.date.locale._parseInfo(_6e0),_6e2=info.tokens,_6e3=info.bundle,re=new RegExp("^"+info.regexp.replace(_6e1,"")+"$",info.strict?"":"i"),_6e4=re.exec(_6df&&_6df.replace(_6e1,""));if(!_6e4){return null;}var _6e5=["abbr","wide","narrow"],_6e6=[1970,0,1,0,0,0,0],amPm="",_6e7=dojo.every(_6e4,function(v,i){if(!i){return true;}var _6e8=_6e2[i-1];var l=_6e8.length;switch(_6e8.charAt(0)){case "y":if(l!=2&&_6e0.strict){_6e6[0]=v;}else{if(v<100){v=Number(v);var year=""+new Date().getFullYear(),_6e9=year.substring(0,2)*100,_6ea=Math.min(Number(year.substring(2,4))+20,99);_6e6[0]=(v<_6ea)?_6e9+v:_6e9-100+v;}else{if(_6e0.strict){return false;}_6e6[0]=v;}}break;case "M":if(l>2){var _6eb=_6e3["months-format-"+_6e5[l-3]].concat();if(!_6e0.strict){v=v.replace(".","").toLowerCase();_6eb=dojo.map(_6eb,function(s){return s.replace(".","").toLowerCase();});}v=dojo.indexOf(_6eb,v);if(v==-1){return false;}}else{v--;}_6e6[1]=v;break;case "E":case "e":var days=_6e3["days-format-"+_6e5[l-3]].concat();if(!_6e0.strict){v=v.toLowerCase();days=dojo.map(days,function(d){return d.toLowerCase();});}v=dojo.indexOf(days,v);if(v==-1){return false;}break;case "D":_6e6[1]=0;case "d":_6e6[2]=v;break;case "a":var am=_6e0.am||_6e3["dayPeriods-format-wide-am"],pm=_6e0.pm||_6e3["dayPeriods-format-wide-pm"];if(!_6e0.strict){var _6ec=/\./g;v=v.replace(_6ec,"").toLowerCase();am=am.replace(_6ec,"").toLowerCase();pm=pm.replace(_6ec,"").toLowerCase();}if(_6e0.strict&&v!=am&&v!=pm){return false;}amPm=(v==pm)?"p":(v==am)?"a":"";break;case "K":if(v==24){v=0;}case "h":case "H":case "k":if(v>23){return false;}_6e6[3]=v;break;case "m":_6e6[4]=v;break;case "s":_6e6[5]=v;break;case "S":_6e6[6]=v;}return true;});var _6ed=+_6e6[3];if(amPm==="p"&&_6ed<12){_6e6[3]=_6ed+12;}else{if(amPm==="a"&&_6ed==12){_6e6[3]=0;}}var _6ee=new Date(_6e6[0],_6e6[1],_6e6[2],_6e6[3],_6e6[4],_6e6[5],_6e6[6]);if(_6e0.strict){_6ee.setFullYear(_6e6[0]);}var _6ef=_6e2.join(""),_6f0=_6ef.indexOf("d")!=-1,_6f1=_6ef.indexOf("M")!=-1;if(!_6e7||(_6f1&&_6ee.getMonth()>_6e6[1])||(_6f0&&_6ee.getDate()>_6e6[2])){return null;}if((_6f1&&_6ee.getMonth()<_6e6[1])||(_6f0&&_6ee.getDate()<_6e6[2])){_6ee=date.add(_6ee,"hour",1);}return _6ee;};function _6d1(_6f2,_6f3,_6f4,_6f5){var _6f6=function(x){return x;};_6f3=_6f3||_6f6;_6f4=_6f4||_6f6;_6f5=_6f5||_6f6;var _6f7=_6f2.match(/(''|[^'])+/g),_6f8=_6f2.charAt(0)=="'";dojo.forEach(_6f7,function(_6f9,i){if(!_6f9){_6f7[i]="";}else{_6f7[i]=(_6f8?_6f4:_6f3)(_6f9.replace(/''/g,"'"));_6f8=!_6f8;}});return _6f5(_6f7.join(""));};function _6de(_6fa,_6fb,_6fc,_6fd){_6fd=_6b9.escapeString(_6fd);if(!_6fc.strict){_6fd=_6fd.replace(" a"," ?a");}return _6fd.replace(/([a-z])\1*/ig,function(_6fe){var s,c=_6fe.charAt(0),l=_6fe.length,p2="",p3="";if(_6fc.strict){if(l>1){p2="0"+"{"+(l-1)+"}";}if(l>2){p3="0"+"{"+(l-2)+"}";}}else{p2="0?";p3="0{0,2}";}switch(c){case "y":s="\\d{2,4}";break;case "M":s=(l>2)?"\\S+?":"1[0-2]|"+p2+"[1-9]";break;case "D":s="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+p2+"[1-9][0-9]|"+p3+"[1-9]";break;case "d":s="3[01]|[12]\\d|"+p2+"[1-9]";break;case "w":s="[1-4][0-9]|5[0-3]|"+p2+"[1-9]";break;case "E":s="\\S+";break;case "h":s="1[0-2]|"+p2+"[1-9]";break;case "k":s="1[01]|"+p2+"\\d";break;case "H":s="1\\d|2[0-3]|"+p2+"\\d";break;case "K":s="1\\d|2[0-4]|"+p2+"[1-9]";break;case "m":case "s":s="[0-5]\\d";break;case "S":s="\\d{"+l+"}";break;case "a":var am=_6fc.am||_6fb["dayPeriods-format-wide-am"],pm=_6fc.pm||_6fb["dayPeriods-format-wide-pm"];s=am+"|"+pm;if(!_6fc.strict){if(am!=am.toLowerCase()){s+="|"+am.toLowerCase();}if(pm!=pm.toLowerCase()){s+="|"+pm.toLowerCase();}if(s.indexOf(".")!=-1){s+="|"+s.replace(/\./g,"");}}s=s.replace(/\./g,"\\.");break;default:s=".*";}if(_6fa){_6fa.push(_6fe);}return "("+s+")";}).replace(/[\xa0 ]/g,"[\\s\\xa0]");};var _6ff=[];dojo.date.locale.addCustomFormats=function(_700,_701){_6ff.push({pkg:_700,name:_701});};dojo.date.locale._getGregorianBundle=function(_702){var _703={};dojo.forEach(_6ff,function(desc){var _704=dojo.i18n.getLocalization(desc.pkg,desc.name,_702);_703=lang.mixin(_703,_704);},this);return _703;};dojo.date.locale.addCustomFormats("dojo.cldr","gregorian");dojo.date.locale.getNames=function(item,type,_705,_706){var _707,_708=dojo.date.locale._getGregorianBundle(_706),_709=[item,_705,type];if(_705=="standAlone"){var key=_709.join("-");_707=_708[key];if(_707[0]==1){_707=undefined;}}_709[1]="format";return (_707||_708[_709.join("-")]).concat();};dojo.date.locale.isWeekend=function(_70a,_70b){var _70c=cldr.getWeekend(_70b),day=(_70a||new Date()).getDay();if(_70c.end<_70c.start){_70c.end+=7;if(day<_70c.start){day+=7;}}return day>=_70c.start&&day<=_70c.end;};dojo.date.locale._getDayOfYear=function(_70d){return date.difference(new Date(_70d.getFullYear(),0,1,_70d.getHours()),_70d)+1;};dojo.date.locale._getWeekOfYear=function(_70e,_70f){if(arguments.length==1){_70f=0;}var _710=new Date(_70e.getFullYear(),0,1).getDay(),adj=(_710-_70f+7)%7,week=Math.floor((dojo.date.locale._getDayOfYear(_70e)+adj-1)/7);if(_710==_70f){week++;}return week;};return dojo.date.locale;});},"dojox/mobile/TextBox":function(){define("dojox/mobile/TextBox",["dojo/_base/declare","dojo/dom-construct","dijit/_WidgetBase","dijit/form/_FormValueMixin","dijit/form/_TextBoxMixin"],function(_711,_712,_713,_714,_715){return _711("dojox.mobile.TextBox",[_713,_714,_715],{baseClass:"mblTextBox",_setTypeAttr:null,_setPlaceHolderAttr:"textbox",buildRendering:function(){if(!this.srcNodeRef){this.srcNodeRef=_712.create("input",{"type":this.type});}this.inherited(arguments);this.textbox=this.focusNode=this.domNode;},postCreate:function(){this.inherited(arguments);this.connect(this.textbox,"onfocus","_onFocus");this.connect(this.textbox,"onblur","_onBlur");}});});},"dojox/mobile/Button":function(){define("dojox/mobile/Button",["dojo/_base/array","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dijit/_WidgetBase","dijit/form/_ButtonMixin","dijit/form/_FormWidgetMixin"],function(_716,_717,_718,_719,_71a,_71b,_71c){return _717("dojox.mobile.Button",[_71a,_71c,_71b],{baseClass:"mblButton",_setTypeAttr:null,duration:1000,_onClick:function(e){var ret=this.inherited(arguments);if(ret&&this.duration>=0){var _71d=this.focusNode||this.domNode;var _71e=(this.baseClass+" "+this["class"]).split(" ");_71e=_716.map(_71e,function(c){return c+"Selected";});_718.add(_71d,_71e);setTimeout(function(){_718.remove(_71d,_71e);},this.duration);}return ret;},isFocusable:function(){return false;},buildRendering:function(){if(!this.srcNodeRef){this.srcNodeRef=_719.create("button",{"type":this.type});}else{if(this._cv){var n=this.srcNodeRef.firstChild;if(n&&n.nodeType===3){n.nodeValue=this._cv(n.nodeValue);}}}this.inherited(arguments);this.focusNode=this.domNode;},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onclick","_onClick");},_setLabelAttr:function(_71f){this.inherited(arguments,[this._cv?this._cv(_71f):_71f]);}});});},"versa/api/ViewMappings":function(){define("versa/api/ViewMappings",["dojo/_base/declare","versa/api/_Collection","versa/api/Error","versa/api/ViewMapping"],function(_720){var o=_720("versa.api.ViewMappings",[versa.api._Collection],{constructor:function(args){this.zone=args.zone;this.library=args.library;this.target=dojo.replace(versa.api.ViewMappings.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.ViewMapping.schema;this.cache=false;this._initialize();},getMapping:function(_721,_722){return this.query({query:dojo.replace("?folder_id={0}&user_id={1}",[_721,_722])});}});o.TRGT="/zones/{0}/libraries/{1}/view_mappings";return o;});},"versa/api/Roles":function(){define("versa/api/Roles",["dojo/_base/declare","versa/api/_Collection","versa/api/Role"],function(_723){var o=_723("versa.api.Roles",[versa.api._Collection],{zone:null,constructor:function(args){this.zone=args.zone;this.target=dojo.replace(versa.api.Roles.TRGT,this.zone);this.schema=versa.api.Role.schema;this.cache=true;this._initialize();}});o.TRGT="/zones/{subdomain}/roles";return o;});},"versa/api/_Configurable":function(){define("versa/api/_Configurable",["dojo/_base/declare"],function(_724){return _724("versa.api._Configurable",[],{configuration:{configuration_settings:[]},constructor:function(args){},getValue:function(name){var _725=null;dojo.some(this.configuration.configuration_settings,function(_726,idx){if(_726.name.toLowerCase()==name.toLowerCase()){_725=_726.value;return true;}return false;},this);return _725;}});});},"dojox/mobile/TabBar":function(){define("dojox/mobile/TabBar",["dojo/_base/array","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dijit/_Contained","dijit/_Container","dijit/_WidgetBase","./Heading","./TabBarButton"],function(_727,_728,_729,_72a,_72b,_72c,_72d,_72e,_72f,_730,_731){return _728("dojox.mobile.TabBar",[_72f,_72e,_72d],{iconBase:"",iconPos:"",barType:"tabBar",inHeading:false,tag:"UL",_fixedButtonWidth:76,_fixedButtonMargin:17,_largeScreenWidth:500,buildRendering:function(){this._clsName=this.barType=="segmentedControl"?"mblTabButton":"mblTabBarButton";this.domNode=this.containerNode=this.srcNodeRef||_72a.create(this.tag);this.domNode.className=this.barType=="segmentedControl"?"mblTabPanelHeader":"mblTabBar";},startup:function(){if(this._started){return;}this.inherited(arguments);this.resize();},resize:function(size){var i,w;if(size&&size.w){_72b.setMarginBox(this.domNode,size);w=size.w;}else{w=_72c.get(this.domNode,"position")==="absolute"?_72b.getContentBox(this.domNode).w:_72b.getMarginBox(this.domNode).w;}var bw=this._fixedButtonWidth;var bm=this._fixedButtonMargin;var _732=this.containerNode.childNodes;var arr=[];for(i=0;i<_732.length;i++){var c=_732[i];if(c.nodeType!=1){continue;}if(_729.contains(c,this._clsName)){arr.push(c);}}var _733;if(this.barType=="segmentedControl"){_733=w;var _734=0;for(i=0;i<arr.length;i++){_733-=_72b.getMarginBox(arr[i]).w;_734+=arr[i].offsetWidth;}_733=Math.floor(_733/2);var _735=this.getParent();var _736=this.inHeading||_735 instanceof _730;this.containerNode.style.padding=(_736?0:3)+"px 0px 0px "+(_736?0:_733)+"px";if(_736){_72c.set(this.domNode,{background:"none",border:"none",width:_734+2+"px"});}_729.add(this.domNode,"mblTabBar"+(_736?"Head":"Top"));}else{_733=Math.floor((w-(bw+bm*2)*arr.length)/2);if(w<this._largeScreenWidth||_733<0){for(i=0;i<arr.length;i++){arr[i].style.width=Math.round(98/arr.length)+"%";arr[i].style.margin="0px";}this.containerNode.style.padding="0px 0px 0px 1%";}else{for(i=0;i<arr.length;i++){arr[i].style.width=bw+"px";arr[i].style.margin="0 "+bm+"px";}if(arr.length>0){arr[0].style.marginLeft=_733+bm+"px";}this.containerNode.style.padding="0px";}}if(!_727.some(this.getChildren(),function(_737){return _737.iconNode1;})){_729.add(this.domNode,"mblTabBarNoIcons");}else{_729.remove(this.domNode,"mblTabBarNoIcons");}if(!_727.some(this.getChildren(),function(_738){return _738.label;})){_729.add(this.domNode,"mblTabBarNoText");}else{_729.remove(this.domNode,"mblTabBarNoText");}}});});},"versa/api/Version":function(){define("versa/api/Version",["dojo/_base/declare","versa/api/_Object"],function(_739){var o=_739("versa.api.Version",[versa.api._Object],{zone:null,library:null,document:null,constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},copyLocal:function(args){var zone=args.zone;var _73a=args.library;var _73b=args.document;var url=dojo.replace(versa.api.Version.CP_TRGT,[zone.subdomain,_73a.id,_73b.id,this.id]);versa.api.Utilities.saveUrl({url:url,window_name:"versa_save"});},view:function(args){var zone=args.zone;var _73c=args.library;var _73d=args.document;var url=dojo.replace(versa.api.Version.VW_TRGT,[zone.subdomain,_73c.id,_73d.id,this.id]);versa.api.Utilities.viewUrl({windowBox:args.windowBox,url:url,window_name:"versa_viewer"});}});o.VW_TRGT="/zones/{0}/libraries/{1}/documents/{2}/download/?disposition=inline&version_id={3}";o.CP_TRGT="/zones/{0}/libraries/{1}/documents/{2}/download/?disposition=attachment&version_id={3}";o.schema={type:"object",properties:{"id":{type:"integer"},"binary_file_name":{type:"string","default":""},"binary_content_type":{type:"string","default":""}},prototype:new o()};return o;});},"dojox/mobile/scrollable":function(){define("dojox/mobile/scrollable",["dojo/_base/kernel","dojo/_base/connect","dojo/_base/event","dojo/_base/lang","dojo/_base/window","dojo/dom-class","dojo/dom-construct","dojo/dom-style","./sniff"],function(dojo,_73e,_73f,lang,win,_740,_741,_742,has){var dm=lang.getObject("dojox.mobile",true);var _743=function(dojo,_744){this.fixedHeaderHeight=0;this.fixedFooterHeight=0;this.isLocalFooter=false;this.scrollBar=true;this.scrollDir="v";this.weight=0.6;this.fadeScrollBar=true;this.disableFlashScrollBar=false;this.threshold=4;this.constraint=true;this.touchNode=null;this.isNested=false;this.dirLock=false;this.height="";this.androidWorkaroud=true;this.init=function(_745){if(_745){for(var p in _745){if(_745.hasOwnProperty(p)){this[p]=((p=="domNode"||p=="containerNode")&&typeof _745[p]=="string")?win.doc.getElementById(_745[p]):_745[p];}}}this.touchNode=this.touchNode||this.containerNode;this._v=(this.scrollDir.indexOf("v")!=-1);this._h=(this.scrollDir.indexOf("h")!=-1);this._f=(this.scrollDir=="f");this._ch=[];this._ch.push(_73e.connect(this.touchNode,has("touch")?"touchstart":"onmousedown",this,"onTouchStart"));if(has("webkit")){this._ch.push(_73e.connect(this.domNode,"webkitAnimationEnd",this,"onFlickAnimationEnd"));this._ch.push(_73e.connect(this.domNode,"webkitAnimationStart",this,"onFlickAnimationStart"));this._aw=this.androidWorkaroud&&has("android")>=2.2&&has("android")<3;if(this._aw){this._ch.push(_73e.connect(win.global,"onresize",this,"onScreenSizeChanged"));this._ch.push(_73e.connect(win.global,"onfocus",this,function(e){if(this.containerNode.style.webkitTransform){this.stopAnimation();this.toTopLeft();}}));this._sz=this.getScreenSize();}for(var i=0;i<3;i++){this.setKeyframes(null,null,i);}}if(has("iphone")){_742.set(this.containerNode,"webkitTransform","translate3d(0,0,0)");}this._speed={x:0,y:0};this._appFooterHeight=0;if(this.isTopLevel()&&!this.noResize){this.resize();}var _746=this;setTimeout(function(){_746.flashScrollBar();},600);};this.isTopLevel=function(){return true;};this.cleanup=function(){if(this._ch){for(var i=0;i<this._ch.length;i++){_73e.disconnect(this._ch[i]);}this._ch=null;}};this.findDisp=function(node){if(!node.parentNode){return null;}var _747=node.parentNode.childNodes;for(var i=0;i<_747.length;i++){var n=_747[i];if(n.nodeType===1&&_740.contains(n,"mblView")&&n.style.display!=="none"){return n;}}return node;};this.getScreenSize=function(){return {h:win.global.innerHeight||win.doc.documentElement.clientHeight||win.doc.documentElement.offsetHeight,w:win.global.innerWidth||win.doc.documentElement.clientWidth||win.doc.documentElement.offsetWidth};};this.isKeyboardShown=function(e){if(!this._sz){return false;}var sz=this.getScreenSize();return (sz.w*sz.h)/(this._sz.w*this._sz.h)<0.8;};this.disableScroll=function(v){if(this.disableTouchScroll===v||this.domNode.style.display==="none"){return;}this.disableTouchScroll=v;this.scrollBar=!v;dm.disableHideAddressBar=dm.disableResizeAll=v;var of=v?"visible":"hidden";_742.set(this.domNode,"overflow",of);_742.set(win.doc.documentElement,"overflow",of);_742.set(win.body(),"overflow",of);var c=this.containerNode;if(v){if(!c.style.webkitTransform){this.stopAnimation();this.toTopLeft();}var mt=parseInt(c.style.marginTop)||0;var h=c.offsetHeight+mt+this.fixedFooterHeight-this._appFooterHeight;_742.set(this.domNode,"height",h+"px");this._cPos={x:parseInt(c.style.left)||0,y:parseInt(c.style.top)||0};_742.set(c,{top:"0px",left:"0px"});var a=win.doc.activeElement;if(a){var at=0;for(var n=a;n.tagName!="BODY";n=n.offsetParent){at+=n.offsetTop;}var st=at+a.clientHeight+10-this.getScreenSize().h;if(st>0){win.body().scrollTop=st;}}}else{if(this._cPos){_742.set(c,{top:this._cPos.y+"px",left:this._cPos.x+"px"});this._cPos=null;}var tags=this.domNode.getElementsByTagName("*");for(var i=0;i<tags.length;i++){tags[i].blur&&tags[i].blur();}dm.resizeAll&&dm.resizeAll();}};this.onScreenSizeChanged=function(e){var sz=this.getScreenSize();if(sz.w*sz.h>this._sz.w*this._sz.h){this._sz=sz;}this.disableScroll(this.isKeyboardShown());};this.toTransform=function(e){var c=this.containerNode;if(c.offsetTop===0&&c.offsetLeft===0||!c._webkitTransform){return;}_742.set(c,{webkitTransform:c._webkitTransform,top:"0px",left:"0px"});c._webkitTransform=null;};this.toTopLeft=function(){var c=this.containerNode;if(!c.style.webkitTransform){return;}c._webkitTransform=c.style.webkitTransform;var pos=this.getPos();_742.set(c,{webkitTransform:"",top:pos.y+"px",left:pos.x+"px"});};this.resize=function(e){this._appFooterHeight=(this.fixedFooterHeight&&!this.isLocalFooter)?this.fixedFooterHeight:0;if(this.isLocalHeader){this.containerNode.style.marginTop=this.fixedHeaderHeight+"px";}var top=0;for(var n=this.domNode;n&&n.tagName!="BODY";n=n.offsetParent){n=this.findDisp(n);if(!n){break;}top+=n.offsetTop;}var h,_748=this.getScreenSize().h,dh=_748-top-this._appFooterHeight;if(this.height==="inherit"){if(this.domNode.offsetParent){h=this.domNode.offsetParent.offsetHeight+"px";}}else{if(this.height==="auto"){var _749=this.domNode.offsetParent;if(_749){this.domNode.style.height="0px";var _74a=_749.getBoundingClientRect(),_74b=this.domNode.getBoundingClientRect(),_74c=_74a.bottom-this._appFooterHeight;if(_74b.bottom>=_74c){dh=_748-(_74b.top-_74a.top)-this._appFooterHeight;}else{dh=_74c-_74b.bottom;}}var _74d=Math.max(this.domNode.scrollHeight,this.containerNode.scrollHeight);h=(_74d?Math.min(_74d,dh):dh)+"px";}else{if(this.height){h=this.height;}}}if(!h){h=dh+"px";}if(h.charAt(0)!=="-"&&h!=="default"){this.domNode.style.height=h;}this.onTouchEnd();};this.onFlickAnimationStart=function(e){_73f.stop(e);};this.onFlickAnimationEnd=function(e){var an=e&&e.animationName;if(an&&an.indexOf("scrollableViewScroll2")===-1){if(an.indexOf("scrollableViewScroll0")!==-1){_740.remove(this._scrollBarNodeV,"mblScrollableScrollTo0");}else{if(an.indexOf("scrollableViewScroll1")!==-1){_740.remove(this._scrollBarNodeH,"mblScrollableScrollTo1");}else{if(this._scrollBarNodeV){this._scrollBarNodeV.className="";}if(this._scrollBarNodeH){this._scrollBarNodeH.className="";}}}return;}if(e&&e.srcElement){_73f.stop(e);}this.stopAnimation();if(this._bounce){var _74e=this;var _74f=_74e._bounce;setTimeout(function(){_74e.slideTo(_74f,0.3,"ease-out");},0);_74e._bounce=undefined;}else{this.hideScrollBar();this.removeCover();if(this._aw){this.toTopLeft();}}};this.isFormElement=function(node){if(node&&node.nodeType!==1){node=node.parentNode;}if(!node||node.nodeType!==1){return false;}var t=node.tagName;return (t==="SELECT"||t==="INPUT"||t==="TEXTAREA"||t==="BUTTON");};this.onTouchStart=function(e){if(this.disableTouchScroll){return;}if(this._conn&&(new Date()).getTime()-this.startTime<500){return;}if(!this._conn){this._conn=[];this._conn.push(_73e.connect(win.doc,has("touch")?"touchmove":"onmousemove",this,"onTouchMove"));this._conn.push(_73e.connect(win.doc,has("touch")?"touchend":"onmouseup",this,"onTouchEnd"));}this._aborted=false;if(_740.contains(this.containerNode,"mblScrollableScrollTo2")){this.abort();}else{if(this._scrollBarNodeV){this._scrollBarNodeV.className="";}if(this._scrollBarNodeH){this._scrollBarNodeH.className="";}}if(this._aw){this.toTransform(e);}this.touchStartX=e.touches?e.touches[0].pageX:e.clientX;this.touchStartY=e.touches?e.touches[0].pageY:e.clientY;this.startTime=(new Date()).getTime();this.startPos=this.getPos();this._dim=this.getDim();this._time=[0];this._posX=[this.touchStartX];this._posY=[this.touchStartY];this._locked=false;if(!this.isFormElement(e.target)&&!this.isNested){_73f.stop(e);}};this.onTouchMove=function(e){if(this._locked){return;}var x=e.touches?e.touches[0].pageX:e.clientX;var y=e.touches?e.touches[0].pageY:e.clientY;var dx=x-this.touchStartX;var dy=y-this.touchStartY;var to={x:this.startPos.x+dx,y:this.startPos.y+dy};var dim=this._dim;dx=Math.abs(dx);dy=Math.abs(dy);if(this._time.length==1){if(this.dirLock){if(this._v&&!this._h&&dx>=this.threshold&&dx>=dy||(this._h||this._f)&&!this._v&&dy>=this.threshold&&dy>=dx){this._locked=true;return;}}if(this._v&&Math.abs(dy)<this.threshold||(this._h||this._f)&&Math.abs(dx)<this.threshold){return;}this.addCover();this.showScrollBar();}var _750=this.weight;if(this._v&&this.constraint){if(to.y>0){to.y=Math.round(to.y*_750);}else{if(to.y<-dim.o.h){if(dim.c.h<dim.d.h){to.y=Math.round(to.y*_750);}else{to.y=-dim.o.h-Math.round((-dim.o.h-to.y)*_750);}}}}if((this._h||this._f)&&this.constraint){if(to.x>0){to.x=Math.round(to.x*_750);}else{if(to.x<-dim.o.w){if(dim.c.w<dim.d.w){to.x=Math.round(to.x*_750);}else{to.x=-dim.o.w-Math.round((-dim.o.w-to.x)*_750);}}}}this.scrollTo(to);var max=10;var n=this._time.length;if(n>=2){var d0,d1;if(this._v&&!this._h){d0=this._posY[n-1]-this._posY[n-2];d1=y-this._posY[n-1];}else{if(!this._v&&this._h){d0=this._posX[n-1]-this._posX[n-2];d1=x-this._posX[n-1];}}if(d0*d1<0){this._time=[this._time[n-1]];this._posX=[this._posX[n-1]];this._posY=[this._posY[n-1]];n=1;}}if(n==max){this._time.shift();this._posX.shift();this._posY.shift();}this._time.push((new Date()).getTime()-this.startTime);this._posX.push(x);this._posY.push(y);};this.onTouchEnd=function(e){if(this._locked){return;}var _751=this._speed={x:0,y:0};var dim=this._dim;var pos=this.getPos();var to={};if(e){if(!this._conn){return;}for(var i=0;i<this._conn.length;i++){_73e.disconnect(this._conn[i]);}this._conn=null;var n=this._time.length;var _752=false;if(!this._aborted){if(n<=1){_752=true;}else{if(n==2&&Math.abs(this._posY[1]-this._posY[0])<4&&has("touch")){_752=true;}}}var _753=this.isFormElement(e.target);if(_752&&!_753){this.hideScrollBar();this.removeCover();if(has("touch")){var elem=e.target;if(elem.nodeType!=1){elem=elem.parentNode;}var ev=win.doc.createEvent("MouseEvents");ev.initMouseEvent("click",true,true,win.global,1,e.screenX,e.screenY,e.clientX,e.clientY);setTimeout(function(){elem.dispatchEvent(ev);},0);}return;}else{if(this._aw&&_752&&_753){this.hideScrollBar();this.toTopLeft();return;}}_751=this._speed=this.getSpeed();}else{if(pos.x==0&&pos.y==0){return;}dim=this.getDim();}if(this._v){to.y=pos.y+_751.y;}if(this._h||this._f){to.x=pos.x+_751.x;}this.adjustDestination(to,pos);if(this.scrollDir=="v"&&dim.c.h<dim.d.h){this.slideTo({y:0},0.3,"ease-out");return;}else{if(this.scrollDir=="h"&&dim.c.w<dim.d.w){this.slideTo({x:0},0.3,"ease-out");return;}else{if(this._v&&this._h&&dim.c.h<dim.d.h&&dim.c.w<dim.d.w){this.slideTo({x:0,y:0},0.3,"ease-out");return;}}}var _754,_755="ease-out";var _756={};if(this._v&&this.constraint){if(to.y>0){if(pos.y>0){_754=0.3;to.y=0;}else{to.y=Math.min(to.y,20);_755="linear";_756.y=0;}}else{if(-_751.y>dim.o.h-(-pos.y)){if(pos.y<-dim.o.h){_754=0.3;to.y=dim.c.h<=dim.d.h?0:-dim.o.h;}else{to.y=Math.max(to.y,-dim.o.h-20);_755="linear";_756.y=-dim.o.h;}}}}if((this._h||this._f)&&this.constraint){if(to.x>0){if(pos.x>0){_754=0.3;to.x=0;}else{to.x=Math.min(to.x,20);_755="linear";_756.x=0;}}else{if(-_751.x>dim.o.w-(-pos.x)){if(pos.x<-dim.o.w){_754=0.3;to.x=dim.c.w<=dim.d.w?0:-dim.o.w;}else{to.x=Math.max(to.x,-dim.o.w-20);_755="linear";_756.x=-dim.o.w;}}}}this._bounce=(_756.x!==undefined||_756.y!==undefined)?_756:undefined;if(_754===undefined){var _757,_758;if(this._v&&this._h){_758=Math.sqrt(_751.x+_751.x+_751.y*_751.y);_757=Math.sqrt(Math.pow(to.y-pos.y,2)+Math.pow(to.x-pos.x,2));}else{if(this._v){_758=_751.y;_757=to.y-pos.y;}else{if(this._h){_758=_751.x;_757=to.x-pos.x;}}}if(_757===0&&!e){return;}_754=_758!==0?Math.abs(_757/_758):0.01;}this.slideTo(to,_754,_755);};this.adjustDestination=function(to,pos){};this.abort=function(){this.scrollTo(this.getPos());this.stopAnimation();this._aborted=true;};this.stopAnimation=function(){_740.remove(this.containerNode,"mblScrollableScrollTo2");if(has("android")){_742.set(this.containerNode,"webkitAnimationDuration","0s");}if(this._scrollBarV){this._scrollBarV.className="";}if(this._scrollBarH){this._scrollBarH.className="";}};this.getSpeed=function(){var x=0,y=0,n=this._time.length;if(n>=2&&(new Date()).getTime()-this.startTime-this._time[n-1]<500){var dy=this._posY[n-(n>3?2:1)]-this._posY[(n-6)>=0?n-6:0];var dx=this._posX[n-(n>3?2:1)]-this._posX[(n-6)>=0?n-6:0];var dt=this._time[n-(n>3?2:1)]-this._time[(n-6)>=0?n-6:0];y=this.calcSpeed(dy,dt);x=this.calcSpeed(dx,dt);}return {x:x,y:y};};this.calcSpeed=function(d,t){return Math.round(d/t*100)*4;};this.scrollTo=function(to,_759,node){var s=(node||this.containerNode).style;if(has("webkit")){s.webkitTransform=this.makeTranslateStr(to);}else{if(this._v){s.top=to.y+"px";}if(this._h||this._f){s.left=to.x+"px";}}if(!_759){this.scrollScrollBarTo(this.calcScrollBarPos(to));}};this.slideTo=function(to,_75a,_75b){this._runSlideAnimation(this.getPos(),to,_75a,_75b,this.containerNode,2);this.slideScrollBarTo(to,_75a,_75b);};this.makeTranslateStr=function(to){var y=this._v&&typeof to.y=="number"?to.y+"px":"0px";var x=(this._h||this._f)&&typeof to.x=="number"?to.x+"px":"0px";return dm.hasTranslate3d?"translate3d("+x+","+y+",0px)":"translate("+x+","+y+")";};this.getPos=function(){if(has("webkit")){var m=win.doc.defaultView.getComputedStyle(this.containerNode,"")["-webkit-transform"];if(m&&m.indexOf("matrix")===0){var arr=m.split(/[,\s\)]+/);return {y:arr[5]-0,x:arr[4]-0};}return {x:0,y:0};}else{var y=parseInt(this.containerNode.style.top)||0;return {y:y,x:this.containerNode.offsetLeft};}};this.getDim=function(){var d={};d.c={h:this.containerNode.offsetHeight,w:this.containerNode.offsetWidth};d.v={h:this.domNode.offsetHeight+this._appFooterHeight,w:this.domNode.offsetWidth};d.d={h:d.v.h-this.fixedHeaderHeight-this.fixedFooterHeight,w:d.v.w};d.o={h:d.c.h-d.v.h+this.fixedHeaderHeight+this.fixedFooterHeight,w:d.c.w-d.v.w};return d;};this.showScrollBar=function(){if(!this.scrollBar){return;}var dim=this._dim;if(this.scrollDir=="v"&&dim.c.h<=dim.d.h){return;}if(this.scrollDir=="h"&&dim.c.w<=dim.d.w){return;}if(this._v&&this._h&&dim.c.h<=dim.d.h&&dim.c.w<=dim.d.w){return;}var _75c=function(self,dir){var bar=self["_scrollBarNode"+dir];if(!bar){var _75d=_741.create("div",null,self.domNode);var _75e={position:"absolute",overflow:"hidden"};if(dir=="V"){_75e.right="2px";_75e.width="5px";}else{_75e.bottom=(self.isLocalFooter?self.fixedFooterHeight:0)+2+"px";_75e.height="5px";}_742.set(_75d,_75e);_75d.className="mblScrollBarWrapper";self["_scrollBarWrapper"+dir]=_75d;bar=_741.create("div",null,_75d);_742.set(bar,{opacity:0.6,position:"absolute",backgroundColor:"#606060",fontSize:"1px",webkitBorderRadius:"2px",MozBorderRadius:"2px",webkitTransformOrigin:"0 0",zIndex:2147483647});_742.set(bar,dir=="V"?{width:"5px"}:{height:"5px"});self["_scrollBarNode"+dir]=bar;}return bar;};if(this._v&&!this._scrollBarV){this._scrollBarV=_75c(this,"V");}if(this._h&&!this._scrollBarH){this._scrollBarH=_75c(this,"H");}this.resetScrollBar();};this.hideScrollBar=function(){var _75f;if(this.fadeScrollBar&&has("webkit")){if(!dm._fadeRule){var node=_741.create("style",null,win.doc.getElementsByTagName("head")[0]);node.textContent=".mblScrollableFadeScrollBar{"+"  -webkit-animation-duration: 1s;"+"  -webkit-animation-name: scrollableViewFadeScrollBar;}"+"@-webkit-keyframes scrollableViewFadeScrollBar{"+"  from { opacity: 0.6; }"+"  to { opacity: 0; }}";dm._fadeRule=node.sheet.cssRules[1];}_75f=dm._fadeRule;}if(!this.scrollBar){return;}var f=function(bar,self){_742.set(bar,{opacity:0,webkitAnimationDuration:""});if(self._aw){bar.style.webkitTransform="";}else{bar.className="mblScrollableFadeScrollBar";}};if(this._scrollBarV){f(this._scrollBarV,this);this._scrollBarV=null;}if(this._scrollBarH){f(this._scrollBarH,this);this._scrollBarH=null;}};this.calcScrollBarPos=function(to){var pos={};var dim=this._dim;var f=function(_760,barH,t,d,c){var y=Math.round((d-barH-8)/(d-c)*t);if(y<-barH+5){y=-barH+5;}if(y>_760-5){y=_760-5;}return y;};if(typeof to.y=="number"&&this._scrollBarV){pos.y=f(this._scrollBarWrapperV.offsetHeight,this._scrollBarV.offsetHeight,to.y,dim.d.h,dim.c.h);}if(typeof to.x=="number"&&this._scrollBarH){pos.x=f(this._scrollBarWrapperH.offsetWidth,this._scrollBarH.offsetWidth,to.x,dim.d.w,dim.c.w);}return pos;};this.scrollScrollBarTo=function(to){if(!this.scrollBar){return;}if(this._v&&this._scrollBarV&&typeof to.y=="number"){if(has("webkit")){this._scrollBarV.style.webkitTransform=this.makeTranslateStr({y:to.y});}else{this._scrollBarV.style.top=to.y+"px";}}if(this._h&&this._scrollBarH&&typeof to.x=="number"){if(has("webkit")){this._scrollBarH.style.webkitTransform=this.makeTranslateStr({x:to.x});}else{this._scrollBarH.style.left=to.x+"px";}}};this.slideScrollBarTo=function(to,_761,_762){if(!this.scrollBar){return;}var _763=this.calcScrollBarPos(this.getPos());var _764=this.calcScrollBarPos(to);if(this._v&&this._scrollBarV){this._runSlideAnimation({y:_763.y},{y:_764.y},_761,_762,this._scrollBarV,0);}if(this._h&&this._scrollBarH){this._runSlideAnimation({x:_763.x},{x:_764.x},_761,_762,this._scrollBarH,1);}};this._runSlideAnimation=function(from,to,_765,_766,node,idx){if(has("webkit")){this.setKeyframes(from,to,idx);_742.set(node,{webkitAnimationDuration:_765+"s",webkitAnimationTimingFunction:_766});_740.add(node,"mblScrollableScrollTo"+idx);if(idx==2){this.scrollTo(to,true,node);}else{this.scrollScrollBarTo(to);}}else{if(dojo.fx&&dojo.fx.easing&&_765){var s=dojo.fx.slideTo({node:node,duration:_765*1000,left:to.x,top:to.y,easing:(_766=="ease-out")?dojo.fx.easing.quadOut:dojo.fx.easing.linear}).play();if(idx==2){_73e.connect(s,"onEnd",this,"onFlickAnimationEnd");}}else{if(idx==2){this.scrollTo(to,false,node);this.onFlickAnimationEnd();}else{this.scrollScrollBarTo(to);}}}};this.resetScrollBar=function(){var f=function(_767,bar,d,c,hd,v){if(!bar){return;}var _768={};_768[v?"top":"left"]=hd+4+"px";var t=(d-8)<=0?1:d-8;_768[v?"height":"width"]=t+"px";_742.set(_767,_768);var l=Math.round(d*d/c);l=Math.min(Math.max(l-8,5),t);bar.style[v?"height":"width"]=l+"px";_742.set(bar,{"opacity":0.6});};var dim=this.getDim();f(this._scrollBarWrapperV,this._scrollBarV,dim.d.h,dim.c.h,this.fixedHeaderHeight,true);f(this._scrollBarWrapperH,this._scrollBarH,dim.d.w,dim.c.w,0);this.createMask();};this.createMask=function(){if(!has("webkit")){return;}var ctx;if(this._scrollBarWrapperV){var h=this._scrollBarWrapperV.offsetHeight;ctx=win.doc.getCSSCanvasContext("2d","scrollBarMaskV",5,h);ctx.fillStyle="rgba(0,0,0,0.5)";ctx.fillRect(1,0,3,2);ctx.fillRect(0,1,5,1);ctx.fillRect(0,h-2,5,1);ctx.fillRect(1,h-1,3,2);ctx.fillStyle="rgb(0,0,0)";ctx.fillRect(0,2,5,h-4);this._scrollBarWrapperV.style.webkitMaskImage="-webkit-canvas(scrollBarMaskV)";}if(this._scrollBarWrapperH){var w=this._scrollBarWrapperH.offsetWidth;ctx=win.doc.getCSSCanvasContext("2d","scrollBarMaskH",w,5);ctx.fillStyle="rgba(0,0,0,0.5)";ctx.fillRect(0,1,2,3);ctx.fillRect(1,0,1,5);ctx.fillRect(w-2,0,1,5);ctx.fillRect(w-1,1,2,3);ctx.fillStyle="rgb(0,0,0)";ctx.fillRect(2,0,w-4,5);this._scrollBarWrapperH.style.webkitMaskImage="-webkit-canvas(scrollBarMaskH)";}};this.flashScrollBar=function(){if(this.disableFlashScrollBar||!this.domNode){return;}this._dim=this.getDim();if(this._dim.d.h<=0){return;}this.showScrollBar();var _769=this;setTimeout(function(){_769.hideScrollBar();},300);};this.addCover=function(){if(!has("touch")&&!this.noCover){if(!this._cover){this._cover=_741.create("div",null,win.doc.body);_742.set(this._cover,{backgroundColor:"#ffff00",opacity:0,position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",zIndex:2147483647});this._ch.push(_73e.connect(this._cover,has("touch")?"touchstart":"onmousedown",this,"onTouchEnd"));}else{this._cover.style.display="";}this.setSelectable(this._cover,false);this.setSelectable(this.domNode,false);}};this.removeCover=function(){if(!has("touch")&&this._cover){this._cover.style.display="none";this.setSelectable(this._cover,true);this.setSelectable(this.domNode,true);}};this.setKeyframes=function(from,to,idx){if(!dm._rule){dm._rule=[];}if(!dm._rule[idx]){var node=_741.create("style",null,win.doc.getElementsByTagName("head")[0]);node.textContent=".mblScrollableScrollTo"+idx+"{-webkit-animation-name: scrollableViewScroll"+idx+";}"+"@-webkit-keyframes scrollableViewScroll"+idx+"{}";dm._rule[idx]=node.sheet.cssRules[1];}var rule=dm._rule[idx];if(rule){if(from){rule.deleteRule("from");rule.insertRule("from { -webkit-transform: "+this.makeTranslateStr(from)+"; }");}if(to){if(to.x===undefined){to.x=from.x;}if(to.y===undefined){to.y=from.y;}rule.deleteRule("to");rule.insertRule("to { -webkit-transform: "+this.makeTranslateStr(to)+"; }");}}};this.setSelectable=function(node,_76a){node.style.KhtmlUserSelect=_76a?"auto":"none";node.style.MozUserSelect=_76a?"":"none";node.onselectstart=_76a?null:function(){return false;};if(has("ie")){node.unselectable=_76a?"":"on";var _76b=node.getElementsByTagName("*");for(var i=0;i<_76b.length;i++){_76b[i].unselectable=_76a?"":"on";}}};if(has("webkit")){var elem=win.doc.createElement("div");elem.style.webkitTransform="translate3d(0px,1px,0px)";win.doc.documentElement.appendChild(elem);var v=win.doc.defaultView.getComputedStyle(elem,"")["-webkit-transform"];dm.hasTranslate3d=v&&v.indexOf("matrix")===0;win.doc.documentElement.removeChild(elem);}};dm.scrollable=_743;return _743;});},"versa/api/_Collection":function(){define("versa/api/_Collection",["dojo/_base/declare","dojox/data/ClientFilter","dojox/data/JsonRestStore","versa/api/Error","versa/api/Utilities"],function(_76c){return _76c("versa.api._Collection",[],{store:null,target:null,schema:null,syncMode:true,cache:false,first:null,isLoaded:false,_fetch_onComplete:function(_76d,_76e){this.isLoaded=true;if((_76d!=null)&&(_76d.length>1)){this.first=_76d[0];}this.onFetchComplete(_76d);},_getExistingNames:function(args){var _76f=[];var _770=this.fetch();var _771=null;if(args){_771=args.exclude;}dojo.forEach(_770,function(item){if((item!=_771)&&(this.store.hasAttribute(item,"name"))){_76f.push(item.name);}},this);return _76f;},_getIdentity:function(item){var id=item.id;if(id){return id;}id=item.__clientId||item.__id;if(!id){return id;}var _772=this.service.servicePath.replace(/[^\/]*$/,"");return id.substring(0,_772.length)!=_772?id:id.substring(_772.length);},_initialize:function(){this.store=new dojox.data.JsonRestStore({target:this.target,idAttribute:"id",labelAttribute:"name",schema:this.schema,syncMode:this.syncMode,cacheByDefault:this.cache,clearOnClose:true,loadLazyValues:false,alwaysPostNewItems:true});},clearCache:function(){this.store.clearCache();},clone:function(args){this.store.changing(args.item);},constructor:function(){},containsValue:function(item,_773,_774){return this.store.containsValue(item,_773,_774);},create:function(args){var _775=this.store.newItem(args);this.store.changing(_775);return _775;},destroy:function(args){var _776=(args)?args.no_save:false;try{this.store.deleteItem(args.item);if(!_776){this.save({alwaysPostNewItems:true,onComplete:((args)&&(args.onComplete))?args.onComplete:function(){},scope:((args)&&(args.scope))?args.scope:this});}}finally{args.item.__isDirty=false;}},fetch:function(args){var _777=this.store.fetch({query:{},queryOptions:{cache:this.cache},onComplete:dojo.hitch(this,this._fetch_onComplete)});return _777.results;},fetchById:function(args){var item=this.store.fetchItemByIdentity({identity:args.id});return item;},fetchByName:function(name){var _778=null;function _779(_77a,_77b){dojo.some(_77a,function(item){if(item.name==name){_778=item;return false;}},this);};this.store.fetch({query:{},queryOptions:{cache:true},onComplete:_779});return _778;},fetchItemsByName:function(name){var _77c=new Array();function _77d(_77e,_77f){dojo.some(_77e,function(item){if(item.name==name){_77c.push(item);}},this);};this.store.fetch({query:{},queryOptions:{cache:true},onComplete:_77d});return _77c;},forEach:function(_780,_781){function _782(_783,_784){dojo.forEach(_783,_780,_781);};this.store.fetch({query:{},onComplete:_782});},isDirty:function(args){var item=(args)?args.item:null;return this.store.isDirty(item);},isNew:function(args){return ((args.item.id==undefined)||(args.item.id==null));},invalidate:function(_785){var _786=this.store.service.servicePath.replace(/[^\/]*$/,"");var _787=(_786||"")+_785;var item=this.store._index[_787];if(item){delete this.store._index[_787];}},isItemLoaded:function(args){return this.store.isItemLoaded(args);},loadItem:function(args){var err=null;var item=args.item;if(args.callback){args.onItem=args.callback;}var _788=(args.scope)?args.scope:this;this.store.loadItem({item:item,scope:_788,onItem:args.onItem,onError:args.onError});},merge:function(_789,_78a){for(var prop in _789){var _78b=_789[prop];if((_78b!=null)&&(typeof _78b=="object")&&(typeof _78b.getMonth!="function")){continue;}if(_78a.hasOwnProperty(prop)){var _78c=_78a[prop];if(_78c!=_78b){this.store.setValue(_789,prop,_78c);}}}},onFetchComplete:function(_78d){},query:function(args){var _78e=[];var _78f=this.store.fetch({query:args.query,queryOptions:{cache:false},sort:args.sort});if((_78f)&&(_78f.results)){_78e=_78f.results;}return _78e;},refresh:function(){this.store.clearCache();this.fetch();},refreshAsync:function(args){if(args.invalidate){this.invalidate(args.identity);}this.store.fetchItemByIdentity({scope:args.scope,identity:args.identity,onItem:args.onItem,onError:args.onError});},refreshItem:function(_790){var _791=this.store.fetch({query:_790,queryOptions:{cache:false}});return _791.results;},revert:function(args){this.store.revert();},save:function(args){var err=null;args=(!args)?{scope:this,onComplete:function(){}}:args;function _792(_793){err=new versa.api.Error(_793.responseText,_793);};this.store.save({alwaysPostNewItems:true,revertOnError:false,onError:_792,onComplete:((args)&&(args.onComplete))?args.onComplete:function(){},scope:((args)&&(args.scope))?args.scope:this});if(err){throw err;}},setDirty:function(item){this.store.changing(item);},setValue:function(item,attr,_794){this.store.setValue(item,attr,_794);},getValue:function(item,attr){return this.store.getValue(item,attr);},generateUniqueName:function(args){var _795=this.getExistingNames();var _796=args.base_name;var _797=args.appendix;return versa.api.Utilities.generateUniqueName({names:_795,base_name:_796,appendix:_797});},getExistingNames:function(args){var _798=[];var _799=this.fetch();var _79a=null;if(args){_79a=args.exclude;}dojo.forEach(_799,function(item){if((item!=_79a)&&(this.store.hasAttribute(item,"name"))){_798.push(item.name);}},this);return _798;},fetchDirtyItems:function(args){var _79b=[];var _79c=this.store.fetch({query:{__isDirty:true},queryOptions:{cache:false}});if((_79c)&&(_79c.results)){_79b=_79c.results;}return _79b;}});});},"dijit/a11y":function(){define("dijit/a11y",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-style","dojo/_base/sniff","./_base/manager","."],function(_79d,_79e,_79f,dom,_7a0,_7a1,has,_7a2,_7a3){var _7a4=(_7a3._isElementShown=function(elem){var s=_7a1.get(elem);return (s.visibility!="hidden")&&(s.visibility!="collapsed")&&(s.display!="none")&&(_7a0.get(elem,"type")!="hidden");});_7a3.hasDefaultTabStop=function(elem){switch(elem.nodeName.toLowerCase()){case "a":return _7a0.has(elem,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return true;case "iframe":var body;try{var _7a5=elem.contentDocument;if("designMode" in _7a5&&_7a5.designMode=="on"){return true;}body=_7a5.body;}catch(e1){try{body=elem.contentWindow.document.body;}catch(e2){return false;}}return body&&(body.contentEditable=="true"||(body.firstChild&&body.firstChild.contentEditable=="true"));default:return elem.contentEditable=="true";}};var _7a6=(_7a3.isTabNavigable=function(elem){if(_7a0.get(elem,"disabled")){return false;}else{if(_7a0.has(elem,"tabIndex")){return _7a0.get(elem,"tabIndex")>=0;}else{return _7a3.hasDefaultTabStop(elem);}}});_7a3._getTabNavigable=function(root){var _7a7,last,_7a8,_7a9,_7aa,_7ab,_7ac={};function _7ad(node){return node&&node.tagName.toLowerCase()=="input"&&node.type&&node.type.toLowerCase()=="radio"&&node.name&&node.name.toLowerCase();};var _7ae=function(_7af){for(var _7b0=_7af.firstChild;_7b0;_7b0=_7b0.nextSibling){if(_7b0.nodeType!=1||(has("ie")&&_7b0.scopeName!=="HTML")||!_7a4(_7b0)){continue;}if(_7a6(_7b0)){var _7b1=_7a0.get(_7b0,"tabIndex");if(!_7a0.has(_7b0,"tabIndex")||_7b1==0){if(!_7a7){_7a7=_7b0;}last=_7b0;}else{if(_7b1>0){if(!_7a8||_7b1<_7a9){_7a9=_7b1;_7a8=_7b0;}if(!_7aa||_7b1>=_7ab){_7ab=_7b1;_7aa=_7b0;}}}var rn=_7ad(_7b0);if(_7a0.get(_7b0,"checked")&&rn){_7ac[rn]=_7b0;}}if(_7b0.nodeName.toUpperCase()!="SELECT"){_7ae(_7b0);}}};if(_7a4(root)){_7ae(root);}function rs(node){return _7ac[_7ad(node)]||node;};return {first:rs(_7a7),last:rs(last),lowest:rs(_7a8),highest:rs(_7aa)};};_7a3.getFirstInTabbingOrder=function(root){var _7b2=_7a3._getTabNavigable(dom.byId(root));return _7b2.lowest?_7b2.lowest:_7b2.first;};_7a3.getLastInTabbingOrder=function(root){var _7b3=_7a3._getTabNavigable(dom.byId(root));return _7b3.last?_7b3.last:_7b3.highest;};return {hasDefaultTabStop:_7a3.hasDefaultTabStop,isTabNavigable:_7a3.isTabNavigable,_getTabNavigable:_7a3._getTabNavigable,getFirstInTabbingOrder:_7a3.getFirstInTabbingOrder,getLastInTabbingOrder:_7a3.getLastInTabbingOrder};});},"versa/api/Group":function(){define("versa/api/Group",["dojo/_base/declare","versa/api/_Object"],function(_7b4){var o=_7b4("versa.api.Group",[versa.api._Object],{description:null,constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},isValid:function(){var _7b5=true;if(String.isEmpty(this.name.trim())){_7b5=false;}return _7b5;}});o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":""},"description":{type:"string"},"active_users":{type:"array",items:{type:"integer"}},"created_at":{type:"date",format:"date-time"},"created_by":{type:"string"},"updated_at":{type:"date",format:"date-time"},"updated_by":{type:"string"}},prototype:new o()};return o;});},"versa/widget/document/mobile/DocumentPropertyView":function(){require(["dojo/_base/declare","dijit/_WidgetBase","dojox/mobile/Heading","dojox/mobile/ScrollableView","dojox/mobile/EdgeToEdgeDataList","dojox/mobile/ToolBarButton","versa/api/Folders","versa/api/Documents","versa/api/Zones","dojo/data/ItemFileWriteStore","dojo/date/locale"],function(_7b6){_7b6("versa.widget.document.mobile.DocumentPropertyView",[dijit._WidgetBase,dojox.mobile.ScrollableView],{document:null,reference:null,library:null,folders:null,references:null,documents:null,documentTypes:null,folderStore:null,refStore:null,docStore:null,docTypeStore:null,etedlMain:null,header:null,footer:null,constructor:function(args){},_setBackAttr:function(back){this.back=back;if(this.header){this.header.set("back",back);}},postCreate:function(){this.inherited("postCreate",arguments);this.folders=this.library.getFolders();this.references=this.library.getReferences();this.documents=this.library.getDocuments();this.documentTypes=this.library.getDocumentTypes();this.folderStore=this.folders.store;this.refStore=this.references.store;this.docStore=this.documents.store;this.docTypeStore=this.documentTypes.store;this.header=new versa.widget.mobile.Heading({label:this.document.name,from:this,back:this.back,onCommand:this.onCommand});this.footer=new versa.widget.mobile.Footing({reference:this.reference,onCommand:this.onCommand,from:this});var _7b7=[];_7b7.push({label:"Type",rightText:this.document.document_type_name});_7b7.push({label:"Version",rightText:this.document.getFullVersion()});_7b7.push({label:"Checked Out By",rightText:(this.document.getState(versa.api.Document.states.CHECKED_OUT)?this.document.checked_out_by:"")});_7b7.push({label:(this.document.isDeleted()?"Deletion Date":"Last Modified Date"),rightText:versa.api.Formatter.formatDateTime(this.document.updated_at)});this.documentType=this.documentTypes.fetchById({id:this.document.document_type_id});dojo.forEach(this.documentType.property_mappings,function(_7b8){var idx=0;var _7b9=this.library.getPropertyDefinitions().fetchById({id:_7b8.property_definition_id});if(!(_7b9.is_system)){var _7ba=this.document[_7b9.column_name];_7ba=versa.api.PropertyMapping.formatValue(_7b9,_7ba);var _7bb={label:_7b9.name,rightText:_7ba};if(_7b9.isTypeText()){_7bb.rightText=_7bb.rightText.display_limit(10);_7bb.clickable=true;_7bb.property=_7b9.column_name;_7bb.document=this.document;_7bb.onCommand=this.onCommand;_7bb.onClick=function(){this.onCommand(versa.widget.zone.mobile.Show.COMMANDS.SHOW_TEXT,{document:this.document,property:this.property,label:this.label});};}_7b7.push(_7bb);}},this);var _7bc={items:_7b7};var _7bd=new dojo.data.ItemFileWriteStore({data:_7bc});this.etedlMain=new dojox.mobile.EdgeToEdgeDataList({store:_7bd});this.addChild(this.header);this.addChild(this.footer);this.addChild(this.etedlMain);},startup:function(){this.inherited("startup",arguments);this.etedlMain.startup();}});});},"versa/widget/zone/mobile/Logon":function(){define("versa/widget/zone/mobile/Logon",["dojo/_base/declare","dijit/_WidgetBase","versa/widget/zone/mobile/LogonView","dojox/mobile/View"],function(_7be){return _7be("versa.widget.zone.mobile.Logon",[dijit._WidgetBase],{constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},postCreate:function(){this.inherited("postCreate",arguments);this.loadingView=dijit.byId("loadingView");},startup:function(){this.inherited("startup",arguments);this.logonView=new versa.widget.zone.mobile.LogonView({id:"logonView",zone:this.zone,onError:this.onError,onLogon:this.onLogon,onReset:this.onReset,onResetError:this.onError},dojo.create("div",{style:{height:"100%",width:"100%"}},dojo.body()));this.logonView.startup();this.loadingView=new dojox.mobile.View({id:"loadingView"});this.logonView.findAppBars();this.logonView.resize();}});});},"dijit/_Widget":function(){define("dijit/_Widget",["dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/query","dojo/ready","./registry","./_WidgetBase","./_OnDijitClickMixin","./_FocusMixin","dojo/uacss","./hccss"],function(_7bf,_7c0,_7c1,_7c2,_7c3,lang,_7c4,_7c5,_7c6,_7c7,_7c8,_7c9){function _7ca(){};function _7cb(_7cc){return function(obj,_7cd,_7ce,_7cf){if(obj&&typeof _7cd=="string"&&obj[_7cd]==_7ca){return obj.on(_7cd.substring(2).toLowerCase(),lang.hitch(_7ce,_7cf));}return _7cc.apply(_7c1,arguments);};};_7bf.around(_7c1,"connect",_7cb);if(_7c3.connect){_7bf.around(_7c3,"connect",_7cb);}var _7d0=_7c2("dijit._Widget",[_7c7,_7c8,_7c9],{onClick:_7ca,onDblClick:_7ca,onKeyDown:_7ca,onKeyPress:_7ca,onKeyUp:_7ca,onMouseDown:_7ca,onMouseMove:_7ca,onMouseOut:_7ca,onMouseOver:_7ca,onMouseLeave:_7ca,onMouseEnter:_7ca,onMouseUp:_7ca,constructor:function(_7d1){this._toConnect={};for(var name in _7d1){if(this[name]===_7ca){this._toConnect[name.replace(/^on/,"").toLowerCase()]=_7d1[name];delete _7d1[name];}}},postCreate:function(){this.inherited(arguments);for(var name in this._toConnect){this.on(name,this._toConnect[name]);}delete this._toConnect;},on:function(type,func){if(this[this._onMap(type)]===_7ca){return _7c1.connect(this.domNode,type.toLowerCase(),this,func);}return this.inherited(arguments);},_setFocusedAttr:function(val){this._focused=val;this._set("focused",val);},setAttribute:function(attr,_7d2){_7c3.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(attr,_7d2);},attr:function(name,_7d3){if(_7c0.isDebug){var _7d4=arguments.callee._ach||(arguments.callee._ach={}),_7d5=(arguments.callee.caller||"unknown caller").toString();if(!_7d4[_7d5]){_7c3.deprecated(this.declaredClass+"::attr() is deprecated. Use get() or set() instead, called from "+_7d5,"","2.0");_7d4[_7d5]=true;}}var args=arguments.length;if(args>=2||typeof name==="object"){return this.set.apply(this,arguments);}else{return this.get(name);}},getDescendants:function(){_7c3.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?_7c4("[widgetId]",this.containerNode).map(_7c6.byNode):[];},_onShow:function(){this.onShow();},onShow:function(){},onHide:function(){},onClose:function(){return true;}});if(!_7c3.isAsync){_7c5(0,function(){var _7d6=["dijit/_base"];require(_7d6);});}return _7d0;});},"dojo/touch":function(){define("dojo/touch",["./_base/kernel","./on","./has","./mouse"],function(dojo,on,has,_7d7){function _7d8(type){return function(node,_7d9){return on(node,type,_7d9);};};var _7da=has("touch");dojo.touch={press:_7d8(_7da?"touchstart":"mousedown"),move:_7d8(_7da?"touchmove":"mousemove"),release:_7d8(_7da?"touchend":"mouseup"),cancel:_7da?_7d8("touchcancel"):_7d7.leave};return dojo.touch;});},"versa/api/ViewDefinitions":function(){define("versa/api/ViewDefinitions",["dojo/_base/declare","versa/api/ViewDefinition","versa/api/_Collection","versa/api/CellDefinitions","versa/api/Error"],function(_7db){var o=_7db("versa.api.ViewDefinitions",[versa.api._Collection],{_system:null,documentTypes:null,_matchesQuery:function(item,_7dc){if(dojo.isArray(item)||(item.hasOwnProperty("column_order"))){return false;}var _7dd=_7dc.query;var _7de=_7dc.queryOptions&&_7dc.queryOptions.ignoreCase;for(var i in _7dd){var _7df=_7dd[i];var _7e0=this.getValue(item,i);if((typeof _7df=="string"&&(_7df.match(/[\*\.]/)||_7de))?!dojo.data.util.filter.patternToRegExp(_7df,_7de).test(_7e0):_7e0!=_7df){return false;}}return true;},copyFromTemplate:function(_7e1,user){var _7e2=_7e1.cell_definitions;var _7e3=this.create({cell_definitions:[],created_by:user.name,is_system:false,is_template:false,library_id:_7e1.library_id,name:_7e1.name,scope:_7e1.scope,sort_by:_7e1.sort_by,updated_by:user.name});dojo.forEach(_7e2,function(cell){_7e3.cell_definitions.push({column_name:cell.column_name,column_order:cell.column_order,date_format:cell.date_format,formatter:cell.formatter,label:cell.label,name:cell.name,noresize:cell.noresize,style:cell.style,table_name:cell.table_name,width:cell.width});},this);return _7e3;},_getDocumentAttr:function(_7e4,item){var _7e5="";var _7e6=this[0];var _7e7=this[1];if(!item){return _7e5;}var _7e8=_7e7.column_name;switch(_7e8){case "created_at":case "updated_at":_7e5=_7e6._formatDateTime(_7e7,item[_7e8]);break;default:if(/prp_dtt/.test(_7e8)&&item[_7e8]){_7e5=dojo.date.stamp.fromISOString(item[_7e8]);if(_7e5){_7e5=_7e6._formatDateTime(_7e7,_7e5);}}else{_7e5=item[_7e8];}break;}return _7e5;},_getDocumentTypeAttr:function(_7e9,item){var _7ea="";var _7eb=this[0];var _7ec=this[1];if(!item){return _7ea;}if(!item.document_type_id){return "";}var _7ed=_7eb.documentTypes.fetchById({id:item.document_type_id});switch(_7ec.column_name){case "name":_7ea=_7ed.name;break;}return _7ea;},_getVersionAttr:function(_7ee,item){var _7ef="";var _7f0=this[0];var _7f1=this[1];if(!item){return _7ef;}switch(_7f1.column_name){case "content_type":_7ef=(item.current_version)?item.current_version.content_type:"";break;case "version_number":_7ef=(item.current_version)?item.current_version.version_number:0;break;case "size":_7ef=(item.current_version)?item.current_version.size:0;break;}return _7ef;},constructor:function(args){this.zone=args.zone;this.library=args.library;this.target=dojo.replace(versa.api.ViewDefinitions.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.ViewDefinition.schema;this.cache=true;this.cellDefinitions=args.cellDefinitions;this._initialize();},cloneItem:function(_7f2){var _7f3=this.create({name:_7f2.name,is_system:false,description:_7f2.description,is_template:false,scope:_7f2.scope,sort_by:_7f2.sort_by});dojo.forEach(_7f2.cell_definitions,function(_7f4,idx){_7f3.cell_definitions.push(versa.api.CellDefinition.clone(_7f4));});return _7f3;},getSystem:function(){if(!this._system){this._system=new Array();this.forEach(function(item){if(item.is_system){this._system.push(item);}},this);}return this._system;},isValidItem:function(args){var _7f5=this.inherited(arguments);var item=args.item;if(!_7f5){return;}if(item.name.length<1){throw new Error("View Definition 'Name' is empty or invalid");}if((!item.sort_by)||(item.sort_by.length<1)){throw new Error("View Definition must have a 'Sort By' value");}return true;}});o.TRGT="/zones/{0}/libraries/{1}/view_definitions";return o;});},"versa/api/PropertyDefinition":function(){define("versa/api/PropertyDefinition",["dojo/_base/declare","versa/api/_Object"],function(_7f6){var o=_7f6("versa.api.PropertyDefinition",[versa.api._Object],{constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));},getDbName:function(){return dojo.replace("{table_name}.{column_name}",this);},isTypeDate:function(){return this.data_type_id==versa.api.DataTypes.types.DATETIME;},isTypeText:function(){return this.data_type_id==versa.api.DataTypes.types.TEXT;},isTypeInteger:function(){return this.data_type_id==versa.api.DataTypes.types.INTEGER;},isTypeFloat:function(){return this.data_type_id==versa.api.DataTypes.types.FLOAT;},isTypeAnyNumber:function(){return this.data_type_id==versa.api.DataTypes.types.INTEGER||this.data_type_id==versa.api.DataTypes.types.FLOAT;},isTypeBoolean:function(){return this.data_type_id==versa.api.DataTypes.types.BOOLEAN;},isValid:function(){var _7f7=true;if(String.isEmpty(this.name.trim())){_7f7=false;}if(!this.data_type_id){_7f7=false;}return _7f7;}});versa.api.Cardinality={"Single":1,"Multiple":2};o.compare=function(_7f8,_7f9){if(!_7f8.name||!_7f9.name){return 0;}return (_7f8.name.toLowerCase()>_7f9.name.toLowerCase())?1:-1;};o.schema={type:"object",properties:{"id":{type:"integer"},"name":{type:"string","default":""},"cardinality":{type:"integer","default":versa.api.Cardinality.Single},"column_name":{type:"string"},"created_at":{type:"date",format:"date-time"},"created_by":{type:"string"},"data_type_id":{type:"integer"},"description":{type:"string","default":""},"is_readonly":{type:"boolean","default":false},"is_system":{type:"boolean","default":false},"max_length":{type:"max_length"},"table_name":{type:"string"},"updated_at":{type:"date",format:"date-time"},"updated_by":{type:"string"}},prototype:new o()};return o;});},"dojox/mobile/ContentPane":function(){define("dojox/mobile/ContentPane",["dojo/_base/kernel","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dijit/_Contained","dijit/_WidgetBase","dojo/_base/xhr","./ProgressIndicator"],function(dojo,_7fa,_7fb,lang,win,_7fc,_7fd,xhr,_7fe){return _7fb("dojox.mobile.ContentPane",[_7fd,_7fc],{href:"",content:"",parseOnLoad:true,prog:true,buildRendering:function(){this.inherited(arguments);this.domNode.className="mblContentPane";if(!this.containerNode){this.containerNode=this.domNode;}},startup:function(){if(this._started){return;}if(this.prog){this._p=_7fe.getInstance();}var _7ff=this.getParent&&this.getParent();if(!_7ff||!_7ff.resize){this.resize();}this.inherited(arguments);},resize:function(){_7fa.forEach(this.getChildren(),function(_800){if(_800.resize){_800.resize();}});},loadHandler:function(_801){this.set("content",_801);},errorHandler:function(err){if(this._p){this._p.stop();}},onLoad:function(){},_setHrefAttr:function(href){var p=this._p;if(p){win.body().appendChild(p.domNode);p.start();}this.href=href;xhr.get({url:href,handleAs:"text",load:lang.hitch(this,"loadHandler"),error:lang.hitch(this,"errorHandler")});},_setContentAttr:function(data){this.destroyDescendants();if(typeof data==="object"){this.domNode.appendChild(data);}else{this.domNode.innerHTML=data;}if(this.parseOnLoad){dojo.parser.parse(this.domNode);}if(this._p){this._p.stop();}this.onLoad();}});});},"versa/api/Folder":function(){define("versa/api/Folder",["dojo/_base/declare","versa/api/_Object","versa/api/_Securable","versa/api/Acl","versa/api/Search"],function(_802){var o=_802("versa.api.Folder",[versa.api._Object,versa.api._Securable],{_activeQuery:null,_searchFolder:null,_shareRootFolder:null,_trashFolder:null,constructor:function(args){dojo.safeMixin(this,((!args)?{}:args));this.securable_type=versa.api._Securable.types.Folder;},childNameExists:function(name,_803){return dojo.some(this.children,function(_804){if(_804.getId()==_803){return false;}return (_804.name.toLowerCase()==name.toLowerCase());},this);},getActiveQuery:function(){if(!this._activeQuery){this._activeQuery=new versa.api.Search({type:(this.isTrash()?versa.api.Search.types.TRASH:versa.api.Search.types.FOLDER),queryData:this.getId(),view_definition_id:this.view_definition_id});}return this._activeQuery;},getPermissionSet:function(_805,user){var _806=new versa.api.PermissionSet();_806.setValue(versa.api.PermissionIndices.VIEW,true);_806.setValue(versa.api.PermissionIndices.COPY,true);_806.setValue(versa.api.PermissionIndices.EDIT,this.hasRights(versa.api._Securable.permissions.WRITE_METADATA)&&(!this.isSpecial()||this.isShare())&&(!this.isRoot()));_806.setValue(versa.api.PermissionIndices.CREATE,this.hasRights(versa.api._Securable.permissions.CREATE_FOLDERS)&&(!(this.isTrash()||this.isSearch()||this.isShare())));_806.setValue(versa.api.PermissionIndices.FILE,this.hasRights(versa.api._Securable.permissions.CREATE_DOCUMENTS)&&(!this.isSpecial()));_806.setValue(versa.api.PermissionIndices.DELETE,this.hasRights(versa.api._Securable.permissions.DELETE_ITEMS)&&(!this.isRoot()));_806.setValue(versa.api.PermissionIndices.SECURE,this.hasRights(versa.api._Securable.permissions.WRITE_ACL)&&(!this.isSpecial()||this.isShareRoot()||this.isShare()));return _806;},getSearchFolder:function(){if(!this._searchFolder){dojo.every(this.children,function(item,idx){if(item.isSearch()){this._searchFolder=item;}return (!this._searchFolder);},this);}return this._searchFolder;},getShareRootFolder:function(){if(!this._shareRootFolder){dojo.every(this.children,function(item,idx){if(item.isShareRoot()){this._shareRootFolder=item;}return (!this._shareRootFolder);},this);}return this._shareRootFolder;},getTrashFolder:function(){if(!this._trashFolder){dojo.every(this.children,function(item,idx){if(item.isTrash()){this._trashFolder=item;}return (!this._trashFolder);},this);}return this._trashFolder;},isContent:function(){return (this.folder_type==versa.api.Folder.FolderTypes.CONTENT);},isError:function(){return (this.folder_type==versa.api.Folder.FolderTypes.ERROR);},isRoot:function(){return (this.folder_type==versa.api.Folder.FolderTypes.ROOT);},isSearch:function(){return (this.folder_type==versa.api.Folder.FolderTypes.SEARCH);},isShare:function(){return (this.folder_type==versa.api.Folder.FolderTypes.SHARE);},isShareRoot:function(){return (this.folder_type==versa.api.Folder.FolderTypes.SHARE_ROOT);},isSpecial:function(){return (this.folder_type==versa.api.Folder.FolderTypes.SEARCH||this.folder_type==versa.api.Folder.FolderTypes.TRASH||this.folder_type==versa.api.Folder.FolderTypes.SHARE||this.folder_type==versa.api.Folder.FolderTypes.SHARE_ROOT);},isTrash:function(){return (this.folder_type==versa.api.Folder.FolderTypes.TRASH);},setActiveQuery:function(_807){this._activeQuery=_807;this._activeQuery.view_definition_id=this.view_definition_id;},shareItems:function(args){var zone=args.zone;var _808=args.library;var ids=[];dojo.forEach(args.references,function(_809){ids.push(_809.getId());},this);var url=dojo.replace(versa.api.Folder.SHAREITEMS_TRGT,[zone.subdomain,_808.id,this.getId()]);var _80a={reference_ids:ids};var _80b=versa.api.XhrHelper.doPutAction({target:url,putData:_80a});return true;}});o.SHAREITEMS_TRGT="/zones/{0}/libraries/{1}/folders/{2}/share_items.json";o.FolderTypes={"ROOT":0,"CONTENT":1,"SHARE_ROOT":16,"SHARE":17,"SEARCH":32,"TRASH":64,"ERROR":65535};o.getIconUrl=function(_80c,size){var _80d="content";switch(_80c.folder_type){case versa.api.Folder.FolderTypes.TRASH:_80d="recyclebin";break;case versa.api.Folder.FolderTypes.SEARCH:_80d="search";break;case versa.api.Folder.FolderTypes.SHARE_ROOT:_80d="share_root";break;}return dojo.replace("/images/mimetypes/{0}/{1}.png",[size,_80d]);};o.getTypeLabel=function(_80e){var _80f="Content";switch(_80e.folder_type){case versa.api.Folder.FolderTypes.TRASH:_80f="Deleted Items";break;case versa.api.Folder.FolderTypes.SEARCH:_80f="Search Results";break;case versa.api.Folder.FolderTypes.SHARE_ROOT:_80f="Shared Folders";break;case versa.api.Folder.FolderTypes.SHARE:_80f="Shared Files";break;}return _80f;};o.sort=function(_810,_811){if((_810.folder_type!=versa.api.Folder.FolderTypes.CONTENT)||(_811.folder_type!=versa.api.Folder.FolderTypes.CONTENT)){if(_810.folder_type>_811.folder_type){return -1;}return 1;}if(_810.name==_811.name){return 0;}return (_810.name?_810.name:"").toLowerCase()<(_811.name?_811.name:"").toLowerCase()?-1:1;};o.permissionIndices={"CREATE":0,"VIEW":1,"FILE":2,"DELETE":3,"SECURE":4};o.schema={type:"object",properties:{"id":{type:"integer"},"folder_type":{type:"integer"},"name":{type:"string","default":""},"expiry":{type:["string","object","null"],format:"date-time"},"created_at":{type:"string",format:"date-time","default":dojo.date.stamp.toISOString(new Date(),{zulu:true})},"created_by":{type:"string","default":""},"updated_at":{type:"string",format:"date-time","default":dojo.date.stamp.toISOString(new Date(),{zulu:true})},"updated_by":{type:"string","default":""},"text_path":{type:"string","default":""},"document_count":{type:"integer","default":0}},prototype:new o()};return o;});},"versa/widget/search/mobile/SearchResultsView":function(){require(["dojo/_base/declare","dijit/_WidgetBase","dojox/mobile/Heading","dojox/mobile/ScrollableView","dojox/mobile/EdgeToEdgeDataList","dojox/mobile/ToolBarButton","versa/api/Folders","versa/api/Documents","versa/api/Zones","dojo/data/ItemFileWriteStore"],function(_812){_812("versa.widget.search.mobile.SearchResultsView",[dijit._WidgetBase,dojox.mobile.ScrollableView],{folder:null,library:null,folders:null,references:null,folderStore:null,refStore:null,etedlMain:null,header:null,footer:null,constructor:function(args){},_setSearchAttr:function(_813){if(this.search!=_813){this.search=_813;var _814=this.refStore.fetch({query:{type:2,query:_813,view:this.view_id}}).results;var _815=[];dojo.forEach(_814,function(_816){_815.push({label:_816.name,item:_816,from:this,onCommand:this.onCommand,icon:"../../images/mimetypes/32/default.png",clickable:true,onClick:function(){this.onCommand(versa.widget.zone.mobile.Show.COMMANDS.SHOW_DOCUMENT_PROPERTIES,{from:this.from,reference:this.item});}});},this);var _817={items:_815};var _818=new dojo.data.ItemFileWriteStore({data:_817});this.etedlMain.setStore(_818);}},postCreate:function(){this.inherited("postCreate",arguments);this.folders=this.library.getFolders();this.references=this.library.getReferences();this.folderStore=this.folders.store;this.refStore=this.references.store;this.header=new versa.widget.mobile.Heading({label:"Search",from:this,back:this.back,onCommand:this.onCommand});this.footer=new versa.widget.mobile.Footing({onCommand:this.onCommand,from:this});this.etedlMain=new dojox.mobile.EdgeToEdgeDataList({iconBase:"../../images/mimetypes/48/default.png"});this.addChild(this.header);this.addChild(this.footer);this.addChild(this.etedlMain);},startup:function(){this.inherited("startup",arguments);this.etedlMain.startup();}});});}}});require(["dojo/i18n"],function(i18n){i18n._preloadLocalizations("dojo/nls/versa_mobile",["en-us"]);});define("dojo/versa_mobile",[],1);