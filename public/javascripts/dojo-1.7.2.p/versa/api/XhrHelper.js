//>>built
define("versa/api/XhrHelper",["dojo/_base/declare","dojox/json/ref","versa/api/Error"],function(_1){var o=_1("versa.api.XhrHelper",[],{});o._doXhrAction=function(_2,_3){var _4=null;var _5=null;function _6(_7,_8){_4=_7;};function _9(_a,_b){_5=new versa.api.Error(_a.responseText,_a);};_3.contentType="application/json";_3.handleAs="json";_3.sync=true;_3.load=_6;_3.error=_9;_2(_3);if(_5!=null){throw _5;}return _4;};o.doGetAction=function(_c){var _d=(_c.getData)?dojo.toJson(_c.getData):null;var _e={url:_c.target,content:_d};return versa.api.XhrHelper._doXhrAction(dojo.xhrGet,_e);};o.doPostAction=function(_f){var _10=_f.postData;var _11=dojo.toJson(_10);var _12={url:_f.target,postData:_11};return versa.api.XhrHelper._doXhrAction(dojo.xhrPost,_12);};o.doPutAction=function(_13){var _14=_13.putData;var _15=dojo.toJson(_14);var _16={url:_13.target,putData:_15};return versa.api.XhrHelper._doXhrAction(dojo.xhrPut,_16);};o.authenticity_token=null;o.originalXhr=dojo.xhr;dojo.xhr=function(_17,_18,_19){if(versa.api.XhrHelper.authenticity_token!=null){if(_17.toUpperCase()=="POST"){var _1a=(_18.postData)?dojo.fromJson(_18.postData):{};_1a["authenticity_token"]=versa.api.XhrHelper.authenticity_token;_18.postData=dojo.toJson(_1a);}if(_17.toUpperCase()=="PUT"){var _1b=(_18.putData)?dojo.fromJson(_18.putData):{};_1b["authenticity_token"]=versa.api.XhrHelper.authenticity_token;_18.putData=dojo.toJson(_1b);}if(_17.toUpperCase()=="DELETE"){_18.rawBody=dojo.toJson({authenticity_token:versa.api.XhrHelper.authenticity_token});}}if((_18.headers)&&_18.headers.hasOwnProperty("Range")){_18.headers["dojo-Range"]=_18.headers["Range"];}return versa.api.XhrHelper.originalXhr(_17,_18,_19);};return o;});