//>>built
define("versa/api/Folder",["dojo/_base/declare","versa/api/_Object","versa/api/_Securable","versa/api/Acl","versa/api/Search"],function(_1){var o=_1("versa.api.Folder",[versa.api._Object,versa.api._Securable],{_activeQuery:null,_searchFolder:null,_shareRootFolder:null,_trashFolder:null,constructor:function(_2){dojo.safeMixin(this,((!_2)?{}:_2));this.securable_type=versa.api._Securable.types.Folder;},childNameExists:function(_3,_4){return dojo.some(this.children,function(_5){if(_5.getId()==_4){return false;}return (_5.name.toLowerCase()==_3.toLowerCase());},this);},getActiveQuery:function(){if(!this._activeQuery){this._activeQuery=new versa.api.Search({type:(this.isTrash()?versa.api.Search.types.TRASH:versa.api.Search.types.FOLDER),queryData:this.getId(),view_definition_id:this.view_definition_id});}return this._activeQuery;},getPermissionSet:function(_6,_7){var _8=new versa.api.PermissionSet();_8.setValue(versa.api.PermissionIndices.VIEW,true);_8.setValue(versa.api.PermissionIndices.COPY,true);_8.setValue(versa.api.PermissionIndices.EDIT,this.hasRights(versa.api._Securable.permissions.WRITE_METADATA)&&(!this.isSpecial()||this.isShare())&&(!this.isRoot()));_8.setValue(versa.api.PermissionIndices.CREATE,this.hasRights(versa.api._Securable.permissions.CREATE_FOLDERS)&&(!(this.isTrash()||this.isSearch()||this.isShare())));_8.setValue(versa.api.PermissionIndices.FILE,this.hasRights(versa.api._Securable.permissions.CREATE_DOCUMENTS)&&(!this.isSpecial()));_8.setValue(versa.api.PermissionIndices.DELETE,this.hasRights(versa.api._Securable.permissions.DELETE_ITEMS)&&(!this.isRoot()));_8.setValue(versa.api.PermissionIndices.SECURE,this.hasRights(versa.api._Securable.permissions.WRITE_ACL)&&(!this.isSpecial()||this.isShareRoot()||this.isShare()));return _8;},getSearchFolder:function(){if(!this._searchFolder){dojo.every(this.children,function(_9,_a){if(_9.isSearch()){this._searchFolder=_9;}return (!this._searchFolder);},this);}return this._searchFolder;},getShareRootFolder:function(){if(!this._shareRootFolder){dojo.every(this.children,function(_b,_c){if(_b.isShareRoot()){this._shareRootFolder=_b;}return (!this._shareRootFolder);},this);}return this._shareRootFolder;},getTrashFolder:function(){if(!this._trashFolder){dojo.every(this.children,function(_d,_e){if(_d.isTrash()){this._trashFolder=_d;}return (!this._trashFolder);},this);}return this._trashFolder;},isContent:function(){return (this.folder_type==versa.api.Folder.FolderTypes.CONTENT);},isError:function(){return (this.folder_type==versa.api.Folder.FolderTypes.ERROR);},isRoot:function(){return (this.folder_type==versa.api.Folder.FolderTypes.ROOT);},isSearch:function(){return (this.folder_type==versa.api.Folder.FolderTypes.SEARCH);},isShare:function(){return (this.folder_type==versa.api.Folder.FolderTypes.SHARE);},isShareRoot:function(){return (this.folder_type==versa.api.Folder.FolderTypes.SHARE_ROOT);},isSpecial:function(){return (this.folder_type==versa.api.Folder.FolderTypes.SEARCH||this.folder_type==versa.api.Folder.FolderTypes.TRASH||this.folder_type==versa.api.Folder.FolderTypes.SHARE||this.folder_type==versa.api.Folder.FolderTypes.SHARE_ROOT);},isTrash:function(){return (this.folder_type==versa.api.Folder.FolderTypes.TRASH);},setActiveQuery:function(_f){this._activeQuery=_f;this._activeQuery.view_definition_id=this.view_definition_id;},shareItems:function(_10){var _11=_10.zone;var _12=_10.library;var ids=[];dojo.forEach(_10.references,function(_13){ids.push(_13.getId());},this);var url=dojo.replace(versa.api.Folder.SHAREITEMS_TRGT,[_11.subdomain,_12.id,this.getId()]);var _14={reference_ids:ids};var _15=versa.api.XhrHelper.doPutAction({target:url,putData:_14});return true;}});o.SHAREITEMS_TRGT="/zones/{0}/libraries/{1}/folders/{2}/share_items.json";o.FolderTypes={"ROOT":0,"CONTENT":1,"SHARE_ROOT":16,"SHARE":17,"SEARCH":32,"TRASH":64,"ERROR":65535};o.getIconUrl=function(_16,_17){var _18="content";switch(_16.folder_type){case versa.api.Folder.FolderTypes.TRASH:_18="recyclebin";break;case versa.api.Folder.FolderTypes.SEARCH:_18="search";break;case versa.api.Folder.FolderTypes.SHARE_ROOT:_18="share_root";break;}return dojo.replace("/images/mimetypes/{0}/{1}.png",[_17,_18]);};o.getTypeLabel=function(_19){var _1a="Content";switch(_19.folder_type){case versa.api.Folder.FolderTypes.TRASH:_1a="Deleted Items";break;case versa.api.Folder.FolderTypes.SEARCH:_1a="Search Results";break;case versa.api.Folder.FolderTypes.SHARE_ROOT:_1a="Shared Folders";break;case versa.api.Folder.FolderTypes.SHARE:_1a="Shared Files";break;}return _1a;};o.sort=function(_1b,_1c){if((_1b.folder_type!=versa.api.Folder.FolderTypes.CONTENT)||(_1c.folder_type!=versa.api.Folder.FolderTypes.CONTENT)){if(_1b.folder_type>_1c.folder_type){return -1;}return 1;}if(_1b.name==_1c.name){return 0;}return (_1b.name?_1b.name:"").toLowerCase()<(_1c.name?_1c.name:"").toLowerCase()?-1:1;};o.permissionIndices={"CREATE":0,"VIEW":1,"FILE":2,"DELETE":3,"SECURE":4};o.schema={type:"object",properties:{"id":{type:"integer"},"folder_type":{type:"integer"},"name":{type:"string","default":""},"expiry":{type:["string","object","null"],format:"date-time"},"created_at":{type:"string",format:"date-time","default":dojo.date.stamp.toISOString(new Date(),{zulu:true})},"created_by":{type:"string","default":""},"updated_at":{type:"string",format:"date-time","default":dojo.date.stamp.toISOString(new Date(),{zulu:true})},"updated_by":{type:"string","default":""},"text_path":{type:"string","default":""},"document_count":{type:"integer","default":0}},prototype:new o()};return o;});