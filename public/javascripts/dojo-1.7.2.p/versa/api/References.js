//>>built
define("versa/api/References",["dojo/_base/declare","versa/api/_Collection","versa/api/Reference"],function(_1){var o=_1("versa.api.References",[versa.api._Collection],{library:null,zone:null,_isUpdateable:function(_2){return false;},_softDelete:function(_3){var _4=dojo.replace(versa.api.References.SDEL_TRGT,[this.zone.subdomain,this.library.getId(),_3.getId()]);var _5={};var _6=versa.api.XhrHelper.doPutAction({target:_4,putData:_5});return _6;},constructor:function(_7){this.zone=_7.zone;this.library=_7.library;this.target=dojo.replace(versa.api.References.TRGT,[this.zone.subdomain,this.library.id]);this.schema=versa.api.Reference.schema;this.cache=false;this._initialize();this.store.isUpdateable=dojo.hitch(this,this._isUpdateable);},destroy:function(_8){var _9=_8.item;if((_9.isInstanceOf(versa.api.Reference))&&(_8.soft)){_9=this._softDelete(_9);this.store.onDelete(_9);}else{this.inherited("destroy",arguments);}},export_query:function(_a){var _b=dojo.objectToQuery(_a.query);var _c=dojo.replace("sort({0}{1})",[(_a.sort.descending?"-":"+"),encodeURIComponent(_a.sort.attribute)]);var _d="json";switch(_a.type){case versa.api.References.ExportTypes.CSV:_d="csv";break;case versa.api.References.ExportTypes.PDF:_d="pdf";break;case versa.api.References.ExportTypes.XML:_d="xml";break;}var _e=dojo.replace(versa.api.References.EXPORT_TRGT,[_a.zone.subdomain,_a.library.id,_b,_c,_d]);if(_a.type==versa.api.Documents.ExportTypes.PDF){versa.api.Utilities.viewUrl({windowBox:_a.windowBox,url:_e,window_name:"versa_save"});}else{versa.api.Utilities.saveUrl({url:_e,window_name:"versa_save"});}},print_query:function(_f){var _10=dojo.objectToQuery(_f.query);var _11=dojo.replace("sort({0}{1})",[(_f.sort.descending?"-":"+"),encodeURIComponent(_f.sort.attribute)]);var url=dojo.replace(versa.api.References.PRINT_TRGT,[_f.zone.subdomain,_f.library.id,_10,_11,"html"]);versa.api.Utilities.viewUrl({windowBox:_f.windowBox,url:url,window_name:"versa_printer"});}});o.ExportTypes={"NONE":0,"CSV":1,"PDF":2,"XML":3};o.TRGT="/zones/{0}/libraries/{1}/references";o.SDEL_TRGT="/zones/{0}/libraries/{1}/references/{2}/soft_delete.json";o.PRINT_TRGT="/zones/{0}/libraries/{1}/references?{2}&{3}";o.EXPORT_TRGT="/zones/{0}/libraries/{1}/references.{4}?{2}&{3}";return o;});