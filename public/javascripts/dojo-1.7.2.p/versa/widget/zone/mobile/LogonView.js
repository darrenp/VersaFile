//>>built
define("versa/widget/zone/mobile/LogonView",["dojo/_base/declare","dijit/_Widget","dijit/_TemplatedMixin","dijit/form/Form","versa/api/User","dojox/mobile/Button","dojox/mobile/ScrollableView","dojox/mobile/ContentPane","versa/widget/mobile/TextBox","dojox/mobile/Heading"],function(_1){var o=_1("versa.widget.zone.mobile.LogonView",[dijit._WidgetBase,dojox.mobile.ScrollableView],{_btnReset:null,_btnSubmit:null,_frmLogon:null,_txtEmail:null,_txtPassword:null,_txtResetName:null,_txtUserName:null,user:null,zone:null,_onResetClick:function(e){var a1=dojo.fadeOut({node:this.logonNode,duration:500,onEnd:dojo.hitch(this,function(){dojo.toggleClass(this.logonNode,"versaHide",true);dojo.toggleClass(this.resetNode,"versaHide",false);var _2=this._txtUsername.get("value");this._txtResetName.set("value",_2);})});var a2=dojo.fadeIn({node:this.resetNode,duration:500,onEnd:dojo.hitch(this,function(){this._btnReset.set("disabled",true);this._txtResetName.blur();this._txtResetName.validate();this._txtEmail.blur();this._txtEmail.validate();this._txtResetName.focus();this._btnReset.set("disabled",false);})});dojo.fx.chain([a1,a2]).play();},_onReturnClick:function(e){var a1=dojo.fadeOut({node:this.resetNode,duration:500,onEnd:dojo.hitch(this,function(){dojo.toggleClass(this.logonNode,"versaHide",false);dojo.toggleClass(this.resetNode,"versaHide",true);})});var a2=dojo.fadeIn({node:this.logonNode,duration:500,onEnd:dojo.hitch(this,function(){this._txtPassword.reset();this._txtUsername.setFocus();})});dojo.fx.chain([a1,a2]).play();},_onResetSubmit:function(e){try{if(this._frmReset.validate()){var _3=this._txtResetName.get("value");var _4=this._txtEmail.get("value");this.zone.resetPassword(_3,_4);this.onReset(_3);this._txtUsername.set("value",_3);}}catch(e){this.onResetError(e);this._txtResetName.reset();this._txtEmail.reset();this._txtResetName.setFocus();}finally{e.preventDefault();}},_onLogonSubmit:function(e){try{if(this._frmLogon.isValid()){var _5=this._txtUsername.get("value");var _6=this._txtPassword.get("value");var _7=this.zone.logon(_5,_6);this.onLogon(_7);}else{this._txtUsername.validate();}}catch(e){this.onError(e);this._txtPassword.reset();this._txtUsername.setFocus(true);}finally{e.preventDefault();}},constructor:function(_8){},onError:function(e){},onLogon:function(_9){},onReset:function(_a){},onResetError:function(e){},postCreate:function(){this.inherited("postCreate",arguments);this.heading=new dojox.mobile.Heading({fixed:"top"});this.heading.domNode.innerHTML="<img src=\"/images/versafile-32-tm.png\"/>";this.addChild(this.heading);this.cpContent=new dojox.mobile.ContentPane({content:dojo.cache("versa.widget.zone.mobile","template/Logon.html","<div align=\"center\">\n    <div id=\"logonFormNode\">\n\n        <div>\n            <div>Username</div>\n            <input id=\"userNameNode\"/>\n        </div>\n\n        <div>\n            <div>Password</div>\n            <input id=\"passwordNode\"/>\n        </div>\n\n        <table id=\"statusNode\">\n            <tr>\n                <td style=\"vertical-align:top;\">\n                    <img id=\"statusImgNode\" src=\"/images/icons/16/blank.png\" width=\"16\" height=\"16\" style=\"float:right;margin-right:8px\"/>\n                </td>\n                <td>\n                    <span id=\"statusMsgNode\"></span>\n                </td>\n            </tr>\n        </table>\n\n        <div>\n            <button id=\"logonButtonNode\" type=\"submit\"></button>\n        </div>\n\n    </div>\n</div>\n")});this.addChild(this.cpContent);this._frmLogon=new dijit.form.Form({onSubmit:dojo.hitch(this,this._onLogonSubmit)},"logonFormNode");this._txtUsername=new versa.widget.mobile.TextBox({name:"txtUsername",required:true,missingMessage:"Username is required",value:(this.user==null)?null:this.user.name,disabled:(this.user!=null),style:"width:160px"},"userNameNode");this._txtPassword=new versa.widget.mobile.TextBox({name:"txtPassword",required:false,type:"password",style:"width:160px"},"passwordNode");this._btnSubmit=new dojox.mobile.Button({iconClass:"buttonIcon bfreeIconLock",label:"Log in",type:"submit"},"logonButtonNode");this._txtUsername.focus();},startup:function(){this.inherited("startup",arguments);}});o.STS_CODES={"ERR":0,"OK":1};o.ERR_MESSAGE="Error: <b>{message}</b>";o.OK_MESSAGE="Success: <b>Logged in as user '{name}'.</b>";return o;});