//>>built
require(["dojo/_base/declare","dijit/_WidgetBase","dojox/mobile/Heading","dojox/mobile/ScrollableView","dojox/mobile/EdgeToEdgeDataList","dojox/mobile/ToolBarButton","versa/api/Folders","versa/api/Documents","versa/api/Zones","dojo/data/ItemFileWriteStore"],function(_1){_1("versa.widget.folder.mobile.FolderView",[dijit._WidgetBase,dojox.mobile.ScrollableView],{folder:null,library:null,folders:null,references:null,folderStore:null,refStore:null,etedlMain:null,header:null,footer:null,constructor:function(_2){},postCreate:function(){this.inherited("postCreate",arguments);this.folders=this.library.getFolders();this.references=this.library.getReferences();this.folderStore=this.folders.store;this.refStore=this.references.store;this.folderStore.clearCache();var _3=this.folderStore.fetch({query:{parent_id:this.folder.id}}).results;var _4=this.refStore.fetch({query:{type:1,query:this.folder.id,view:this.folder.view_definition_id}}).results;_3.sort(versa.api.Folder.sort);var _5=[];dojo.forEach(_3,function(_6){if(!(_6.isSearch()||_6.isTrash()||_6.isShareRoot())){_5.push({label:_6.name,item:_6,parent:this.folder,onCommand:this.onCommand,icon:"../../images/icons/32/folder.png",clickable:true,onClick:function(){this.select(true);setTimeout("var caller=dijit.byId('"+this.id+"');"+"caller.onCommand(versa.widget.zone.mobile.Show.COMMANDS.SHOW_FOLDER, {parent: caller.parent, folder:caller.item});",3);}});}},this);dojo.forEach(_4,function(_7){_5.push({label:_7.name,item:_7,from:this,onCommand:this.onCommand,icon:versa.api.Document.getIconUrl(_7.binary_content_type,32),clickable:true,onClick:function(){this.select(true);setTimeout("var caller=dijit.byId('"+this.id+"');"+"caller.onCommand(versa.widget.zone.mobile.Show.COMMANDS.SHOW_DOCUMENT_PROPERTIES, {from: caller.from, reference:caller.item});",3);}});},this);var _8={items:_5};var _9=new dojo.data.ItemFileWriteStore({data:_8});this.header=new versa.widget.mobile.Heading({label:this.folder.name,from:this,moveTo:this.back,onCommand:this.onCommand});this.footer=new versa.widget.mobile.Footing({showRoot:!this.folder.isRoot(),onCommand:this.onCommand,from:this});this.etedlMain=new dojox.mobile.EdgeToEdgeDataList({store:_9,iconBase:"../../images/mimetypes/48/default.png"});this.addChild(this.header);this.addChild(this.footer);this.addChild(this.etedlMain);},onBeforeTransitionIn:function(){this.findAppBars();this.resize();},onBeforeTransitionOut:function(){this.findAppBars();this.resize();},startup:function(){this.inherited("startup",arguments);this.etedlMain.startup();}});});