/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["versa.widget.zone.metrics.UserQuota"]){dojo._hasResource["versa.widget.zone.metrics.UserQuota"]=true;dojo.provide("versa.widget.zone.metrics.UserQuota");dojo.require("bfree.widget.Label");dojo.require("bfree.widget.PropertyTable");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("dijit.layout.BorderContainer");dojo.require("dijit.layout.ContentPane");dojo.require("dojox.charting.Chart");dojo.require("dojox.charting.axis2d.Default");dojo.require("dojox.charting.plot2d.Pie");dojo.require("dojox.charting.action2d.MoveSlice");dojo.require("dojox.charting.action2d.Tooltip");dojo.require("versa.widget.zone.metrics.themes.VersaGaugeOK");dojo.require("versa.widget.zone.metrics.themes.VersaGaugeWarning");dojo.require("versa.widget.zone.metrics.themes.VersaGaugeDanger");dojo.declare("versa.widget.zone.metrics.UserQuota",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("versa/widget/zone/metrics","template/UserQuota.html","<div style=\"height:120px;width:100%;\">\n\n<div    dojoType=\"dijit.layout.BorderContainer\"\n        design=\"headline\"\n        gutters=\"false\"\n        style=\"padding:8px 8px 4px 8px;height:100%;width:100%;\">\n\n    <div    dojoType=\"dijit.layout.ContentPane\"\n                splitter=\"false\"\n                region=\"center\"\n                splitter=\"true\"\n                style=\"overflow:hidden;padding:8px;position:relative\"\n                class=\"highlightPane\">\n\n        <div class=\"dijitBoldLabel dijitLargeLabel dijitDarkLabel\" style=\"\">User Quota</div>\n        <div dojoAttachPoint=\"tableNode\"></div>\n\n        <div dojoAttachPoint=\"chartNode\" style=\"height:96px;width:96px;position:absolute;left:144px;top:4px\"></div>\n        <div dojoAttachPoint=\"legendNode\"></div>\n    </div>\n\n</div>\n\n</div>\n"),widgetsInTemplate:true,_lblUserCount:null,_lblUserQuota:null,_wdgChart:null,_wdgLegend:null,userCount:0,userQuota:3,zone:null,constructor:function(_1){},destroy:function(){this.inherited("destroy",arguments);},postCreate:function(){this.inherited("postCreate",arguments);this._tblProperties=new bfree.widget.PropertyTable({customClass:"versa",showLabels:true,cols:1,labelWidth:64,style:"position:relative;left:32px;"},this.tableNode);this._lblUserCount=new bfree.widget.Label({label:"User Count",value:this.userCount});this._tblProperties.addChild(this._lblUserCount);this._lblUserQuota=new bfree.widget.Label({label:"User Quota",value:this.userQuota});this._tblProperties.addChild(this._lblUserQuota);var _2=(this.userCount>=this.userQuota)?0:this.userQuota-this.userCount;var _3=[];var _4=dojo.replace("{0} out of {1} user slots taken",[this.userCount,this.userQuota]);var _5=dojo.replace("{0} out of {1} user slots remaining",[_2,this.userQuota]);_3.push({y:this.userCount,text:_4,legend:"Users"});_3.push({y:_2,text:_5,legend:"Quota"});this._wdgChart=new dojox.charting.Chart(this.chartNode);this._wdgChart.addPlot("default",{type:"Pie",radius:36,startAngle:180,ticks:true,labelStyle:"default",labels:false,labelOffset:-16});this._wdgChart.addSeries("Series1",_3);var _6=this.userCount/this.userQuota;if(_6>0.85){this._wdgChart.setTheme(dojox.charting.themes.VersaGaugeDanger);}else{if((_6<=0.85)&&(_6>0.66)){this._wdgChart.setTheme(dojox.charting.themes.VersaGaugeWarning);}else{this._wdgChart.setTheme(dojox.charting.themes.VersaGaugeOK);}}new dojox.charting.action2d.Tooltip(this._wdgChart,"default");new dojox.charting.action2d.MoveSlice(this._wdgChart,"default",{series:"Series1",scale:1.25,shift:0});this._wdgChart.render();},startup:function(){this.inherited("startup",arguments);}});}