/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.widget.propdef.Widget"]){dojo._hasResource["bfree.widget.propdef.Widget"]=true;dojo.provide("bfree.widget.propdef.Widget");dojo.require("bfree.api.Application");dojo.require("bfree.api.ItemFileWriteStore");dojo.require("bfree.widget.ValidationTextBox");dojo.require("bfree.widget.BooleanSelect");dojo.require("bfree.widget.DateTextBox");dojo.require("bfree.widget.NumberSpinner");dojo.require("dijit.form.CheckBox");dojo.require("dijit.form.SimpleTextarea");dojo.declare("bfree.widget.propdef.Widget",null,{});bfree.widget.propdef.Widget.generateWdgName=function(_1){return dojo.replace("wdg_{0}",[_1]);};bfree.widget.propdef.Widget.resolveWdgName=function(_2){return _2.replace("wdg_","");};bfree.widget.propdef.Widget.formats={"SHORT":0,"LONG":1};bfree.widget.propdef.Widget.getWidget=function(_3,_4,_5,_6,_7,_8){var _9=null;if(_3.isString()||((_3.isText())&&(_6==bfree.widget.propdef.Widget.formats.SHORT))){_9=new bfree.widget.ValidationTextBox({id:_4,intermediateChanges:true,label:_5,scrollOnFocus:false,selectOnClick:true,style:"width:100%",value:_7,maxLength:_8});}else{if(_3.isDateTime()){_9=new bfree.widget.DateTextBox({id:_4,label:_5,scrollOnFocus:false,selectOnClick:true,style:"width:100%",value:_7});}else{if(_3.isText()){_9=new dijit.form.SimpleTextarea({id:_4,intermediateChanges:true,label:_5,"class":"bfree",scrollOnFocus:false,selectOnClick:true,style:"resize:none;width:100%",value:_7,maxLength:_8});}else{if((_3.isBoolean())&&((!_6)||(_6==bfree.widget.propdef.Widget.formats.SHORT))){_9=new dijit.form.CheckBox({id:_4,label:_5,scrollOnFocus:false,checked:_7});}else{if((_3.isBoolean())&&(_6==bfree.widget.propdef.Widget.formats.LONG)){_9=new bfree.widget.BooleanSelect({id:_4,label:_5,scrollOnFocus:false,style:"width:100%",value:_7});}else{if(_3.isInteger()){_9=new bfree.widget.NumberSpinner({id:_4,label:_5,smallDelta:1,largeDelta:10,constraints:{fractional:false,min:-2147483648,max:2147483647},scrollOnFocus:false,selectOnClick:true,style:"width:100%",value:_7?_7:0});}else{if(_3.isFloat()){_9=new bfree.widget.NumberSpinner({id:_4,label:_5,smallDelta:1,largeDelta:10,constraints:{places:"0,4"},scrollOnFocus:false,selectOnClick:true,style:"width:100%",value:_7?_7:0});}}}}}}}return _9;};bfree.widget.propdef.Widget.getChoiceListWidget=function(_a,_b,_c,_d){var _e=null;var _f=bfree.widget.propdef.Widget.generateStore(_c,_d);_e=new bfree.widget.FilteringSelect({id:_a,label:_b,query:{},store:_f,scrollOnFocus:false,searchAttr:"display"});return _e;};bfree.widget.propdef.Widget.generate=function(_10,_11,_12){var wdg=null;var _13=bfree.api.Application.getDataTypes();var _14=_13.fetchById({id:_11.data_type_id});var id=bfree.widget.propdef.Widget.generateWdgName(_11.getDbName());if(_12){wdg=bfree.widget.propdef.Widget.getChoiceListWidget(id,_11.name,_12);}else{wdg=bfree.widget.propdef.Widget.getWidget(_14,id,_11.name,bfree.widget.propdef.Widget.formats.LONG,_10.default_value,_11.max_length);}wdg.set("required",_10.is_required);return wdg;};bfree.widget.propdef.Widget.generateStore=function(_15,_16){var _17=[];if(_16){_17.push({id:null,display:"None"});}dojo.forEach(_15.choice_values,function(_18,idx){_17.push({id:_18.value,display:_18.name});},this);return new bfree.api.ItemFileWriteStore({data:{identifier:"id",label:"display",items:_17}});};}