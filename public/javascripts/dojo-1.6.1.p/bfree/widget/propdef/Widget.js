/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.widget.propdef.Widget"]){dojo._hasResource["bfree.widget.propdef.Widget"]=true;dojo.provide("bfree.widget.propdef.Widget");dojo.require("bfree.api.Application");dojo.require("bfree.api.ItemFileWriteStore");dojo.require("bfree.widget.ValidationTextBox");dojo.require("bfree.widget.BooleanSelect");dojo.require("bfree.widget.DateTextBox");dojo.require("bfree.widget.NumberSpinner");dojo.require("dijit.form.CheckBox");dojo.require("dijit.form.SimpleTextarea");dojo.declare("bfree.widget.propdef.Widget",null,{});bfree.widget.propdef.Widget.generateWdgName=function(_1){return dojo.replace("wdg_{0}",[_1]);};bfree.widget.propdef.Widget.resolveWdgName=function(_2){return _2.replace("wdg_","");};bfree.widget.propdef.Widget.formats={"SHORT":0,"LONG":1};bfree.widget.propdef.Widget.getWidget=function(_3,_4,_5,_6,_7,_8){var _9=null;if(_3.isString()||((_3.isText())&&(_6==bfree.widget.propdef.Widget.formats.SHORT))){_9=new bfree.widget.ValidationTextBox({id:_4,trim:true,intermediateChanges:true,label:_5,scrollOnFocus:false,selectOnClick:true,style:"width:100%",value:_7,maxLength:_8});}else{if(_3.isDateTime()){_9=new bfree.widget.DateTextBox({id:_4,label:_5,scrollOnFocus:false,selectOnClick:true,style:"width:100%",value:_7});}else{if(_3.isText()){_9=new dijit.form.SimpleTextarea({id:_4,trim:true,intermediateChanges:true,label:_5,"class":"bfree",scrollOnFocus:false,selectOnClick:true,style:"resize:none;width:100%",value:_7,maxLength:_8});}else{if((_3.isBoolean())){if(_7==="0"||_7==="1"){_7=parseInt(_7);}_9=new dijit.form.CheckBox({id:_4,label:_5,scrollOnFocus:false,checked:_7});}else{if(_3.isInteger()){_9=new bfree.widget.NumberSpinner({id:_4,label:_5,smallDelta:1,largeDelta:10,intermediateChanges:true,constraints:{fractional:false,min:-2147483648,max:2147483647},scrollOnFocus:false,selectOnClick:true,style:"width:100%",value:_7?_7:0});}else{if(_3.isFloat()){_9=new bfree.widget.NumberSpinner({id:_4,label:_5,smallDelta:1,largeDelta:10,intermediateChanges:true,constraints:{places:"0,4"},scrollOnFocus:false,selectOnClick:true,style:"width:100%",value:_7?_7:0});}}}}}}return _9;};bfree.widget.propdef.Widget.getChoiceListWidget=function(_a,_b,_c,_d,_e){var _f=null;var _10=bfree.widget.propdef.Widget.generateStore(_c,_d);_f=new bfree.widget.FilteringSelect({id:_a,label:_b,query:{},store:_10,value:_e,scrollOnFocus:false,searchAttr:"display"});return _f;};bfree.widget.propdef.Widget.generate=function(_11,_12,_13){var wdg=null;var _14=bfree.api.Application.getDataTypes();var _15=_14.fetchById({id:_12.data_type_id});var id=bfree.widget.propdef.Widget.generateWdgName(_12.getDbName());if(_13){wdg=bfree.widget.propdef.Widget.getChoiceListWidget(id,_12.name,_13,false,_11.default_value);}else{wdg=bfree.widget.propdef.Widget.getWidget(_15,id,_12.name,bfree.widget.propdef.Widget.formats.LONG,_11.default_value,_12.max_length);}wdg.set("required",_11.is_required);return wdg;};bfree.widget.propdef.Widget.generateStore=function(_16,_17){var _18=[];if(_17){_18.push({id:null,display:"None"});}dojo.forEach(_16.choice_values,function(_19,idx){_18.push({id:_19.value,display:_19.name});},this);return new bfree.api.ItemFileWriteStore({data:{identifier:"id",label:"display",items:_18}});};}