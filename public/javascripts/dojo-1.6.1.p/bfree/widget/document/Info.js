/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.widget.document.Info"]){dojo._hasResource["bfree.widget.document.Info"]=true;dojo.provide("bfree.widget.document.Info");dojo.require("bfree.IconManager");dojo.require("bfree.widget.PropertyTable");dojo.require("bfree.api.Preferences");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("bfree.widget.document.Info",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("bfree/widget/document","template/Info.html","<div style=\"padding:4px 0 0 72px;position:relative;height:100%;width:100%\">\n\n    <div style=\"position:absolute;top:8px;left:8px\">\n        <img dojoAttachPoint=\"typeIconNode\" src=\"/images/mimetypes/48/default.png\" height=\"48\" width=\"48\"/>\n    </div>\n\n    <div class=\"dijitBoldLabel dijitLargeLabel dijitDarkLabel\" dojoAttachPoint=\"nameNode\" style=\"margin-right:80px\"></div>\n    <div dojoAttachPoint=\"tableNode\"></div>\n\n</div>\n"),widgetsInTemplate:false,_lblType:null,_lblUpdatedAt:null,_lblUpdatedBy:null,_lblVersion:null,_tblProperties:null,documentType:null,documentTypes:null,activeItem:null,propertyDefinitions:null,propertyMappings:null,preferences:null,destroy:function(){this.destroyDescendants();if(this._tblProperties){this._tblProperties.destroyRecursive();this._tblProperties=null;}if(this._form){this._form.destroy();this._form=null;}this.inherited("destroy",arguments);},postCreate:function(){this.inherited("postCreate",arguments);var _1=8;var _2=[];for(var i=0;i<_1;i++){_2.push(["",""]);}this.documentType=this.documentTypes.fetchById({id:this.activeItem.document_type_id});var _3=this.documentType.property_mappings;var _4=0;dojo.forEach(_3,function(_5){if(_4>=_1){return;}var _6=this.propertyDefinitions.fetchById({id:_5.property_definition_id});if(_6.is_system){return;}if(_6.data_type_id!=bfree.api.DataTypes.types.TEXT){var _7=this.activeItem[_6.column_name];if(_7){if(_6.data_type_id==bfree.api.DataTypes.types.DATETIME){_7=dojo.date.stamp.fromISOString(_7);_7=dojo.date.locale.format(_7,{selector:"date",formatLength:"medium"});}}_2[_4]=[_6.name,_7==null?"":_7];_4++;}},this);var _8=bfree.api.Document.getIconUrl(this.activeItem.current_version.binary_content_type,48);dojo.attr(this.typeIconNode,"src",_8);dojo.attr(this.typeIconNode,"alt",this.activeItem.current_version.binary_content_type);this.nameNode.innerHTML=this.activeItem.name;this._tblProperties=new bfree.widget.PropertyTable({customClass:"versafoot",showLabels:true,cols:3,labelWidth:112,style:""},this.tableNode);this._lblDocType=new bfree.widget.Label({label:"Type",value:this.documentType.name});this._tblProperties.addChild(this._lblDocType);this._lbl001=new bfree.widget.Label({label:_2[0][0],value:_2[0][1]});this._tblProperties.addChild(this._lbl001);this._lbl005=new bfree.widget.Label({label:_2[4][0],value:_2[4][1]});this._tblProperties.addChild(this._lbl005);this._lblVersion=new bfree.widget.Label({label:"Version",value:this.activeItem.getFullVersion()});this._tblProperties.addChild(this._lblVersion);this._lbl002=new bfree.widget.Label({label:_2[1][0],value:_2[1][1]});this._tblProperties.addChild(this._lbl002);this._lbl006=new bfree.widget.Label({label:_2[5][0],value:_2[5][1]});this._tblProperties.addChild(this._lbl006);this._lblCKO=new bfree.widget.Label({label:"Checked Out By",value:(this.activeItem.getState(bfree.api.Document.states.CHECKED_OUT)?this.activeItem.checked_out_by:"")});this._tblProperties.addChild(this._lblCKO);this._lbl003=new bfree.widget.Label({label:_2[2][0],value:_2[2][1]});this._tblProperties.addChild(this._lbl003);this._lbl007=new bfree.widget.Label({label:_2[6][0],value:_2[6][1]});this._tblProperties.addChild(this._lbl007);this._lblUpdatedAt=new bfree.widget.Label({label:"Last Modified Date",value:dojo.date.locale.format(this.activeItem.updated_at,{formatLength:"medium"})});this._tblProperties.addChild(this._lblUpdatedAt);this._lbl004=new bfree.widget.Label({label:_2[3][0],value:_2[3][1]});this._tblProperties.addChild(this._lbl004);this._lbl008=new bfree.widget.Label({label:_2[7][0],value:_2[7][1]});this._tblProperties.addChild(this._lbl008);},startup:function(){this.inherited("startup",arguments);this._tblProperties.startup();}});}