/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.widget.document.version.Grid"]){dojo._hasResource["bfree.widget.document.version.Grid"]=true;dojo.provide("bfree.widget.document.version.Grid");dojo.require("bfree.widget._Grid");dojo.require("bfree.widget.document.version.ContextMenu");dojo.declare("bfree.widget.document.version.Grid",[bfree.widget._Grid],{_mnuVersion:null,activeDocument:null,library:null,zone:null,_canEdit:function(_1,_2){return false;},_canSort:function(_3){return false;},_onCommand:function(_4,_5,_6){this.onCommand(_4,_5,_6);},_onRowContextMenu:function(_7){if((this._mnuVersion==null)||(_7.rowIndex<0)){this.rowHit=false;_7.cancelBubble=true;}else{var _8=this.selection.selected[_7.rowIndex];var _9;if(_8){_9=this.getItem(_7.rowIndex);}else{this.selection.clear();_9=this.getItem(_7.rowIndex);this.selection.select(_7.rowIndex);this._mnuVersion.rowHit=true;this._mnuVersion.activeItem=_9;}this._mnuVersion.rowHit=true;this._mnuVersion.activeItem=_9;}},_setActiveDocumentAttr:function(_a){this.activeDocument=_a;this.setStore(this.activeDocument.getVersions({zone:this.zone,library:this.library}).store,{},{cache:true});},constructor:function(_b){this.updateDelay=0;this.rowsPerPage=25;this.formatterScope=this;this.query={};this.queryOptions={cache:true};this.selectionMode="single";this.clientSort=false;this.canEdit=this._canEdit;this.canSort=this._canSort;this.noDataMessage="No Versions found";this.sortInfo=4;},postCreate:function(){this.inherited("postCreate",arguments);this._mnuVersion=new bfree.widget.document.version.ContextMenu({onCommand:dojo.hitch(this,this._onCommand),versions:this.versions,document:this.document,targetNodeIds:[this.id]});this.onRowContextMenu=dojo.hitch(this,this._onRowContextMenu);this.set("structure",bfree.widget.document.version.Grid.view);},onRowDblClick:function(_c){if(_c.rowIndex<0){_c.cancelBubble=true;return;}var _d=this.getItem(_c.rowIndex);this._onCommand(bfree.widget.Bfree.Commands.VIEW,bfree.widget.Bfree.ObjectTypes.VERSION,{document:this.document,version:_d});},onCommand:function(_e,_f,_10){},startup:function(){this.inherited("startup",arguments);}});bfree.widget.document.version.Grid.formatState=function(_11,_12){var _13="";if(_11){_13="statusIcon bfreeIconNew";}return dojo.replace("<img src=\"/images/icons/16/blank.png\" width=\"16\" height=\"16\" class=\"{0}\"/>",[_13]);};bfree.widget.document.version.Grid.getVersion=function(idx,_14){if(!_14){return "";}return _14.major_version_number;};bfree.widget.document.version.Grid.formatVersion=function(_15,_16){return _15;};bfree.widget.document.version.Grid.view=[{cells:[{field:"is_current_version",name:"&nbsp;",width:"16px",formatter:bfree.widget.document.version.Grid.formatState},{field:"major_version_number",name:"Version",get:bfree.widget.document.version.Grid.getVersion,formatter:bfree.widget.document.version.Grid.formatVersion},{field:"binary_file_name",name:"Filename",width:"auto"},{field:"sort_id",name:"Sort",hidden:true}],width:"auto"}];}