/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.widget.document.version.Grid"]){dojo._hasResource["bfree.widget.document.version.Grid"]=true;dojo.provide("bfree.widget.document.version.Grid");dojo.require("bfree.widget._Grid");dojo.require("bfree.widget.document.version.ContextMenu");dojo.declare("bfree.widget.document.version.Grid",[bfree.widget._Grid],{versions:null,document:null,_mnuVersion:null,_canEdit:function(_1,_2){return false;},_canSort:function(_3){return false;},_onCommand:function(_4,_5,_6){this.onCommand(_4,_5,_6);},constructor:function(_7){this.updateDelay=0;this.rowsPerPage=25;this.formatterScope=this;this.query={};this.queryOptions={cache:true};this.selectionMode="single";this.clientSort=false;this.canEdit=this._canEdit;this.canSort=this._canSort;this.noDataMessage="No Versions found";this.sortInfo=4;},postCreate:function(){this.inherited("postCreate",arguments);this._mnuVersion=new bfree.widget.document.version.ContextMenu({onCommand:dojo.hitch(this,this._onCommand),versions:this.versions,document:this.document,targetNodeIds:[this.id]});this.onRowContextMenu=dojo.hitch(this,this._onRowContextMenu);this.set("structure",bfree.widget.document.version.Grid.view);},onRowDblClick:function(_8){if(_8.rowIndex<0){_8.cancelBubble=true;return;}var _9=this.getItem(_8.rowIndex);this._onCommand(bfree.widget.Bfree.Commands.VIEW,bfree.widget.Bfree.ObjectTypes.VERSION,{document:this.document,version:_9});},onCommand:function(_a,_b,_c){},_onRowContextMenu:function(_d){if((this._mnuVersion==null)||(_d.rowIndex<0)){this.rowHit=false;_d.cancelBubble=true;}else{var _e=this.selection.selected[_d.rowIndex];var _f;if(_e){_f=this.getItem(_d.rowIndex);}else{this.selection.clear();_f=this.getItem(_d.rowIndex);this.selection.select(_d.rowIndex);this._mnuVersion.rowHit=true;this._mnuVersion.activeItem=_f;}this._mnuVersion.rowHit=true;this._mnuVersion.activeItem=_f;}},startup:function(){this.inherited("startup",arguments);this.setStore(this.versions.store,{},{cache:true});}});bfree.widget.document.version.Grid.formatState=function(_10,_11){var _12="";if(_10){_12="statusIcon bfreeIconNew";}return dojo.replace("<img src=\"/images/icons/16/blank.png\" width=\"16\" height=\"16\" class=\"{0}\"/>",[_12]);};bfree.widget.document.version.Grid.getVersion=function(idx,_13){if(!_13){return "";}return _13.major_version_number+"."+_13.minor_version_number;};bfree.widget.document.version.Grid.formatVersion=function(_14,_15){return _14;};bfree.widget.document.version.Grid.view=[{cells:[{field:"is_current_version",name:"&nbsp;",width:"16px",formatter:bfree.widget.document.version.Grid.formatState},{field:"major_version_number",name:"Version",get:bfree.widget.document.version.Grid.getVersion,formatter:bfree.widget.document.version.Grid.formatVersion},{field:"binary_file_name",name:"Filename",width:"auto"},{field:"sort_id",name:"Sort",hidden:true}],width:"auto"}];}