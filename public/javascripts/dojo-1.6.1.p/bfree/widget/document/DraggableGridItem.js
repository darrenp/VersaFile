/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.widget.document.DraggableGridItem"]){dojo._hasResource["bfree.widget.document.DraggableGridItem"]=true;dojo.provide("bfree.widget.document.DraggableGridItem");dojo.require("dojo.dnd.Source");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("bfree.widget.document.DraggableGridItem",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("bfree/widget/document","template/DraggableGridItem.html","<div>\n    <div dojoAttachPoint=\"source\">\n\n    </div>\n</div>\n"),widgetsInTemplate:true,dnd:null,document:null,data:null,grid:null,constructor:function(_1){this.data=_1.data;this.document=_1.document;this.grid=_1.grid;},postCreate:function(){this.inherited("postCreate",arguments);this.dnd=new dojo.dnd.Source(this.source,{accept:[],creator:dojo.hitch(this,this.creator)});this.dnd.insertNodes(true,[this.document]);},creator:function(_2,_3){var _4;var _5;if(_3=="avatar"){var _6=this.grid.getItemIndex(_2);if(!this.grid.selection.isSelected(_6)){this.grid.selection.clear();this.grid.selection.select(_2);}_5=this.grid.selection.getSelected();_4=document.createElement("tr");var _7=document.createElement("table");_7.style.borderCollapse="collapse";_4.appendChild(_7);dojo.forEach(_5,function(_8,_9){var _a=dojo.replace("/icons/{0}?size=16",[encodeURIComponent(_8.binary_content_type)]);var _b=document.createElement("img");_b.src=_a;_b.width=16;_b.height=16;var tr=document.createElement("tr");var _c=document.createElement("td");_c.appendChild(_b);var _d=document.createElement("td");_d.innerHTML=_8.name;tr.appendChild(_c);tr.appendChild(_d);_7.appendChild(tr);});}else{_4=document.createElement("div");_4.innerHTML=this.data;_5=_2;}_4.type="Document";this.payload=_5;return {node:_4,data:_5};}});}