/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.widget.document.FileGrid"]){dojo._hasResource["bfree.widget.document.FileGrid"]=true;dojo.provide("bfree.widget.document.FileGrid");dojo.require("bfree.api.ItemFileWriteStore");dojo.require("bfree.widget._Grid");dojo.declare("bfree.widget.document.FileGrid",[bfree.widget._Grid],{selectionMode:"single",_canEdit:function(_1,_2){return false;},_canSort:function(_3){return true;},addFileItem:function(_4){var _5=this._store.newItem(_4);if(this.selection.getSelectedCount()<1){this.selectItem(_5);}},reset:function(){this._store.revert();this.selection.clear();this._store=new bfree.api.ItemFileWriteStore({data:{identifier:"id",label:"name",items:[]}});this.setStore(this._store,{},{cache:true});},constructor:function(_6){this.updateDelay=0;this.rowsPerPage=25;this.formatterScope=this;this.query={};this.queryOptions={cache:true};this.selectionMode="single";this.clientSort=false;this.canEdit=this._canEdit;this.canSort=this._canSort;this.noDataMessage="Select one or more files";this._store=new bfree.api.ItemFileWriteStore({data:{identifier:"id",label:"name",items:[]}});},destroy:function(){this.inherited("destroy",arguments);},focus:function(){this._;},postCreate:function(){this.inherited("postCreate",arguments);this.set("structure",bfree.widget.document.FileGrid.view1);},startup:function(){this.inherited("startup",arguments);this.setStore(this._store,{},{cache:true});},updateFileItem:function(id,_7){this._store.fetchItemByIdentity({identity:id,onItem:function(_8){this._store.setValue(_8,"state",_7);},scope:this});}});bfree.widget.document.FileGrid.formatContentType=function(_9,_a){if(String.isEmpty(_9)){return "";}var _b=bfree.api.Document.getIconUrl(_9,16);var _c=dojo.replace("<img src=\"{0}\" width=\"16\" height=\"16\"/>",[_b]);return _c;};bfree.widget.document.FileGrid.formatState=function(_d,_e){var _f=bfree.api.Document.getStateIcon(_d);return dojo.replace("<div style=\"padding-top:2px\"><img src=\"/images/icons/states/{0}\" width=\"16\" height=\"16\"/></div>",[_f]);};bfree.widget.document.FileGrid.getContentType=function(idx,_10){var _11="";if(!_10){return _11;}var _12=this.grid.store.getValue(_10,"document");if(_12){_11=_12.binary_content_type;}return _11;};bfree.widget.document.FileGrid.getSize=function(idx,_13){var _14=0;if(_13){var _15=this.grid.store.getValue(_13,"document");if(_15){_14=_15.binary_file_size;}}return bfree.api.Utilities.readablizeBytes({bytes:_14});};bfree.widget.document.FileGrid.getState=function(idx,_16){var _17=0;if(!_16){return _17;}var _18=this.grid.store.getValue(_16,"document");if(_18){if(_18.getState(bfree.api.Document.states.INVALID)){_17=bfree.api.Document.states.INVALID;}else{if(_18.getState(bfree.api.Document.states.PENDING)){_17=bfree.api.Document.states.PENDING;}else{if(_18.getState(bfree.api.Document.states.UPLOADED)){_17=bfree.api.Document.states.UPLOADED;}else{if(_18.getState(bfree.api.Document.states.CHECKED_IN)){_17=bfree.api.Document.states.CHECKED_IN;}else{if(_18.getState(bfree.api.Document.states.ERROR)){_17=bfree.api.Document.states.ERROR;}}}}}}return _17;};bfree.widget.document.FileGrid.view1=[{cells:[{field:"state",name:"&nbsp;",width:"18px",get:bfree.widget.document.FileGrid.getState,formatter:bfree.widget.document.FileGrid.formatState},{field:"content_type",name:"&nbsp;",width:"18px",get:bfree.widget.document.FileGrid.getContentType,formatter:bfree.widget.document.FileGrid.formatContentType},{field:"name",name:"&nbsp;",width:"auto"},{field:"size",name:"&nbsp;",width:"56px",get:bfree.widget.document.FileGrid.getSize,cellStyles:"text-align:right;white-space:nowrap"}],width:"auto"}];}