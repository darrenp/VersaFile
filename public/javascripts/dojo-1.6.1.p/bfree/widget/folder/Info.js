/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.widget.folder.Info"]){dojo._hasResource["bfree.widget.folder.Info"]=true;dojo.provide("bfree.widget.folder.Info");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("versa.api.Formatter");dojo.declare("bfree.widget.folder.Info",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("bfree/widget/folder","template/Info.html","<div style=\"padding:4px 0 0 72px;position:relative;height:100%;width:100%\">\n\n    <div style=\"position:absolute;top:8px;left:8px;height:48px;width:48px;\">\n        <img dojoAttachPoint=\"typeIconNode\" src=\"\" height=\"48\" width=\"48\"/>\n        <img dojoAttachPoint=\"stateIconNode\" src=\"/images/loading/loading24.gif\" height=\"24\"width=\"24\" style=\"position:absolute;bottom:0;right:0\">\n    </div>\n\n    <div class=\"dijitBoldLabel dijitLargeLabel dijitDarkLabel\" dojoAttachPoint=\"nameNode\" style=\"margin-right:80px\"></div>\n    <div dojoAttachPoint=\"tableNode\"></div>\n\n</div>\n"),widgetsInTemplate:false,_destroyed:false,_labels:null,_propertyCount:12,_tblProperties:null,items:null,library:null,_generateSingleItem:function(_1){var _2=this._initData();_2[0].label="Type";_2[0].value=bfree.api.Folder.getTypeLabel(_1);_2[1].label=this._getCountLabel(_1.folder_type);_2[1].value=(_1.folder_type==bfree.api.Folder.FolderTypes.SHARE_ROOT)?_1.children.length:_1.document_count;_2[2].label="Path";_2[2].value=_1.text_path;_2[3].label="Last Modified Date";_2[3].value=versa.api.Formatter.formatDateTime(_1.updated_at);return _2;},_getCountLabel:function(_3){var _4="Document Count";switch(_3){case bfree.api.Folder.FolderTypes.SHARE_ROOT:_4="Share Count";break;case bfree.api.Folder.FolderTypes.SHARE:_4="Shared Items";break;case bfree.api.Folder.FolderTypes.TRASH:_4="Deleted Items";break;}return _4;},_initData:function(){var _5=new Array();for(var i=0;i<this._propertyCount;i++){_5.push({label:"",value:""});}return _5;},_loadData:function(_6){if(this._destroyed){return;}dojo.forEach(this._labels,function(_7,_8){_7.reset(_6[_8].label,_6[_8].value);},this);this._tblProperties.refresh();},_loadItems:function(_9){var _a="";var _b="";var _c="";var _9=this.items[0];_a=bfree.api.Folder.getIconUrl(_9,48);_b=_9.text_path;_c=_9.name;dojo.attr(this.typeIconNode,"src",_a);dojo.attr(this.typeIconNode,"alt",_b);this.nameNode.innerHTML=_c;this._labels[0].reset("Loading...","");this._tblProperties.refresh();dojo.forEach(this.items,function(_d){if(this.library.getFolders().isItemLoaded(_d)){this.library.getFolders().refreshAsync({scope:this,invalidate:true,identity:_d.getId(),onItem:dojo.hitch(this,this.__onFolderLoad),onError:this.__onFolderLoadError},this);}else{this.library.getFolders().loadItem({item:_d,scope:this,onItem:dojo.hitch(this,this.__onFolderLoad),onError:this.__onFolderLoadError});}},this);},_preload:function(){var _e="";var _f="";var _10="";var _11=this.items[0];_e=bfree.api.Folder.getIconUrl(_11,48);_f=_11.text_path;_10=_11.name;dojo.attr(this.typeIconNode,"src",_e);dojo.attr(this.typeIconNode,"alt",_f);this.nameNode.innerHTML=_10;this._labels[0].reset("Loading...","");this._tblProperties.refresh();},constructor:function(_12){this._itemMap=new Object();this._labels=new Array();},destroy:function(){this._destroyed=true;this.destroyDescendants();if(this._tblProperties){this._tblProperties.destroyRecursive();this._tblProperties=null;}this.inherited("destroy",arguments);},load:function(_13){this.items=_13;dojo.forEach(this.items,function(_14){var _15=this._generateSingleItem(_14);this._loadData(_15);},this);this.setBusy(false);},postCreate:function(){this.inherited("postCreate",arguments);this._tblProperties=new bfree.widget.PropertyTable({customClass:"versafootfull",showLabels:true,cols:1,labelWidth:112,style:""},this.tableNode);for(var i=0;i<this._propertyCount;i++){this._labels.push(new bfree.widget.Label({label:"",value:""}));this._tblProperties.addChild(this._labels[i]);}},setBusy:function(_16){(_16)?dojo.style(this.stateIconNode,{display:"block"}):dojo.style(this.stateIconNode,{display:"none"});},startup:function(){this.inherited("startup",arguments);this._tblProperties.startup();this._preload();},update:function(_17){dojo.forEach(this.items,function(_18){this.__onFolderLoad(_18);},this);}});}