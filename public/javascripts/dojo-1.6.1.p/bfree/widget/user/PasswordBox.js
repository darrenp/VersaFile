/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.widget.user.PasswordBox"]){dojo._hasResource["bfree.widget.user.PasswordBox"]=true;dojo.provide("bfree.widget.user.PasswordBox");dojo.require("bfree.widget.Button");dojo.require("bfree.widget.ValidationTextBox");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("bfree.widget.user.PasswordBox",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("bfree/widget/user","template/PasswordBox.html","<div style=\"height:100%;width:100%;\">\n\n    <table cellpadding=\"0\" cellspacing=\"0\" style=\"width:100%\">\n        <tr>\n            <td><div dojoAttachPoint=\"txtPasswordNode\"></div></td>\n            <td style=\"padding-left:4px;width:48px\"><div dojoAttachPoint=\"btnGenerateNode\"></div></td>\n        </tr>\n    </table>\n\n</div>\n"),widgetsInTemplate:true,_btnGenerate:null,_txtPassword:null,activeItem:null,disabled:false,_setActiveItemAttr:function(_1){this.activeItem=_1;if(this.activeItem){this._txtPassword.set("value",this.activeItem.password);}else{this._txtPassword.reset();}},_setDisabledAttr:function(_2){this.disabled=_2;if(this._btnGenerate){this._btnGenerate.set("disabled",this.disabled);}if(this._txtPassword){this._txtPassword.set("disabled",(this.disabled||!this.activeItem.hasOwnProperty("password")));if(this._txtPassword.disabled){this._txtPassword.reset();}}},_onChange:function(_3){this.onChange(_3);},_validator:function(_4){return this.validator(_4);},_onResetPassword:function(){var _5=dojo.replace("Are you sure you want to reset the password for user: {0}",[this.activeItem.getFullName()]);if(confirm(_5)){this.activeItem["password"]="";var _6=bfree.api.Users.generatePassword({length:8});this._txtPassword.set("value",_6);this.set("disabled",this.disabled);this._txtPassword.setFocus(true);}},constructor:function(_7){this.disabled=(_7.disabled)?_7.disabled:false;},destroy:function(){if(this._btnGenerate){this._btnGenerate.destroy();this._btnGenerate=null;}if(this._txtPassword){this._txtPassword.destroy();this._textPassowrd=null;}this.inherited("destroy",arguments);},focus:function(){},onChange:function(_8){},postCreate:function(){this.inherited("postCreate",arguments);this._txtPassword=new bfree.widget.ValidationTextBox({id:"txtPassword",intermediateChanges:true,disabled:this.disabled,selectOnClick:true,style:"width:100%",validator:dojo.hitch(this,this._validator),onChange:dojo.hitch(this,this._onChange)},this.txtPasswordNode);this._btnGenerate=new bfree.widget.Button({iconClass:"imageIcon bfreeIconLock",disabled:this.disabled,label:"Reset User Password",showLabel:false,disabled:true,onClick:dojo.hitch(this,this._onResetPassword)},this.btnGenerateNode);},startup:function(){this.inherited("startup",arguments);}});}