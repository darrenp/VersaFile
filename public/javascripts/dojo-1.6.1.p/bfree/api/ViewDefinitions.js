/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.api.ViewDefinitions"]){dojo._hasResource["bfree.api.ViewDefinitions"]=true;dojo.provide("bfree.api.ViewDefinitions");dojo.require("bfree.api.ViewDefinition");dojo.require("bfree.api._Collection");dojo.require("bfree.api.CellDefinitions");dojo.require("bfree.api.Error");dojo.require("bfree.IconManager");dojo.declare("bfree.api.ViewDefinitions",[bfree.api._Collection],{documentTypes:null,_formatDateTime:function(_1,_2){if(_1.date_format&&_1.date_format!=""){return dojo.date.locale.format(_2,{selector:"date",datePattern:_1.date_format});}else{return _2.toLocaleDateString();}},_matchesQuery:function(_3,_4){if(dojo.isArray(_3)||(_3.hasOwnProperty("column_order"))){return false;}var _5=_4.query;var _6=_4.queryOptions&&_4.queryOptions.ignoreCase;for(var i in _5){var _7=_5[i];var _8=this.getValue(_3,i);if((typeof _7=="string"&&(_7.match(/[\*\.]/)||_6))?!dojo.data.util.filter.patternToRegExp(_7,_6).test(_8):_8!=_7){return false;}}return true;},_getDocumentAttr:function(_9,_a){var _b="";var _c=this[0];var _d=this[1];if(!_a){return _b;}var _e=_d.column_name;switch(_e){case "created_at":case "updated_at":_b=_c._formatDateTime(_d,_a[_e]);break;default:if(/prp_dtt/.test(_e)&&_a[_e]){_b=dojo.date.stamp.fromISOString(_a[_e]);if(_b){_b=_c._formatDateTime(_d,_b);}}else{_b=_a[_e];}break;}return _b;},_getDocumentTypeAttr:function(_f,_10){var _11="";var _12=this[0];var _13=this[1];if(!_10){return _11;}if(!_10.document_type_id){return "";}var _14=_12.documentTypes.fetchById({id:_10.document_type_id});switch(_13.column_name){case "name":_11=_14.name;break;}return _11;},_getVersionAttr:function(_15,_16){var _17="";var _18=this[0];var _19=this[1];if(!_16){return _17;}switch(_19.column_name){case "content_type":_17=(_16.current_version)?_16.current_version.content_type:"";break;case "version_number":_17=(_16.current_version)?_16.current_version.version_number:0;break;case "size":_17=(_16.current_version)?_16.current_version.size:0;break;}return _17;},constructor:function(_1a){this.zone=_1a.zone;this.library=_1a.library;this.target=dojo.replace(bfree.api.ViewDefinitions.TRGT,[this.zone.subdomain,this.library.id]);this.schema=bfree.api.ViewDefinition.schema;this.cache=true;this.cellDefinitions=_1a.cellDefinitions;this._initialize();this.store.matchesQuery=dojo.hitch(this,this._matchesQuery);},isValidItem:function(_1b){var _1c=this.inherited(arguments);var _1d=_1b.item;if(!_1c){return;}if(_1d.name.length<1){throw new Error("View Definition 'Name' is empty or invalid");}if((!_1d.sort_by)||(_1d.sort_by.length<1)){throw new Error("View Definition must have a 'Sort By' value");}return true;}});bfree.api.ViewDefinitions.TRGT="/zones/{0}/libraries/{1}/view_definitions";}