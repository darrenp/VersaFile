/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.api.ViewDefinitions"]){dojo._hasResource["bfree.api.ViewDefinitions"]=true;dojo.provide("bfree.api.ViewDefinitions");dojo.require("bfree.api.ViewDefinition");dojo.require("bfree.api._Collection");dojo.require("bfree.api.CellDefinitions");dojo.require("bfree.api.Error");dojo.require("bfree.IconManager");dojo.declare("bfree.api.ViewDefinitions",[bfree.api._Collection],{documentTypes:null,_matchesQuery:function(_1,_2){if(dojo.isArray(_1)||(_1.hasOwnProperty("column_order"))){return false;}var _3=_2.query;var _4=_2.queryOptions&&_2.queryOptions.ignoreCase;for(var i in _3){var _5=_3[i];var _6=this.getValue(_1,i);if((typeof _5=="string"&&(_5.match(/[\*\.]/)||_4))?!dojo.data.util.filter.patternToRegExp(_5,_4).test(_6):_6!=_5){return false;}}return true;},_getDocumentAttr:function(_7,_8){var _9="";var _a=this[0];var _b=this[1];if(!_8){return _9;}var _c=_b.column_name;switch(_c){case "created_at":case "updated_at":_9=_a._formatDateTime(_b,_8[_c]);break;default:if(/prp_dtt/.test(_c)&&_8[_c]){_9=dojo.date.stamp.fromISOString(_8[_c]);if(_9){_9=_a._formatDateTime(_b,_9);}}else{_9=_8[_c];}break;}return _9;},_getDocumentTypeAttr:function(_d,_e){var _f="";var _10=this[0];var _11=this[1];if(!_e){return _f;}if(!_e.document_type_id){return "";}var _12=_10.documentTypes.fetchById({id:_e.document_type_id});switch(_11.column_name){case "name":_f=_12.name;break;}return _f;},_getVersionAttr:function(_13,_14){var _15="";var _16=this[0];var _17=this[1];if(!_14){return _15;}switch(_17.column_name){case "content_type":_15=(_14.current_version)?_14.current_version.content_type:"";break;case "version_number":_15=(_14.current_version)?_14.current_version.version_number:0;break;case "size":_15=(_14.current_version)?_14.current_version.size:0;break;}return _15;},constructor:function(_18){this.zone=_18.zone;this.library=_18.library;this.target=dojo.replace(bfree.api.ViewDefinitions.TRGT,[this.zone.subdomain,this.library.id]);this.schema=bfree.api.ViewDefinition.schema;this.cache=true;this.cellDefinitions=_18.cellDefinitions;this._initialize();this.store.matchesQuery=dojo.hitch(this,this._matchesQuery);},isValidItem:function(_19){var _1a=this.inherited(arguments);var _1b=_19.item;if(!_1a){return;}if(_1b.name.length<1){throw new Error("View Definition 'Name' is empty or invalid");}if((!_1b.sort_by)||(_1b.sort_by.length<1)){throw new Error("View Definition must have a 'Sort By' value");}return true;}});bfree.api.ViewDefinitions.TRGT="/zones/{0}/libraries/{1}/view_definitions";}