/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.api.Acl"]){dojo._hasResource["bfree.api.Acl"]=true;dojo.provide("bfree.api.Acl");dojo.declare("bfree.api.Acl",null,{id:null,inherited:false,acl_entries:[],constructor:function(_1){dojo.safeMixin(this,((!_1)?{}:_1));},getAdministrator:function(){for(var i=0;i<this.acl_entries.length;i++){var _2=this.acl_entries[i];if((_2.grantee_type.toLowerCase()=="group")&&(_2.grantee.name.toLowerCase()=="administrators")){return this.acl_entries[i];}}},getEveryone:function(_3){var _4=null;dojo.some(this.acl_entries,function(_5,_6){var _7=(_5.grantee_type.toLowerCase()=="group")?_3.getGroups().fetchById({id:_5.grantee_id}):_3.getUsers().fetchById({id:_5.grantee_id});if(_7.isInstanceOf(bfree.api.Group)&&_7.is_everyone){_4=_5;}return (_4!=null);},this);return _4;},hasAccess:function(_8,_9,_a){var _b=Number.NaN;var _c=Number.NaN;var _d=Number.NaN;dojo.forEach(this.acl_entries,function(_e,_f){var _10=_8.getRoles().fetchById({id:_e.role_id});var _11=(_e.grantee_type.toLowerCase()=="group")?_8.getGroups().fetchById({id:_e.grantee_id}):_8.getUsers().fetchById({id:_e.grantee_id});if((_11.isInstanceOf(bfree.api.User))&&(_e.grantee_id==_9.id)){_b=_10.permissions;}else{if((_11.isInstanceOf(bfree.api.Group))&&(_e.grantee_id==_a.id)){_c=_10.permissions;}else{if((_11.isInstanceOf(bfree.api.Group))&&(_11.is_everyone)){_d=_10.permissions;}}}},this);if(!isNaN(_b)){return (_b>0);}if(!isNaN(_c)){return (_c>0);}if(!isNaN(_d)){return (_d>0);}return false;}});bfree.api.Acl.schema={type:"object",properties:{"id":{type:"integer"},"inherit_state":{type:"integer"},"inherited":{type:"boolean","default":false}},prototype:new bfree.api.Acl()};}