/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["bfree.api.Folders"]){dojo._hasResource["bfree.api.Folders"]=true;dojo.provide("bfree.api.Folders");dojo.require("bfree.api._Collection");dojo.require("bfree.api.Folder");dojo.require("bfree.api.Utilities");dojo.declare("bfree.api.Folders",[bfree.api._Collection],{library:null,_searchFolder:null,_shareRootFolder:null,_trashFolder:null,_getExistingNames:function(_1){var _2=[];if((_1)&&(_1.children)){dojo.forEach(_1.children,function(_3){_2.push(_3.name);});}return _2;},_isUpdateable:function(_4){if(_4.query.hasOwnProperty("parent_id")){return true;}return typeof _4.query=="object";},_matchesQuery:function(_5,_6){return true;},constructor:function(_7){this.zone=_7.zone;this.library=_7.library;this.target=dojo.replace(bfree.api.Folders.TRGT,[this.zone.subdomain,this.library.id]);this.schema=bfree.api.Folder.schema;this.cache=true;this._initialize();this.store.isUpdateable=dojo.hitch(this,this._isUpdateable);},generateUniqueName:function(_8){var _9=this._getExistingNames(_8.parent);var _a=_8.base_name;return bfree.api.Utilities.generateUniqueName({names:_9,base_name:_a});},getSearchFolder:function(){if(!this._searchFolder){this.forEach(function(_b){dojo.every(_b.children,function(_c,_d){if(_c.isSearch()){this._searchFolder=_c;}return (!this._searchFolder);},this);},this);}return this._searchFolder;},getShareRootFolder:function(){if(!this._shareRootFolder){this.forEach(function(_e){dojo.every(_e.children,function(_f,idx){if(_f.isShareRoot()){this._shareRootFolder=_f;}return (!this._shareRootFolder);},this);},this);}return this._shareRootFolder;},getTrashFolder:function(){if(!this._trashFolder){this.forEach(function(_10){dojo.every(_10.children,function(_11,idx){if(_11.isTrash()){this._trashFolder=_11;}return (!this._trashFolder);},this);},this);}return this._trashFolder;},getTextPath:function(_12){var _13=_12.item;if(_13.parent_id){var _14=this.fetchById({id:_13.parent_id});return this.getTextPath({item:_14})+"/"+_13.name;}else{return "/"+_13.name;}}});bfree.api.Folders.TRGT="/zones/{0}/libraries/{1}/folders";bfree.api.Folders.generateUniqueName=function(_15){var _16=_15.folder;var _17=[];dojo.forEach(_16.children,function(_18){_17.push(_18.name);});return bfree.api.Utilities.generateUniqueName({names:_17,base_name:_15.base_name});};}