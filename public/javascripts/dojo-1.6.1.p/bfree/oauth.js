/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


var OAuth;if(OAuth==null){OAuth={};}OAuth.setProperties=function setProperties(_1,_2){if(_1!=null&&_2!=null){for(var _3 in _2){_1[_3]=_2[_3];}}return _1;};OAuth.setProperties(OAuth,{percentEncode:function percentEncode(s){if(s==null){return "";}if(s instanceof Array){var e="";for(var i=0;i<s.length;++s){if(e!=""){e+="&";}e+=OAuth.percentEncode(s[i]);}return e;}s=encodeURIComponent(s);s=s.replace(/\!/g,"%21");s=s.replace(/\*/g,"%2A");s=s.replace(/\'/g,"%27");s=s.replace(/\(/g,"%28");s=s.replace(/\)/g,"%29");return s;},decodePercent:function decodePercent(s){if(s!=null){s=s.replace(/\+/g," ");}return decodeURIComponent(s);},getParameterList:function getParameterList(_4){if(_4==null){return [];}if(typeof _4!="object"){return OAuth.decodeForm(_4+"");}if(_4 instanceof Array){return _4;}var _5=[];for(var p in _4){_5.push([p,_4[p]]);}return _5;},getParameterMap:function getParameterMap(_6){if(_6==null){return {};}if(typeof _6!="object"){return OAuth.getParameterMap(OAuth.decodeForm(_6+""));}if(_6 instanceof Array){var _7={};for(var p=0;p<_6.length;++p){var _8=_6[p][0];if(_7[_8]===undefined){_7[_8]=_6[p][1];}}return _7;}return _6;},getParameter:function getParameter(_9,_a){if(_9 instanceof Array){for(var p=0;p<_9.length;++p){if(_9[p][0]==_a){return _9[p][1];}}}else{return OAuth.getParameterMap(_9)[_a];}return null;},formEncode:function formEncode(_b){var _c="";var _d=OAuth.getParameterList(_b);for(var p=0;p<_d.length;++p){var _e=_d[p][1];if(_e==null){_e="";}if(_c!=""){_c+="&";}_c+=OAuth.percentEncode(_d[p][0])+"="+OAuth.percentEncode(_e);}return _c;},decodeForm:function decodeForm(_f){var _10=[];var _11=_f.split("&");for(var n=0;n<_11.length;++n){var nvp=_11[n];if(nvp==""){continue;}var _12=nvp.indexOf("=");var _13;var _14;if(_12<0){_13=OAuth.decodePercent(nvp);_14=null;}else{_13=OAuth.decodePercent(nvp.substring(0,_12));_14=OAuth.decodePercent(nvp.substring(_12+1));}_10.push([_13,_14]);}return _10;},setParameter:function setParameter(_15,_16,_17){var _18=_15.parameters;if(_18 instanceof Array){for(var p=0;p<_18.length;++p){if(_18[p][0]==_16){if(_17===undefined){_18.splice(p,1);}else{_18[p][1]=_17;_17=undefined;}}}if(_17!==undefined){_18.push([_16,_17]);}}else{_18=OAuth.getParameterMap(_18);_18[_16]=_17;_15.parameters=_18;}},setParameters:function setParameters(_19,_1a){var _1b=OAuth.getParameterList(_1a);for(var i=0;i<_1b.length;++i){OAuth.setParameter(_19,_1b[i][0],_1b[i][1]);}},completeRequest:function completeRequest(_1c,_1d){if(_1c.method==null){_1c.method="GET";}var map=OAuth.getParameterMap(_1c.parameters);if(map.oauth_consumer_key==null){OAuth.setParameter(_1c,"oauth_consumer_key",_1d.consumerKey||"");}if(map.oauth_token==null&&_1d.token!=null){OAuth.setParameter(_1c,"oauth_token",_1d.token);}if(map.oauth_version==null){OAuth.setParameter(_1c,"oauth_version","1.0");}if(map.oauth_timestamp==null){OAuth.setParameter(_1c,"oauth_timestamp",OAuth.timestamp());}if(map.oauth_nonce==null){OAuth.setParameter(_1c,"oauth_nonce",OAuth.nonce(6));}OAuth.SignatureMethod.sign(_1c,_1d);},setTimestampAndNonce:function setTimestampAndNonce(_1e){OAuth.setParameter(_1e,"oauth_timestamp",OAuth.timestamp());OAuth.setParameter(_1e,"oauth_nonce",OAuth.nonce(6));},addToURL:function addToURL(url,_1f){newURL=url;if(_1f!=null){var _20=OAuth.formEncode(_1f);if(_20.length>0){var q=url.indexOf("?");if(q<0){newURL+="?";}else{newURL+="&";}newURL+=_20;}}return newURL;},getAuthorizationHeader:function getAuthorizationHeader(_21,_22){var _23="OAuth realm=\""+OAuth.percentEncode(_21)+"\"";var _24=OAuth.getParameterList(_22);for(var p=0;p<_24.length;++p){var _25=_24[p];var _26=_25[0];if(_26.indexOf("oauth_")==0){_23+=","+OAuth.percentEncode(_26)+"=\""+OAuth.percentEncode(_25[1])+"\"";}}return _23;},correctTimestampFromSrc:function correctTimestampFromSrc(_27){_27=_27||"oauth_timestamp";var _28=document.getElementsByTagName("script");if(_28==null||!_28.length){return;}var src=_28[_28.length-1].src;if(!src){return;}var q=src.indexOf("?");if(q<0){return;}parameters=OAuth.getParameterMap(OAuth.decodeForm(src.substring(q+1)));var t=parameters[_27];if(t==null){return;}OAuth.correctTimestamp(t);},correctTimestamp:function correctTimestamp(_29){OAuth.timeCorrectionMsec=(_29*1000)-(new Date()).getTime();},timeCorrectionMsec:0,timestamp:function timestamp(){var t=(new Date()).getTime()+OAuth.timeCorrectionMsec;return Math.floor(t/1000);},nonce:function nonce(_2a){var _2b=OAuth.nonce.CHARS;var _2c="";for(var i=0;i<_2a;++i){var _2d=Math.floor(Math.random()*_2b.length);_2c+=_2b.substring(_2d,_2d+1);}return _2c;}});OAuth.nonce.CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";OAuth.declareClass=function declareClass(_2e,_2f,_30){var _31=_2e[_2f];_2e[_2f]=_30;if(_30!=null&&_31!=null){for(var key in _31){if(key!="prototype"){_30[key]=_31[key];}}}return _30;};OAuth.declareClass(OAuth,"SignatureMethod",function OAuthSignatureMethod(){});OAuth.setProperties(OAuth.SignatureMethod.prototype,{sign:function sign(_32){var _33=OAuth.SignatureMethod.getBaseString(_32);var _34=this.getSignature(_33);OAuth.setParameter(_32,"oauth_signature",_34);return _34;},initialize:function initialize(_35,_36){var _37;if(_36.accessorSecret!=null&&_35.length>9&&_35.substring(_35.length-9)=="-Accessor"){_37=_36.accessorSecret;}else{_37=_36.consumerSecret;}this.key=OAuth.percentEncode(_37)+"&"+OAuth.percentEncode(_36.tokenSecret);}});OAuth.setProperties(OAuth.SignatureMethod,{sign:function sign(_38,_39){var _3a=OAuth.getParameterMap(_38.parameters).oauth_signature_method;if(_3a==null||_3a==""){_3a="HMAC-SHA1";OAuth.setParameter(_38,"oauth_signature_method",_3a);}OAuth.SignatureMethod.newMethod(_3a,_39).sign(_38);},newMethod:function newMethod(_3b,_3c){var _3d=OAuth.SignatureMethod.REGISTERED[_3b];if(_3d!=null){var _3e=new _3d();_3e.initialize(_3b,_3c);return _3e;}var err=new Error("signature_method_rejected");var _3f="";for(var r in OAuth.SignatureMethod.REGISTERED){if(_3f!=""){_3f+="&";}_3f+=OAuth.percentEncode(r);}err.oauth_acceptable_signature_methods=_3f;throw err;},REGISTERED:{},registerMethodClass:function registerMethodClass(_40,_41){for(var n=0;n<_40.length;++n){OAuth.SignatureMethod.REGISTERED[_40[n]]=_41;}},makeSubclass:function makeSubclass(_42){var _43=OAuth.SignatureMethod;var _44=function(){_43.call(this);};_44.prototype=new _43();_44.prototype.getSignature=_42;_44.prototype.constructor=_44;return _44;},getBaseString:function getBaseString(_45){var URL=_45.action;var q=URL.indexOf("?");var _46;if(q<0){_46=_45.parameters;}else{_46=OAuth.decodeForm(URL.substring(q+1));var _47=OAuth.getParameterList(_45.parameters);for(var a=0;a<_47.length;++a){_46.push(_47[a]);}}return OAuth.percentEncode(_45.method.toUpperCase())+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeUrl(URL))+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeParameters(_46));},normalizeUrl:function normalizeUrl(url){var uri=OAuth.SignatureMethod.parseUri(url);var _48=uri.protocol.toLowerCase();var _49=uri.authority.toLowerCase();var _4a=(_48=="http"&&uri.port==80)||(_48=="https"&&uri.port==443);if(_4a){var _4b=_49.lastIndexOf(":");if(_4b>=0){_49=_49.substring(0,_4b);}}var _4c=uri.path;if(!_4c){_4c="/";}return _48+"://"+_49+_4c;},parseUri:function parseUri(str){var o={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}};var m=o.parser.strict.exec(str);var uri={};var i=14;while(i--){uri[o.key[i]]=m[i]||"";}return uri;},normalizeParameters:function normalizeParameters(_4d){if(_4d==null){return "";}var _4e=OAuth.getParameterList(_4d);var _4f=[];for(var p=0;p<_4e.length;++p){var nvp=_4e[p];if(nvp[0]!="oauth_signature"){_4f.push([OAuth.percentEncode(nvp[0])+" "+OAuth.percentEncode(nvp[1]),nvp]);}}_4f.sort(function(a,b){if(a[0]<b[0]){return -1;}if(a[0]>b[0]){return 1;}return 0;});var _50=[];for(var s=0;s<_4f.length;++s){_50.push(_4f[s][1]);}return OAuth.formEncode(_50);}});OAuth.SignatureMethod.registerMethodClass(["PLAINTEXT","PLAINTEXT-Accessor"],OAuth.SignatureMethod.makeSubclass(function getSignature(_51){return this.key;}));OAuth.SignatureMethod.registerMethodClass(["HMAC-SHA1","HMAC-SHA1-Accessor"],OAuth.SignatureMethod.makeSubclass(function getSignature(_52){b64pad="=";var _53=b64_hmac_sha1(this.key,_52);return _53;}));try{OAuth.correctTimestampFromSrc();}catch(e){}